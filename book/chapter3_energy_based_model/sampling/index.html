
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../score_function/">
      
      
        <link rel="next" href="../cd/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.49">
    
    
      
        <title>Sampling Methods - Generative AI: From Start to Surrender</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.6f8fc17f.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../stylesheets/extra.css">
    
      <link rel="stylesheet" href="https://unpkg.com/katex@0/dist/katex.min.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config",""),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
   <link href="../../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#sampling-from-a-distribution" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Generative AI: From Start to Surrender" class="md-header__button md-logo" aria-label="Generative AI: From Start to Surrender" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Generative AI: From Start to Surrender
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Sampling Methods
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1M8 13h8v-2H8zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4a5 5 0 0 0 5-5 5 5 0 0 0-5-5"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5M7 15a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../chapter1_Introduction/1.1terminology/" class="md-tabs__link">
          
  
    
  
  Introduction

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../chapter2_generation_theory/mle/" class="md-tabs__link">
          
  
    
  
  Generation Theory

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../introduction/" class="md-tabs__link">
          
  
    
  
  Energy Based Models

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../chapter6_VAE/vae_introduction/" class="md-tabs__link">
          
  
    
  
  VAE

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../chapter5_GAN/3.1from_gan_to_stylegan/paper/" class="md-tabs__link">
          
  
    
  
  GANs

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../chapter7_diffusion/ddpm/" class="md-tabs__link">
          
  
    
  
  Diffusion Models

        </a>
      </li>
    
  

    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../chapter9_flow_matching/introduction/" class="md-tabs__link">
          
  
    
  
  Flow Matching

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../chapter11_hybrid_sota_models/hybrid_methods/" class="md-tabs__link">
          
  
    
  
  Hybrid SOTA Models

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Generative AI: From Start to Surrender" class="md-nav__button md-logo" aria-label="Generative AI: From Start to Surrender" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Generative AI: From Start to Surrender
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Introduction
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter1_Introduction/1.1terminology/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Terms
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter1_Introduction/1.2fourier_transform/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fourier Transform
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter1_Introduction/1.3signal_processing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Signal Processing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter1_Introduction/1.4statistics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Statistics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter1_Introduction/tutorials/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tutorials
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Generation Theory
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Generation Theory
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter2_generation_theory/mle/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Maximal Likelihood
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter2_generation_theory/manifold_hypothesis/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Manifold Hypothesis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter2_generation_theory/generative_model_category/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Generative Model Category
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Energy Based Models
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Energy Based Models
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../introduction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../score_function/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Score Functions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Sampling Methods
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Sampling Methods
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-key-concepts-in-sampling" class="md-nav__link">
    <span class="md-ellipsis">
      1. Key Concepts in Sampling
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-sample-from-a-simple-gaussian-distribution" class="md-nav__link">
    <span class="md-ellipsis">
      2. sample from a simple gaussian distribution
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. sample from a simple gaussian distribution">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-transformations-from-uniform-distributions" class="md-nav__link">
    <span class="md-ellipsis">
      2.1 Transformations from Uniform Distributions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-sampling-from-complex-distributions" class="md-nav__link">
    <span class="md-ellipsis">
      2.2 Sampling from Complex Distributions
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-markov-chain-monte-carlo-mcmc" class="md-nav__link">
    <span class="md-ellipsis">
      3. Markov Chain Monte Carlo (MCMC)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-hamiltonian-monte-carlo-hmc" class="md-nav__link">
    <span class="md-ellipsis">
      4. Hamiltonian Monte Carlo (HMC)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. Hamiltonian Monte Carlo (HMC)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-references-further-reading" class="md-nav__link">
    <span class="md-ellipsis">
      4.1 References &amp; Further Reading
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-langevin-dynamics" class="md-nav__link">
    <span class="md-ellipsis">
      5. Langevin Dynamics
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-alternative-sampling-dynamics" class="md-nav__link">
    <span class="md-ellipsis">
      6. Alternative Sampling Dynamics
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6. Alternative Sampling Dynamics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#61-1-underdamped-langevin-dynamics" class="md-nav__link">
    <span class="md-ellipsis">
      6.1 1. Underdamped Langevin Dynamics
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#62-2-regularized-x-sde" class="md-nav__link">
    <span class="md-ellipsis">
      6.2 2. Regularized X-SDE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#63-23-generalized-regularized-x-sde-form" class="md-nav__link">
    <span class="md-ellipsis">
      6.3 2.3. Generalized Regularized X-SDE Form
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#64-24-practical-adjustments" class="md-nav__link">
    <span class="md-ellipsis">
      6.4 2.4. Practical Adjustments
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#65-3-time-reversal-sde-reverse-diffusion-process" class="md-nav__link">
    <span class="md-ellipsis">
      6.5 3. Time-Reversal SDE (Reverse Diffusion Process)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#66-4-preconditioned-langevin-dynamics" class="md-nav__link">
    <span class="md-ellipsis">
      6.6 4. Preconditioned Langevin Dynamics
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#67-summary-of-sde-models" class="md-nav__link">
    <span class="md-ellipsis">
      6.7 Summary of SDE Models
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#68-learning-objectives" class="md-nav__link">
    <span class="md-ellipsis">
      6.8 Learning Objectives
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#69-practical-recommendations" class="md-nav__link">
    <span class="md-ellipsis">
      6.9 Practical Recommendations
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-details-of-annealed-langevin-dynamics-sampling" class="md-nav__link">
    <span class="md-ellipsis">
      7. Details of Annealed Langevin Dynamics Sampling
    </span>
  </a>
  
    <nav class="md-nav" aria-label="7. Details of Annealed Langevin Dynamics Sampling">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#71-1-definition" class="md-nav__link">
    <span class="md-ellipsis">
      7.1 1. Definition
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#72-2-core-principles" class="md-nav__link">
    <span class="md-ellipsis">
      7.2 2. Core Principles
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#73-3-mathematical-formulation-and-derivation" class="md-nav__link">
    <span class="md-ellipsis">
      7.3 3. Mathematical Formulation and Derivation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#74-4-temperature-scheduling-design" class="md-nav__link">
    <span class="md-ellipsis">
      7.4 4. Temperature Scheduling Design
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#75-5-theoretical-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      7.5 5. Theoretical Analysis
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#76-6-applications" class="md-nav__link">
    <span class="md-ellipsis">
      7.6 6. Applications
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#77-7-practical-steps" class="md-nav__link">
    <span class="md-ellipsis">
      7.7 7. Practical Steps
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#78-8-comparison-with-other-methods" class="md-nav__link">
    <span class="md-ellipsis">
      7.8 8. Comparison with Other Methods
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#79-9-advanced-extensions" class="md-nav__link">
    <span class="md-ellipsis">
      7.9 9. Advanced Extensions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#710-10-key-considerations" class="md-nav__link">
    <span class="md-ellipsis">
      7.10 10. Key Considerations
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cd/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contrastive Divergence
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../score_matching/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Score Matching
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    VAE
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            VAE
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter6_VAE/vae_introduction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter6_VAE/vq_vae/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    VA-VAE
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    GANs
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            GANs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter5_GAN/3.1from_gan_to_stylegan/paper/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    From GAN to StyleGAN
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6_2" >
        
          
          <label class="md-nav__link" for="__nav_6_2" id="__nav_6_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    StyleGAN Variants
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_2">
            <span class="md-nav__icon md-icon"></span>
            StyleGAN Variants
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter5_GAN/3.3stylegan/paper/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    StyleGAN
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter5_GAN/3.4stylegan2/paper/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    StyleGAN2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter5_GAN/3.5stylegan3/paper/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    StyleGAN3
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter5_GAN/3.6styleganT/paper/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    StyleGAN-T
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter5_GAN/3.7R3Gan/paper/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    R3GAN
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter5_GAN/vq_gan/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    VQ-GAN
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Diffusion Models
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Diffusion Models
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7_1" >
        
          
          <label class="md-nav__link" for="__nav_7_1" id="__nav_7_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Discrete Diffusion
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_1">
            <span class="md-nav__icon md-icon"></span>
            Discrete Diffusion
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter7_diffusion/ddpm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DDPM
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter7_diffusion/ldm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LDM
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter7_diffusion/ldm_handson/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LDM Handson
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter7_diffusion/diffusion_model_varients/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Diffusion Model Varients
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter7_diffusion/general_diffusion_model/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    General Diffusion Model
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7_2" >
        
          
          <label class="md-nav__link" for="__nav_7_2" id="__nav_7_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    SDE Diffusion
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_2">
            <span class="md-nav__icon md-icon"></span>
            SDE Diffusion
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter7_diffusion/introduction_sde/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SDE Fundamentals
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter7_diffusion/from_ddpm_2_sde/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SDE for DDPM
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter7_diffusion/score_based_sde/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Score Based SDE
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter7_diffusion/probability_flow_ode/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Probability Flow ODE
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter7_diffusion/sde_diffusion_speedup/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SDE Diffusion Speedup
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7_3" >
        
          
          <label class="md-nav__link" for="__nav_7_3" id="__nav_7_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Diffusion Network
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_3">
            <span class="md-nav__icon md-icon"></span>
            Diffusion Network
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter7_diffusion/DiT/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DiT
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Flow Matching
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Flow Matching
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter9_flow_matching/introduction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter9_flow_matching/probability_with_velocity_field/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Probability Path and Velocity Fields
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter9_flow_matching/flow_matching_theory/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Flow Matching Theorem
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter9_flow_matching/affine_conditional_flows/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Affine Conditional Flow
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter9_flow_matching/optimal_transport_flow/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Optimal Transport Flow
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter9_flow_matching/rectified_flow/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Rectified Flow
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Hybrid SOTA Models
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            Hybrid SOTA Models
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter11_hybrid_sota_models/hybrid_methods/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hybrid Methods
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter11_hybrid_sota_models/sota_closed_models/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Closed Models
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_9_3" >
        
          
          <label class="md-nav__link" for="__nav_9_3" id="__nav_9_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Open Models
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_9_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_3">
            <span class="md-nav__icon md-icon"></span>
            Open Models
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter11_hybrid_sota_models/sota_open_models/dalle_series/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dalle Series
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter11_hybrid_sota_models/sota_open_models/stable_diffusion_series/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Stable Diffusion Series
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter11_hybrid_sota_models/sota_open_models/stable_diffusion_xl/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Stable Diffusion XL
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter11_hybrid_sota_models/sota_open_models/stable_diffusion_3_reading/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Stable Diffusion 3
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter11_hybrid_sota_models/sota_open_models/flux1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Flux.1
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter11_hybrid_sota_models/trends_future/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Future Trends
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="sampling-from-a-distribution">Sampling from a Distribution<a class="headerlink" href="#sampling-from-a-distribution" title="Permanent link">&para;</a></h1>
<p>Understanding the process of sampling is crucial in probability and statistics. Sampling is not merely picking random points in space; it involves generating samples that statistically resemble a given probability distribution. This is essential for tasks such as Monte Carlo simulations, statistical modeling, and machine learning.</p>
<h2 id="1-key-concepts-in-sampling">1. Key Concepts in Sampling<a class="headerlink" href="#1-key-concepts-in-sampling" title="Permanent link">&para;</a></h2>
<ol>
<li>
<p><strong>Representation of the Distribution</strong>: The samples should reflect the underlying probability distribution. For example, if a distribution has a high density in a specific region, more samples should appear in that region.</p>
</li>
<li>
<p><strong>Convergence to the Distribution</strong>: As the number of samples increases, the empirical distribution (e.g., a histogram) should converge to the theoretical probability distribution.</p>
</li>
<li>
<p><strong>Applications</strong>: Accurate sampling is vital for simulations and models where results depend on how well samples represent the true distribution.</p>
</li>
</ol>
<p><a class="glightbox" href="https://cdn.cognitiveseo.com/blog/wp-content/uploads/2014/03/b79459f12030f5efb4c24f44ab1178db2.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="image" src="https://cdn.cognitiveseo.com/blog/wp-content/uploads/2014/03/b79459f12030f5efb4c24f44ab1178db2.png" /></a></p>
<p>That is to say, we want to give higher priority to sample that have higher probability.</p>
<p>Next, if given a density function, how to sample it.
Unlike the VAE, Gan which directed generated an example. In the energy based model, we only have the probability density function (precisely, we have the unnormalized probability density function), how can we sample from it?</p>
<p>Generally, sample from a probability distribution can be done in this way</p>
<ol>
<li>sample from a uniform distribution</li>
<li>map the sample to the inverse of the CDF function</li>
</ol>
<p>than we obtained the samples that follow the given probability distribution.
Here CDF is the cumulative distribution function, that is</p>
<div class="arithmatex">\[ CDF(x) = \int_{-\infty}^x p(z) \, dz \]</div>
<h2 id="2-sample-from-a-simple-gaussian-distribution">2. sample from a simple gaussian distribution<a class="headerlink" href="#2-sample-from-a-simple-gaussian-distribution" title="Permanent link">&para;</a></h2>
<p>In python, sample the gussian distribution maybe simple as the following.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span>
<span class="normal"><a href="#__codelineno-0-4">4</a></span>
<span class="normal"><a href="#__codelineno-0-5">5</a></span>
<span class="normal"><a href="#__codelineno-0-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="kn">import</span> <span class="nn">torch</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="kn">import</span> <span class="nn">torch.distributions</span> <span class="k">as</span> <span class="nn">dist</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="c1"># Sample from a standard normal distribution</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="n">sample</span> <span class="o">=</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sample</span><span class="p">()</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="nb">print</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<h3 id="21-transformations-from-uniform-distributions">2.1 Transformations from Uniform Distributions<a class="headerlink" href="#21-transformations-from-uniform-distributions" title="Permanent link">&para;</a></h3>
<p>While Gaussian distributions can be sampled directly, they can also be derived from uniform distributions using transformations like the Box-Muller method:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-1-1">1</a></span>
<span class="normal"><a href="#__codelineno-1-2">2</a></span>
<span class="normal"><a href="#__codelineno-1-3">3</a></span>
<span class="normal"><a href="#__codelineno-1-4">4</a></span>
<span class="normal"><a href="#__codelineno-1-5">5</a></span>
<span class="normal"><a href="#__codelineno-1-6">6</a></span>
<span class="normal"><a href="#__codelineno-1-7">7</a></span>
<span class="normal"><a href="#__codelineno-1-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1"></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<a id="__codelineno-1-2" name="__codelineno-1-2"></a>
<a id="__codelineno-1-3" name="__codelineno-1-3"></a><span class="c1"># Box-Muller transform: sampling normal distribution from uniform</span>
<a id="__codelineno-1-4" name="__codelineno-1-4"></a><span class="n">u1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-1-5" name="__codelineno-1-5"></a><span class="n">u2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-1-6" name="__codelineno-1-6"></a><span class="n">z1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">u1</span><span class="p">))</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">u2</span><span class="p">)</span>
<a id="__codelineno-1-7" name="__codelineno-1-7"></a><span class="n">z2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">u1</span><span class="p">))</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">u2</span><span class="p">)</span>
<a id="__codelineno-1-8" name="__codelineno-1-8"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Samples: </span><span class="si">{</span><span class="n">z1</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">z2</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p>This method is efficient because it avoids the need for the inverse CDF, which does not have a closed form for Gaussian distributions.</p>
<h3 id="22-sampling-from-complex-distributions">2.2 Sampling from Complex Distributions<a class="headerlink" href="#22-sampling-from-complex-distributions" title="Permanent link">&para;</a></h3>
<p>For complex distributions, especially with unnormalized probability density functions (as in Energy-Based Models), sophisticated methods are needed:</p>
<ol>
<li><strong>Markov Chain Monte Carlo (MCMC)</strong>: A broad class of algorithms for sampling from complex distributions.</li>
<li><strong>Langevin Dynamics</strong>: Combines gradient descent with noise to explore probability spaces.</li>
<li><strong>Hamiltonian Monte Carlo (HMC)</strong>: Uses physical dynamics to efficiently sample from high-dimensional distributions.</li>
</ol>
<h2 id="3-markov-chain-monte-carlo-mcmc">3. Markov Chain Monte Carlo (MCMC)<a class="headerlink" href="#3-markov-chain-monte-carlo-mcmc" title="Permanent link">&para;</a></h2>
<p>MCMC is a broad class of algorithms used to draw samples from complex probability distributions, especially when direct sampling or classical numerical integration is difficult. The main idea behind MCMC is:</p>
<ol>
<li><strong>We want samples from a target distribution</strong>
Suppose we have a probability distribution <span class="arithmatex">\(\pi(x)\)</span> (often given up to a normalization constant, e.g., <span class="arithmatex">\(\pi(x)\propto e^{-E(x)}\)</span>), and we want to estimate expectations like</li>
</ol>
<div class="arithmatex">\[
 \mathbb{E}_{x\sim \pi}[f(x)] \;=\; \int f(x)\,\pi(x)\,dx.
\]</div>
<p>In many applications (e.g., Bayesian inference), <span class="arithmatex">\(\pi\)</span> may be high‐dimensional or have no closed‐form normalizing constant, making direct sampling infeasible.</p>
<ol>
<li>
<p><strong>Construct a Markov Chain whose stationary distribution is <span class="arithmatex">\(\pi\)</span></strong>
MCMC methods build a Markov chain <span class="arithmatex">\(X_0, X_1, X_2,\dots\)</span> with a <em>transition rule</em> <span class="arithmatex">\(X_{t+1}\sim T(\cdot\mid X_t)\)</span>. The key is to design <span class="arithmatex">\(T\)</span> so that if <span class="arithmatex">\(X_t\)</span> <em>is distributed</em> according to <span class="arithmatex">\(\pi\)</span>, then <span class="arithmatex">\(X_{t+1}\)</span> is also distributed according to <span class="arithmatex">\(\pi\)</span>. Under suitable conditions (ergodicity), the chain then <em>converges</em> to <span class="arithmatex">\(\pi\)</span> from a wide range of initial states, and the samples <span class="arithmatex">\(X_0, X_1, \dots\)</span> “mix” throughout the support of <span class="arithmatex">\(\pi\)</span>.</p>
</li>
<li>
<p><strong>Samples from the chain approximate samples from <span class="arithmatex">\(\pi\)</span></strong></p>
</li>
</ol>
<p>If the Markov chain is <em>ergodic</em> and <em>aperiodic</em>, then for large <span class="arithmatex">\(t\)</span>, the distribution of <span class="arithmatex">\(X_t\)</span> is close to <span class="arithmatex">\(\pi\)</span>. We can compute empirical averages using <span class="arithmatex">\(\frac{1}{N}\sum_{t=1}^N f(X_t)\)</span>
to estimate <span class="arithmatex">\(\mathbb{E}_{\pi}[f]\)</span>. The law of large numbers for Markov chains implies that, as <span class="arithmatex">\(N\to\infty\)</span>, these empirical averages converge to the true expectation (under mild regularity conditions).</p>
<p>Popular MCMC approaches include:</p>
<ul>
<li>
<p><strong>Metropolis–Hastings (MH)</strong> : Propose a new sample from a proposal distribution <span class="arithmatex">\(q(\cdot\mid X_t)\)</span> and accept or reject it based on a <em>Metropolis acceptance probability</em> that ensures <span class="arithmatex">\(\pi\)</span> is the stationary distribution.</p>
</li>
<li>
<p><strong>Gibbs sampling</strong> : Update each component in turn from its conditional distribution, often used when conditionals of <span class="arithmatex">\(\pi\)</span> are simpler than the joint.</p>
</li>
</ul>
<h2 id="4-hamiltonian-monte-carlo-hmc">4. Hamiltonian Monte Carlo (HMC)<a class="headerlink" href="#4-hamiltonian-monte-carlo-hmc" title="Permanent link">&para;</a></h2>
<p><strong>Hamiltonian Monte Carlo (HMC)</strong>  is a specialized MCMC method designed to tackle high‐dimensional sampling problems more efficiently than basic Metropolis–Hastings or Gibbs sampling, especially when <span class="arithmatex">\(\pi(x)\propto e^{-E(x)}\)</span> for some smooth potential <span class="arithmatex">\(E(x)\)</span>. Its key ingredients:</p>
<ol>
<li><strong>Incorporate “physical” dynamics</strong>
HMC treats the target variable <span class="arithmatex">\(x\)</span> as a <em>position</em> in a physical system and introduces an auxiliary <em>momentum</em> variable <span class="arithmatex">\(p\)</span>. Together, <span class="arithmatex">\((x,p)\)</span> evolve according to (fictitious) Hamiltonian dynamics governed by a Hamiltonian function</li>
</ol>
<div class="arithmatex">\[H(x,p) = E(x) + \frac{1}{2}p^\top M^{-1} p\]</div>
<p>where <span class="arithmatex">\(M\)</span> is a mass matrix (often the identity).</p>
<ol>
<li><strong>Hamiltonian flow</strong>
Starting from <span class="arithmatex">\((x,p)\)</span>, HMC simulates the continuous‐time Hamiltonian equations:</li>
</ol>
<div class="arithmatex">\[
 \begin{cases}
\dot{x} \;=\; M^{-1} p,\\
\dot{p} \;=\; -\,\nabla E(x).
\end{cases}
\]</div>
<p>These flow equations conserve the Hamiltonian <span class="arithmatex">\(H(x,p)\)</span>. In practice, one discretizes this flow via a <em>symplectic integrator</em> (e.g., leapfrog method), which approximates the true continuous trajectory but still preserves many beneficial geometry properties.</p>
<ol>
<li>
<p><strong>Metropolis correction</strong>
After simulating the Hamiltonian system for a certain number of leapfrog steps, HMC performs a <em>Metropolis acceptance/rejection step</em>:</p>
</li>
<li>
<p>Propose a new state <span class="arithmatex">\((x^\star,p^\star)\)</span> by integrating from <span class="arithmatex">\((x,p)\)</span>.</p>
</li>
<li>
<p>Accept or reject based on the Metropolis probability involving the change in Hamiltonian:</p>
</li>
</ol>
<div class="arithmatex">\[
 \alpha \;=\; \min\Bigl(1,\;\exp\bigl[-(H(x^\star,p^\star)-H(x,p))\bigr]\Bigr).
\]</div>
<p>This ensures the Markov chain has <span class="arithmatex">\(\pi(x)\cdot\mathcal{N}(p\mid 0,M)\)</span> as its invariant distribution in the extended space.</p>
<ol>
<li><strong>Efficient exploration</strong>
Because Hamiltonian trajectories can travel <em>long distances</em> in the state space without random walk behavior, HMC reduces the <em>random walk</em> inefficiency often seen in simpler MCMC methods. This often leads to better <em>mixing</em> and more <em>decorrelated</em> samples, especially in high dimensions.</li>
</ol>
<p><strong>Summary of HMC steps</strong></p>
<ol>
<li>
<p><strong>Sample momentum</strong>  <span class="arithmatex">\(p\sim \mathcal{N}(0,M)\)</span> to get <span class="arithmatex">\((x,p)\)</span>.</p>
</li>
<li>
<p><strong>Simulate Hamiltonian flow</strong>  with a symplectic integrator (e.g., leapfrog) for a chosen number of steps <span class="arithmatex">\(L\)</span> and step size <span class="arithmatex">\(\epsilon\)</span>. This yields a proposal <span class="arithmatex">\((x^\star, p^\star)\)</span>.</p>
</li>
<li>
<p><strong>Accept/Reject</strong>  <span class="arithmatex">\((x^\star,p^\star)\)</span> using the Metropolis probability <span class="arithmatex">\(\alpha\)</span>. If accepted, set <span class="arithmatex">\(X_{t+1}=x^\star\)</span>; else remain at <span class="arithmatex">\(X_{t+1}=x\)</span>.</p>
</li>
<li>
<p><strong>Repeat</strong>  for many iterations.</p>
</li>
</ol>
<h3 id="41-references-further-reading">4.1 References &amp; Further Reading<a class="headerlink" href="#41-references-further-reading" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>MCMC in general</strong> :</li>
<li>
<p>Chib, S. and Greenberg, E. (1995). <em>Understanding the Metropolis–Hastings Algorithm.</em> The American Statistician.</p>
</li>
<li>
<p>Gilks, W. R., Richardson, S., &amp; Spiegelhalter, D. J. (1995). <em>Markov Chain Monte Carlo in Practice.</em> Chapman &amp; Hall.</p>
</li>
<li>
<p><strong>Hamiltonian Monte Carlo</strong> :</p>
</li>
<li>
<p>Duane, S., Kennedy, A. D., Pendleton, B. J., &amp; Roweth, D. (1987). <em>Hybrid Monte Carlo.</em> Physics Letters B.</p>
</li>
<li>
<p>Neal, R. M. (2011). <em>MCMC Using Hamiltonian Dynamics.</em> In <em>Handbook of Markov Chain Monte Carlo</em> (eds S. Brooks, et al.).</p>
</li>
<li>
<p>Betancourt, M. (2018). <em>A Conceptual Introduction to Hamiltonian Monte Carlo.</em></p>
</li>
</ul>
<p>In short, MCMC is the backbone of <em>sampling from complicated distributions</em> when direct sampling is infeasible. Hamiltonian Monte Carlo refines this idea by incorporating physical dynamics to <em>move quickly</em> through the space, often yielding more efficient sampling in high‐dimensional problems.</p>
<h2 id="5-langevin-dynamics">5. Langevin Dynamics<a class="headerlink" href="#5-langevin-dynamics" title="Permanent link">&para;</a></h2>
<h4 id="51-1-definition">5.1 1. Definition<a class="headerlink" href="#51-1-definition" title="Permanent link">&para;</a></h4>
<p>Langevin Dynamics Sampling is a sampling method based on Stochastic Differential Equations (SDE). It is used to sample from high-dimensional probability distributions <span class="arithmatex">\(p(x) \propto e^{-E(x)}\)</span>. The core idea is to add stochastic noise to the deterministic gradient descent process, ensuring a balance between exploration and exploitation, ultimately achieving the desired distribution.</p>
<hr />
<h4 id="52-2-core-principles">5.2 2. Core Principles<a class="headerlink" href="#52-2-core-principles" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p><strong>Physical Perspective</strong> : Derived from particle motion, where <span class="arithmatex">\(E(x)\)</span> represents the particle's potential energy (drift term), and random thermal noise (diffusion term) drives its movement.</p>
</li>
<li>
<p><strong>Mathematical Perspective</strong> : Designed as a random process to enable samples to converge to the target distribution <span class="arithmatex">\(p(x)\)</span>.</p>
</li>
<li>
<p><strong>Key Components</strong> :</p>
</li>
<li>
<p><strong>Gradient Descent</strong> : Following the negative gradient of <span class="arithmatex">\(E(x)\)</span>, which guides the particle toward areas of lower energy (higher probability density).</p>
</li>
<li>
<p><strong>Random Noise</strong> : Adding stochastic perturbations to prevent the algorithm from getting stuck and ensure sufficient exploration.</p>
</li>
</ul>
<p>One also need to note that the converge to the final target distribution is not depended on the initial status, that means we can sample the initial status from any distribution.</p>
<h4 id="53-3-discrete-formulation">5.3 3. Discrete Formulation<a class="headerlink" href="#53-3-discrete-formulation" title="Permanent link">&para;</a></h4>
<p><strong>Continuous Langevin Dynamics</strong></p>
<div class="arithmatex">\[
 dx_t = -\nabla E(x_t)dt + \sqrt{2}dW_t
\]</div>
<p>Where:</p>
<ul>
<li>
<p><span class="arithmatex">\(x_t\)</span>: Position of the particle at time <span class="arithmatex">\(t\)</span>.</p>
</li>
<li>
<p><span class="arithmatex">\(W_t\)</span>: Standard Wiener process (Brownian motion), satisfying <span class="arithmatex">\(W_t \sim \mathcal{N}(0, t)\)</span>.</p>
</li>
</ul>
<p><strong>Discrete Update Rule</strong>  (Practical Implementation):</p>
<div class="arithmatex">\[
 x_{k+1} = x_k - \epsilon \nabla E(x_k) + \sqrt{2\epsilon} \xi_k, \, \xi_k \sim \mathcal{N}(0, I)
\]</div>
<p>Where <span class="arithmatex">\(\epsilon\)</span> is the step size, controlling the trade-off between convergence speed and accuracy.</p>
<hr />
<h4 id="54-4-proof-target-distribution-as-the-stationary-distribution">5.4 4. Proof: Target Distribution as the Stationary Distribution<a class="headerlink" href="#54-4-proof-target-distribution-as-the-stationary-distribution" title="Permanent link">&para;</a></h4>
<p><strong>Goal</strong> : Prove that the stationary distribution of Langevin Dynamics is <span class="arithmatex">\(p(x) \propto e^{-E(x)}\)</span>.</p>
<p><strong>Tool</strong> : Fokker-Planck Equation (Describes the evolution of probability density under a stochastic process).</p>
<ol>
<li><span class="arithmatex">\(p(x)\)</span> is a stationary solution</li>
</ol>
<p>According to Fokker-Planck Equation:</p>
<div class="arithmatex">\[
\begin{aligned}
\frac{\partial p(x, t)}{\partial t} |_{p(x,t)=p(x)}  &amp;= \nabla \cdot \left( p \nabla E(x) \right) + \nabla^2 p \\
&amp; = \nabla \cdot ( p \nabla E + \nabla p) \\
&amp; = \nabla \cdot ( p \nabla E - p \nabla E)\\
&amp; = 0
\end{aligned}
\]</div>
<p>the last second equation comes from</p>
<div class="arithmatex">\[
\nabla p = \nabla_x \frac{e^{-E}}{Z}= \frac{1}{Z} \nabla e^{-E} = - \frac{e^-E}{Z} \nabla E= -p\nabla E
\]</div>
<ol>
<li>Prove <span class="arithmatex">\(p(x)\)</span> is a unique stationary distribution</li>
</ol>
<p>Define the relative entropy</p>
<div class="arithmatex">\[
H(t) = \int p(x,t) \log \frac{p(x,t)}{p(x)} d x
\]</div>
<p>where <span class="arithmatex">\(p(x,t)\)</span> is the density function in time <span class="arithmatex">\(t\)</span> according to the Langevin Dynamics.</p>
<p>Compute its time derivative, we have</p>
<div class="arithmatex">\[\frac{d H}{d t} = - \int p \left| \nabla log \frac{p(x,t)}{p(x)}\right|^2 d x \leq 0\]</div>
<p>This shows <span class="arithmatex">\(p(x,t)\)</span> decreases monotonically and is zero only when <span class="arithmatex">\(p(x,t) = p(x)\)</span>.</p>
<h4 id="55-5-application-scenarios">5.5 5. Application Scenarios<a class="headerlink" href="#55-5-application-scenarios" title="Permanent link">&para;</a></h4>
<ol>
<li>
<p><strong>Statistical Sampling</strong> : Simulates sampling from high-dimensional distributions.</p>
</li>
<li>
<p><strong>Bayesian Inference</strong> : Samples from posterior distributions <span class="arithmatex">\(p(\theta|D)\)</span> in Bayesian models.</p>
</li>
<li>
<p><strong>Generative Models</strong> : Used in methods like DDPM (Denoising Diffusion Probabilistic Models) for image synthesis.</p>
</li>
<li>
<p><strong>Optimization</strong> : Combines stochastic noise with gradient-based optimization (e.g., Stochastic Gradient Langevin Dynamics, SGLD).</p>
</li>
</ol>
<h4 id="56-6-implementation-steps-and-hyperparameter-tuning">5.6 6. Implementation Steps and Hyperparameter Tuning<a class="headerlink" href="#56-6-implementation-steps-and-hyperparameter-tuning" title="Permanent link">&para;</a></h4>
<p><strong>Implementation Process</strong> :</p>
<ol>
<li>
<p><strong>Initialization</strong> : Start with a random initial point <span class="arithmatex">\(x_0\)</span>.</p>
</li>
<li>
<p><strong>Iterative Updates</strong> :</p>
</li>
</ol>
<div class="arithmatex">\[
 x_{k+1} = x_k - \epsilon \nabla \log p(x) + \sqrt{2\epsilon} \xi_k
\]</div>
<ol>
<li><strong>Stopping Criterion</strong> : Stop when the algorithm converges or sufficient samples are collected.</li>
</ol>
<p><strong>Hyperparameter Tuning</strong> :</p>
<ol>
<li>
<p><strong>Step Size (<span class="arithmatex">\(\epsilon\)</span>)</strong> : Should ensure convergence while balancing efficiency and stability (commonly uses an annealing strategy).</p>
</li>
<li>
<p><strong>Noise Level</strong> : Increase <span class="arithmatex">\(\sqrt{2\epsilon}\)</span> to improve exploration but avoid excessively large variances.</p>
</li>
<li>
<p><strong>Regularization</strong> : Use adaptive methods (e.g., SGLD) to accelerate convergence.</p>
</li>
</ol>
<p><strong>Notes</strong> :</p>
<ul>
<li>
<p>May fail for ill-conditioned cases; alternative methods like Metropolis-Hastings or MALA can be used.</p>
</li>
<li>
<p>Works under smoothness assumptions of the target distribution <span class="arithmatex">\(E(x)\)</span> (requires Lipschitz continuous gradients).</p>
</li>
</ul>
<h4 id="57-7-example-code-python-code">5.7 7. Example Code (Python Code)<a class="headerlink" href="#57-7-example-code-python-code" title="Permanent link">&para;</a></h4>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-2-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-2-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-2-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-2-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-2-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-2-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-2-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-2-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-2-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-2-10">10</a></span>
<span class="normal"><a href="#__codelineno-2-11">11</a></span>
<span class="normal"><a href="#__codelineno-2-12">12</a></span>
<span class="normal"><a href="#__codelineno-2-13">13</a></span>
<span class="normal"><a href="#__codelineno-2-14">14</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1"></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<a id="__codelineno-2-2" name="__codelineno-2-2"></a>
<a id="__codelineno-2-3" name="__codelineno-2-3"></a><span class="k">def</span> <span class="nf">langevin_sampling</span><span class="p">(</span><span class="n">grad_log_p</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">epsilon</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">):</span>
<a id="__codelineno-2-4" name="__codelineno-2-4"></a>    <span class="n">samples</span> <span class="o">=</span> <span class="p">[</span><span class="n">x0</span><span class="p">]</span>
<a id="__codelineno-2-5" name="__codelineno-2-5"></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">x0</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-2-6" name="__codelineno-2-6"></a>    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>
<a id="__codelineno-2-7" name="__codelineno-2-7"></a>        <span class="n">noise</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="o">*</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">epsilon</span><span class="p">)</span>
<a id="__codelineno-2-8" name="__codelineno-2-8"></a>        <span class="n">x</span> <span class="o">+=</span> <span class="o">-</span><span class="n">epsilon</span> <span class="o">*</span> <span class="n">grad_log_p</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">noise</span>
<a id="__codelineno-2-9" name="__codelineno-2-9"></a>        <span class="n">samples</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-2-10" name="__codelineno-2-10"></a>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span>
<a id="__codelineno-2-11" name="__codelineno-2-11"></a>
<a id="__codelineno-2-12" name="__codelineno-2-12"></a><span class="c1"># Example: Sampling from \( p(x) \propto e^{-x^2/2}, \, \text{grad_log_p}(x) = -x \)</span>
<a id="__codelineno-2-13" name="__codelineno-2-13"></a><span class="n">grad_log_p</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="o">-</span><span class="n">x</span>  <span class="c1"># Gradient of log-p(x)</span>
<a id="__codelineno-2-14" name="__codelineno-2-14"></a><span class="n">samples</span> <span class="o">=</span> <span class="n">langevin_sampling</span><span class="p">(</span><span class="n">grad_log_p</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(),</span> <span class="n">epsilon</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<ul>
<li>Code <code>experiment/langevin_dynamics_simulation.ipynb</code>
<a class="glightbox" href="../../../images/image-34.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="LD sampling process" src="../../../images/image-34.png" /></a></li>
</ul>
<h4 id="58-8-comparison-with-other-sampling-methods">5.8 8. Comparison with Other Sampling Methods<a class="headerlink" href="#58-8-comparison-with-other-sampling-methods" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>Method</th>
<th>Requires Gradients</th>
<th>Accept/Reject Step</th>
<th>Applicable Scenarios</th>
</tr>
</thead>
<tbody>
<tr>
<td>Metropolis-Hastings</td>
<td>No</td>
<td>Yes</td>
<td>General-purpose, less efficient</td>
</tr>
<tr>
<td>HMC (Hamiltonian MC)</td>
<td>Yes</td>
<td>Yes</td>
<td>High efficiency for correlated distributions</td>
</tr>
<tr>
<td>Langevin Dynamics</td>
<td>Yes (Pure SDE)</td>
<td>No</td>
<td>Efficient for high-dimensional sampling</td>
</tr>
</tbody>
</table>
<h4 id="59-conclusion">5.9 Conclusion<a class="headerlink" href="#59-conclusion" title="Permanent link">&para;</a></h4>
<p>Langevin Dynamics Sampling introduces stochasticity guided by gradients, enabling efficient sampling from high-dimensional distributions. It is a powerful tool in generative modeling, Bayesian inference, and optimization algorithms. The theoretical guarantee relies on the Fokker-Planck Equation ensuring the target distribution, while practical tuning of step size and noise level balances convergence and efficiency.</p>
<p>This simulation starts from a uniform distribution and converges to a Gaussian mixture, illustrating the effectiveness of Langevin dynamics in sampling from complex distributions.</p>
<h2 id="6-alternative-sampling-dynamics">6. Alternative Sampling Dynamics<a class="headerlink" href="#6-alternative-sampling-dynamics" title="Permanent link">&para;</a></h2>
<p>A question is that, why should we sample from <span class="arithmatex">\(p(x)\)</span> should follow LD ? Is there any other way?</p>
<p>He we introduce various stochastic differential equations (SDEs) designed to generate the steady-state distribution <span class="arithmatex">\(p(x) \propto e^{-E(x)}\)</span>. By learning the appropriate potential <span class="arithmatex">\(E(x)\)</span>, these SDE-based methods can model the target distribution, making them suitable for generative tasks, optimization, and more. Below are common dynamics and SDE models:</p>
<h3 id="61-1-underdamped-langevin-dynamics">6.1 1. Underdamped Langevin Dynamics<a class="headerlink" href="#61-1-underdamped-langevin-dynamics" title="Permanent link">&para;</a></h3>
<p><strong>Definition</strong> :</p>
<p>Introduces momentum <span class="arithmatex">\(v\)</span>, modeling the dynamics of particles in a potential field. The equations are:</p>
<div class="arithmatex">\[
 dx = v dt, \quad dv = -\eta v dt - \nabla E(x) dt + \sqrt{2\eta} dW_v,
\]</div>
<p>where <span class="arithmatex">\(\eta &gt; 0\)</span> is the friction coefficient.</p>
<p><strong>Features</strong> :</p>
<ul>
<li>
<p>Momentum introduces inertia, counteracting the "random walk" effect of overdamped Langevin dynamics.</p>
</li>
<li>
<p>Converges to the stationary distribution <span class="arithmatex">\(p(x) \propto e^{-E(x)}\)</span>.</p>
</li>
</ul>
<p><strong>Applications</strong> :</p>
<ul>
<li>
<p>Sampling methods like Hamiltonian Monte Carlo (HMC).</p>
</li>
<li>
<p>Simulating particle dynamics in physical systems.</p>
</li>
</ul>
<h3 id="62-2-regularized-x-sde">6.2 2. Regularized X-SDE<a class="headerlink" href="#62-2-regularized-x-sde" title="Permanent link">&para;</a></h3>
<p><strong>Definition</strong> :</p>
<p>For a smooth potential <span class="arithmatex">\(E(x)\)</span>, introduces regularization terms. The SDE is:</p>
<div class="arithmatex">\[
dx = b(x) dt + g(x) dW_x,
\]</div>
<p>where <span class="arithmatex">\(p(x) \propto e^{-E(x)}\)</span>.</p>
<p>In the <strong>Regularized X-SDE</strong>  framework, the drift term <span class="arithmatex">\(b(x)\)</span> and diffusion term <span class="arithmatex">\(g(x)\)</span> are typically designed based on the energy function <span class="arithmatex">\(E(x)\)</span> to ensure that the process samples from the desired probability distribution <span class="arithmatex">\(p(x) \propto e^{-E(x)}\)</span>. Their relationships are as follows:</p>
<h4 id="621-21-drift-term-bx">6.2.1 2.1. Drift Term <span class="arithmatex">\(b(x)\)</span><a class="headerlink" href="#621-21-drift-term-bx" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p>The drift term <span class="arithmatex">\(b(x)\)</span> represents the deterministic component that drives the system towards lower-energy regions.</p>
</li>
<li>
<p>In standard <strong>Langevin Dynamics</strong> , the drift is given by:</p>
</li>
</ul>
<div class="arithmatex">\[
 b(x) = -\nabla E(x)
\]</div>
<ul>
<li>However, in <strong>Regularized X-SDE</strong> , <span class="arithmatex">\(b(x)\)</span> can be modified to incorporate additional prior knowledge, regularization, or auxiliary variables to improve sampling efficiency.</li>
</ul>
<h4 id="622-22-diffusion-term-gx">6.2.2 2.2. Diffusion Term <span class="arithmatex">\(g(x)\)</span><a class="headerlink" href="#622-22-diffusion-term-gx" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p>The diffusion term <span class="arithmatex">\(g(x)\)</span> controls the stochasticity of the process.</p>
</li>
<li>
<p>In standard Langevin Dynamics, the noise term follows:</p>
</li>
</ul>
<div class="arithmatex">\[
 g(x) = \sqrt{2} I
\]</div>
<p>where <span class="arithmatex">\(I\)</span> is the identity matrix.</p>
<ul>
<li>In <strong>Regularized X-SDE</strong> , <span class="arithmatex">\(g(x)\)</span> can be spatially varying, meaning:</li>
</ul>
<div class="arithmatex">\[
 g(x) = g(x)
\]</div>
<p>where <span class="arithmatex">\(g(x)\)</span> is a function that may depend on the energy landscape <span class="arithmatex">\(E(x)\)</span>, allowing for <strong>adaptive noise scaling</strong> .</p>
<h3 id="63-23-generalized-regularized-x-sde-form">6.3 2.3. Generalized Regularized X-SDE Form<a class="headerlink" href="#63-23-generalized-regularized-x-sde-form" title="Permanent link">&para;</a></h3>
<p>A common form of the <strong>Regularized X-SDE</strong>  is</p>
<div class="arithmatex">\[
 dx = -\nabla E(x) dt + g(x) dW_x
\]</div>
<p>where:</p>
<ul>
<li>
<p><span class="arithmatex">\(-\nabla E(x)\)</span> ensures the process moves towards lower-energy regions.</p>
</li>
<li>
<p><span class="arithmatex">\(g(x)\)</span> can be tuned to balance exploration and exploitation, helping to escape local minima.</p>
</li>
</ul>
<h3 id="64-24-practical-adjustments">6.4 2.4. <strong>Practical Adjustments</strong><a class="headerlink" href="#64-24-practical-adjustments" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Preconditioned Langevin Dynamics (PLD):</strong>  <span class="arithmatex">\(b(x)\)</span> is modified as:</li>
</ul>
<div class="arithmatex">\[
 b(x) = - M(x) \nabla E(x)
\]</div>
<p>where <span class="arithmatex">\(M(x)\)</span> is a preconditioning matrix, improving convergence speed.</p>
<ul>
<li><strong>Adaptive Noise Scaling:</strong>  <span class="arithmatex">\(g(x)\)</span> can be chosen to control the amount of stochasticity, improving mixing properties.</li>
</ul>
<p>There are few main popular choise of <span class="arithmatex">\(g(x)\)</span>,</p>
<h4 id="641-241-constant-diffusion-standard-langevin-dynamics">6.4.1 2.4.1 Constant Diffusion (Standard Langevin Dynamics)<a class="headerlink" href="#641-241-constant-diffusion-standard-langevin-dynamics" title="Permanent link">&para;</a></h4>
<div class="arithmatex">\[g(x) = \sqrt(2)I\]</div>
<h4 id="642-242-preconditioned-diffusion">6.4.2 2.4.2 Preconditioned Diffusion<a class="headerlink" href="#642-242-preconditioned-diffusion" title="Permanent link">&para;</a></h4>
<div class="arithmatex">\[ g(x) = \sqrt{2P(x)}\]</div>
<p>where <span class="arithmatex">\(P(x)\)</span> is a preconditioning matrix (positive definite). Some choices of <span class="arithmatex">\(P(x)\)</span></p>
<ul>
<li>Diagonal Preconditioning <span class="arithmatex">\(P(x) = \text{diag} (\gamma_1, \gamma_2, ...,\gamma_d)\)</span> depends on the local curvature of <span class="arithmatex">\(E(x)\)</span></li>
<li>Inverse Hession Approximation: <span class="arithmatex">\(P(x) \approx \left( \nabla^2 E(x) + \epsilon I \right)^{-1}\)</span>,(helps navigate high-curvature regions).</li>
</ul>
<h4 id="643-243-energy-based-diffusion-gradient-magnitude-scaling">6.4.3 2.4.3  Energy-Based Diffusion (Gradient Magnitude Scaling)<a class="headerlink" href="#643-243-energy-based-diffusion-gradient-magnitude-scaling" title="Permanent link">&para;</a></h4>
<div class="arithmatex">\[
 g(x) = \alpha \cdot (1 + \|\nabla E(x)\|^\beta)
\]</div>
<p>where <span class="arithmatex">\(\alpha\)</span> and <span class="arithmatex">\(\beta\)</span> are hyperparameters.</p>
<ul>
<li>
<p><strong>Intuition:</strong>  Increases noise in high-energy regions, encouraging exploration.</p>
</li>
<li>
<p><strong>Use Case:</strong>  Helps escape local minima in multi-modal distributions.</p>
</li>
</ul>
<h4 id="644-244-annealed-langevin-dynamics-temperature-based-diffusion">6.4.4 2.4.4 Annealed Langevin Dynamics (Temperature-Based Diffusion)<a class="headerlink" href="#644-244-annealed-langevin-dynamics-temperature-based-diffusion" title="Permanent link">&para;</a></h4>
<div class="arithmatex">\[
g(x) = \sqrt{2 T(x)}
\]</div>
<p>where <span class="arithmatex">\(T(x)\)</span> is a temperature schedule such as:</p>
<div class="arithmatex">\[
T(x) = \frac{T_0}{1 + \lambda t}
\]</div>
<ul>
<li>
<p><strong>Effect:</strong>  Decreases noise over time, allowing for exploration in early iterations and exploitation in later iterations.</p>
</li>
<li>
<p><strong>Use Case:</strong>  Useful in Bayesian inference and generative modeling.</p>
</li>
</ul>
<h4 id="645-245-score-based-sde-diffusion-models">6.4.5 2.4.5. Score-Based SDE (Diffusion Models)<a class="headerlink" href="#645-245-score-based-sde-diffusion-models" title="Permanent link">&para;</a></h4>
<div class="arithmatex">\[
g(x) = \sigma(t)
\]</div>
<p>where <span class="arithmatex">\(<span class="arithmatex">\(\sigma(t)\)</span>\)</span> follows a decreasing function, such as:</p>
<div class="arithmatex">\[
 \sigma(t) = \sigma_{\max} \left( \frac{t}{T} \right)^{\gamma}
\]</div>
<ul>
<li><strong>Use Case:</strong>  Used in diffusion models for generative modeling.</li>
</ul>
<p><strong>Summary Table</strong></p>
<table>
<thead>
<tr>
<th>Term</th>
<th>Standard Langevin Dynamics</th>
<th>Regularized X-SDE</th>
</tr>
</thead>
<tbody>
<tr>
<td>b(x)</td>
<td><span class="arithmatex">\(-\nabla E(x)\)</span></td>
<td>Can include regularization, preconditioning</td>
</tr>
<tr>
<td><span class="arithmatex">\(g(x)\)</span></td>
<td><span class="arithmatex">\(\sqrt{2} I\)</span></td>
<td>Adaptive function <span class="arithmatex">\(b(x)\)</span>, may depend on xxx</td>
</tr>
</tbody>
</table>
<h3 id="65-3-time-reversal-sde-reverse-diffusion-process">6.5 3. Time-Reversal SDE (Reverse Diffusion Process)<a class="headerlink" href="#65-3-time-reversal-sde-reverse-diffusion-process" title="Permanent link">&para;</a></h3>
<p><strong>Definition</strong> :</p>
<p>Given a forward SDE:</p>
<div class="arithmatex">\[
 dx = f(x, t) dt + g(x) dW_x,
\]</div>
<p>the reverse-time SDE has the form:</p>
<div class="arithmatex">\[
 dx_r = f(x, t) - g(x)^2 \nabla \log p(x, t) + g(x) dW_x,
\]</div>
<p>where <span class="arithmatex">\(p(x, t)\)</span> is the time-dependent probability density.</p>
<p><strong>Applications</strong> :</p>
<ul>
<li>
<p>Generative models (e.g., DDPM, score-based models).</p>
</li>
<li>
<p>Denoising diffusion models for approximating <span class="arithmatex">\(\log p(x)\)</span>.</p>
</li>
</ul>
<p>In this method, we need to construct a path that maps from the original data distribution to some easy distribution, and then use the revserse process (as defined in the SDE) to sample from target data distribution.</p>
<h3 id="66-4-preconditioned-langevin-dynamics">6.6 4. Preconditioned Langevin Dynamics<a class="headerlink" href="#66-4-preconditioned-langevin-dynamics" title="Permanent link">&para;</a></h3>
<p><strong>Definition</strong> :</p>
<p>Introduces a preconditioning matrix <span class="arithmatex">\(P(x)\)</span> to accelerate convergence which is a special case of regularized X-SDE. The SDE is:</p>
<div class="arithmatex">\[
 dx = -P(x) \nabla E(x) dt + \sqrt{2P(x)} dW_x,
\]</div>
<p>where <span class="arithmatex">\(P(x)\)</span> is symmetric and positive definite.</p>
<p><strong>Features</strong> :</p>
<ul>
<li>
<p>Efficient sampling when <span class="arithmatex">\(P(x)\)</span> adapts to the geometry of <span class="arithmatex">\(E(x)\)</span>.</p>
</li>
<li>
<p>Extends to include Riemannian manifold-based methods.</p>
</li>
</ul>
<p>Preconditioned SDE (or Preconditioned Langevin Dynamics) is used to improve <strong>sampling efficiency</strong>  and <strong>convergence speed</strong>  in stochastic optimization and generative modeling. The main idea is to introduce a preconditioning matrix <span class="arithmatex">\(P(x)\)</span>  that adapts the sampling dynamics to the local geometry of the energy function <span class="arithmatex">\(E(x)\)</span>. This helps navigate complex landscapes more effectively, especially when different directions in the space have different scales of variation.</p>
<p><strong>Where Does the Idea Come From?</strong> The idea comes from <strong>natural gradient methods</strong>  and <strong>Riemannian manifold-based optimization</strong> , where the <strong>metric tensor</strong>  is used to adapt learning rates per dimension. In standard Langevin dynamics:</p>
<div class="arithmatex">\[
dx = -\nabla E(x) dt + \sqrt{2} dW_x
\]</div>
<ul>
<li>
<p>The step size in each direction is <strong>uniform</strong> , which can lead to slow mixing if the energy landscape has anisotropic (different scaling in different directions) curvature.</p>
</li>
<li>
<p>In high-dimensional spaces, some directions have strong gradients, while others are almost flat, causing inefficient exploration.
By introducing <span class="arithmatex">\(P(x)\)</span> , we scale the gradient and noise adaptively:</p>
</li>
</ul>
<div class="arithmatex">\[
dx = -P(x) \nabla E(x) dt + \sqrt{2P(x)} dW_x
\]</div>
<p>where <span class="arithmatex">\(P(x)\)</span> is a positive definite symmetric matrix that <strong>scales updates differently in each direction</strong> .</p>
<p><strong>Usage and Simple Example</strong></p>
<p>Let’s consider a simple case where:</p>
<div class="arithmatex">\[
 P(x) = \text{diag}(p_1, p_2, ..., p_n)
\]</div>
<p>This means that we scale each coordinate <strong>independently</strong> .</p>
<p><strong>Example: Sampling from an Anisotropic Gaussian</strong></p>
<p>Consider an energy function for a Gaussian distribution:</p>
<div class="arithmatex">\[
 E(x) = \frac{1}{2} x^T A x
\]</div>
<p>where <span class="arithmatex">\(A\)</span> is a diagonal matrix:</p>
<div class="arithmatex">\[
A = \begin{bmatrix} 10 &amp; 0 \\ 0 &amp; 1 \end{bmatrix}
\]</div>
<p>This means:</p>
<ul>
<li>
<p>The first dimension has <strong>stronger curvature</strong>  (steeper gradient).</p>
</li>
<li>
<p>The second dimension has <strong>weaker curvature</strong>  (flatter gradient).</p>
</li>
</ul>
<p>Using standard Langevin dynamics:</p>
<div class="arithmatex">\[
dx = -A x dt + \sqrt{2} dW_x
\]</div>
<ul>
<li>
<p>The first component moves very slowly due to large gradients.</p>
</li>
<li>
<p>The second component moves faster, leading to inefficient exploration.</p>
</li>
</ul>
<p><strong>Applying Preconditioning</strong></p>
<p>Now, we apply a preconditioner:</p>
<div class="arithmatex">\[
P(x) = A^{-1} = \begin{bmatrix} 0.1 &amp; 0 \\ 0 &amp; 1 \end{bmatrix}
\]</div>
<p>which leads to:</p>
<div class="arithmatex">\[
dx = - P(x) A x dt + \sqrt{2P(x)} dW_x
\]</div>
<p>Since <span class="arithmatex">\(P(x) A = I\)</span>, the dynamics become:</p>
<div class="arithmatex">\[
dx = - x dt + \sqrt{2P(x)} dW_x
\]</div>
<p>which <strong>normalizes the scales in all directions</strong> , making the sampling <strong>more efficient</strong></p>
<h3 id="67-summary-of-sde-models">6.7 Summary of SDE Models<a class="headerlink" href="#67-summary-of-sde-models" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>SDE Type</th>
<th>Core Concept</th>
<th>Advantages</th>
<th>Applications</th>
</tr>
</thead>
<tbody>
<tr>
<td>General Langevin Dynamics</td>
<td>Basic diffusion model</td>
<td>Theoretical clarity</td>
<td>Generative modeling</td>
</tr>
<tr>
<td>Underdamped Langevin Dynamics</td>
<td>Adds momentum</td>
<td>Faster convergence</td>
<td>Sampling, optimization</td>
</tr>
<tr>
<td>Preconditioned Langevin Dynamics</td>
<td>Preconditioning matrix for geometry</td>
<td>Accelerates convergence</td>
<td>Bayesian inference</td>
</tr>
<tr>
<td>Coupled SDE-ODE</td>
<td>Balance of stochastic/deterministic</td>
<td>Stable dynamics</td>
<td>Scientific computing</td>
</tr>
<tr>
<td>Reverse-Time SDE</td>
<td>Diffusion process reversal</td>
<td>High-quality generation</td>
<td>Generative models</td>
</tr>
</tbody>
</table>
<h3 id="68-learning-objectives">6.8 Learning Objectives<a class="headerlink" href="#68-learning-objectives" title="Permanent link">&para;</a></h3>
<p>Why do different SDE formulations yield the same equilibrium distribution?</p>
<p><strong>Mathematical Tool</strong> :</p>
<p><strong>Fokker-Planck equation</strong></p>
<p>For the SDE <span class="arithmatex">\(dx = b(x) dt + \sigma(x) dW_x\)</span>, the Fokker-Planck equation is:</p>
<div class="arithmatex">\[
 \frac{\partial p}{\partial t} = -\nabla \cdot (p b) + \frac{1}{2} \nabla^2(p \sigma \sigma^\top),
\]</div>
<p>where <span class="arithmatex">\(p(x, t)\)</span> is the probability density, <span class="arithmatex">\(b(x)\)</span> the drift term, and <span class="arithmatex">\(\sigma(x)\)</span> the diffusion term. Stationary solution <span class="arithmatex">\(p(x)\)</span> satisfies:</p>
<div class="arithmatex">\[
 \nabla \cdot (p b) = \frac{1}{2} \nabla^2(p \sigma \sigma^\top).
\]</div>
<p>By adjusting <span class="arithmatex">\(b(x)\)</span> and <span class="arithmatex">\(\sigma(x)\)</span>, one can achieve the desired stationary distribution.</p>
<h3 id="69-practical-recommendations">6.9 Practical Recommendations<a class="headerlink" href="#69-practical-recommendations" title="Permanent link">&para;</a></h3>
<ol>
<li>
<p>Choose the SDE based on your specific problem and computational constraints.</p>
</li>
<li>
<p>For generative tasks, consider time-reversal SDEs or preconditioned Langevin dynamics.</p>
</li>
<li>
<p>When optimizing, balance between exploration (stochastic) and exploitation (deterministic).</p>
</li>
</ol>
<h2 id="7-details-of-annealed-langevin-dynamics-sampling">7. Details of Annealed Langevin Dynamics Sampling<a class="headerlink" href="#7-details-of-annealed-langevin-dynamics-sampling" title="Permanent link">&para;</a></h2>
<h3 id="71-1-definition">7.1 1. Definition<a class="headerlink" href="#71-1-definition" title="Permanent link">&para;</a></h3>
<p>Annealed Langevin Dynamics Sampling is a stochastic sampling method that incorporates temperature annealing. It enhances the system's ability to explore the target space, balancing between exploration (searching globally) and exploitation (refining locally).</p>
<h3 id="72-2-core-principles">7.2 2. Core Principles<a class="headerlink" href="#72-2-core-principles" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p><strong>Annealing</strong> : Introduces a temperature schedule <span class="arithmatex">\(T(t)\)</span>, which controls the degree of randomness (higher temperatures lead to larger noise, encouraging exploration; lower temperatures reduce noise for refined optimization).</p>
</li>
<li>
<p><strong>Stationary Distribution</strong> : Gradually transitions the sampling distribution towards the target distribution <span class="arithmatex">\(p(x) \propto e^{-E(x)}\)</span> by reducing the temperature.</p>
</li>
</ul>
<h3 id="73-3-mathematical-formulation-and-derivation">7.3 3. Mathematical Formulation and Derivation<a class="headerlink" href="#73-3-mathematical-formulation-and-derivation" title="Permanent link">&para;</a></h3>
<p>The dynamic form of Annealed Langevin Dynamics is:</p>
<div class="arithmatex">\[
 dx_t = -\nabla U(x_t) dt + \sqrt{2 T(t)} dW_t,
\]</div>
<p>where:</p>
<ul>
<li>
<p><span class="arithmatex">\(T(t)\)</span>: Temperature schedule (e.g., exponential decay <span class="arithmatex">\(T(t) = T_0 e^{-\beta t}\)</span>, or other schedules like polynomial decay <span class="arithmatex">\(T_k = T_0 / (1 + k)\)</span>).</p>
</li>
<li>
<p>Noise term: <span class="arithmatex">\(\sqrt{2 T(t)} dW_t\)</span> ensures randomness at each step.</p>
</li>
</ul>
<p>The discrete iteration formula becomes:</p>
<div class="arithmatex">\[
 x_{k+1} = x_k - \epsilon \nabla U(x_k) + \sqrt{2 \epsilon T_k} \xi_k, \quad \xi_k \sim \mathcal{N}(0, I),
\]</div>
<p>where <span class="arithmatex">\(\epsilon\)</span> is the step size, and <span class="arithmatex">\(\xi_k\)</span> is Gaussian noise.</p>
<h3 id="74-4-temperature-scheduling-design">7.4 4. Temperature Scheduling Design<a class="headerlink" href="#74-4-temperature-scheduling-design" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p><strong>Exponential Decay</strong> : <span class="arithmatex">\(T_k = T_0 \cdot \gamma^k\)</span>, where <span class="arithmatex">\(0 &lt; \gamma &lt; 1\)</span>.</p>
</li>
<li>
<p><strong>Polynomial Decay</strong> : <span class="arithmatex">\(T_k = T_0 / (1 + k)^\alpha\)</span>, where <span class="arithmatex">\(\alpha &gt; 0\)</span>.</p>
</li>
<li>
<p><strong>Adaptive Scheduling</strong> : Adjust <span class="arithmatex">\(T_k\)</span> based on the sampling performance (e.g., adaptively reduce noise if the acceptance rate decreases).</p>
</li>
</ul>
<p>Key parameters:</p>
<ul>
<li>
<p><strong>Initial Temperature</strong>  <span class="arithmatex">\(T_0\)</span> : Chosen high enough to explore the search space widely.</p>
</li>
<li>
<p><strong>Final Temperature</strong> : Chosen low enough to focus on the target distribution.</p>
</li>
<li>
<p><strong>Step Size</strong>  <span class="arithmatex">\(\epsilon\)</span> : Adjusted to balance accuracy and computational cost.</p>
</li>
</ul>
<hr />
<h3 id="75-5-theoretical-analysis">7.5 5. Theoretical Analysis<a class="headerlink" href="#75-5-theoretical-analysis" title="Permanent link">&para;</a></h3>
<p>In the presence of temperature <span class="arithmatex">\(T\)</span>, the stationary distribution of Langevin Dynamics becomes:</p>
<div class="arithmatex">\[
 p_T(x) \propto e^{-E(x)/T}.
\]</div>
<p>As <span class="arithmatex">\(T \to 0\)</span>, the distribution transitions to <span class="arithmatex">\(p(x) \propto e^{-E(x)}\)</span> (i.e., the target distribution).</p>
<p><strong>Convergence Analysis</strong> :</p>
<ul>
<li>
<p><strong>Exploration</strong> : High temperatures help explore distant regions of the space.</p>
</li>
<li>
<p><strong>Exploitation</strong> : Gradual cooling refines the search towards the target distribution.</p>
</li>
</ul>
<h3 id="76-6-applications">7.6 6. Applications<a class="headerlink" href="#76-6-applications" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p><strong>Generative Models</strong> : Used in training and optimization tasks for high-dimensional data.</p>
</li>
<li>
<p><strong>Non-Convex Optimization</strong> : Combines annealing and dynamics for escaping local minima.</p>
</li>
</ul>
<h3 id="77-7-practical-steps">7.7 7. Practical Steps<a class="headerlink" href="#77-7-practical-steps" title="Permanent link">&para;</a></h3>
<ol>
<li>
<p><strong>Initialization</strong> :</p>
</li>
<li>
<p>Set the initial temperature <span class="arithmatex">\(T_0\)</span>, annealing schedule, step size <span class="arithmatex">\(\epsilon\)</span>, and random initialization of <span class="arithmatex">\(x_0\)</span>.</p>
</li>
<li>
<p><strong>Iteration</strong> :</p>
</li>
<li>
<p>Compute <span class="arithmatex">\(\nabla U(x_k)\)</span>.</p>
</li>
<li>
<p>Update <span class="arithmatex">\(T_k\)</span> based on the annealing schedule.</p>
</li>
<li>
<p>Perform the update:</p>
</li>
</ol>
<div class="arithmatex">\[
 x_{k+1} = x_k - \epsilon \nabla U(x_k) + \sqrt{2 \epsilon T_k} \xi_k.
\]</div>
<ol>
<li>
<p><strong>Convergence</strong> :</p>
</li>
<li>
<p>Stop when the temperature reaches a specified threshold or convergence criteria are met.</p>
</li>
</ol>
<p><strong>Python Code Example</strong> :</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-3-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-3-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-3-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-3-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-3-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-3-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-3-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-3-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-3-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-3-10">10</a></span>
<span class="normal"><a href="#__codelineno-3-11">11</a></span>
<span class="normal"><a href="#__codelineno-3-12">12</a></span>
<span class="normal"><a href="#__codelineno-3-13">13</a></span>
<span class="normal"><a href="#__codelineno-3-14">14</a></span>
<span class="normal"><a href="#__codelineno-3-15">15</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1"></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<a id="__codelineno-3-2" name="__codelineno-3-2"></a>
<a id="__codelineno-3-3" name="__codelineno-3-3"></a><span class="k">def</span> <span class="nf">annealed_langevin</span><span class="p">(</span><span class="n">grad_U</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">T0</span><span class="p">,</span> <span class="n">epsilon</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">,</span> <span class="n">schedule</span><span class="o">=</span><span class="s1">&#39;exponential&#39;</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="mf">0.99</span><span class="p">):</span>
<a id="__codelineno-3-4" name="__codelineno-3-4"></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">x0</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-3-5" name="__codelineno-3-5"></a>    <span class="n">samples</span> <span class="o">=</span> <span class="p">[</span><span class="n">x0</span><span class="p">]</span>
<a id="__codelineno-3-6" name="__codelineno-3-6"></a>    <span class="n">T</span> <span class="o">=</span> <span class="n">T0</span>
<a id="__codelineno-3-7" name="__codelineno-3-7"></a>    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>
<a id="__codelineno-3-8" name="__codelineno-3-8"></a>        <span class="k">if</span> <span class="n">schedule</span> <span class="o">==</span> <span class="s1">&#39;exponential&#39;</span><span class="p">:</span>
<a id="__codelineno-3-9" name="__codelineno-3-9"></a>            <span class="n">T</span> <span class="o">=</span> <span class="n">T0</span> <span class="o">*</span> <span class="n">gamma</span> <span class="o">**</span> <span class="n">k</span>
<a id="__codelineno-3-10" name="__codelineno-3-10"></a>        <span class="k">elif</span> <span class="n">schedule</span> <span class="o">==</span> <span class="s1">&#39;polynomial&#39;</span><span class="p">:</span>
<a id="__codelineno-3-11" name="__codelineno-3-11"></a>            <span class="n">T</span> <span class="o">=</span> <span class="n">T0</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">k</span><span class="p">)</span>
<a id="__codelineno-3-12" name="__codelineno-3-12"></a>        <span class="n">noise</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">epsilon</span> <span class="o">*</span> <span class="n">T</span><span class="p">)</span>
<a id="__codelineno-3-13" name="__codelineno-3-13"></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">epsilon</span> <span class="o">*</span> <span class="n">grad_E</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">noise</span>
<a id="__codelineno-3-14" name="__codelineno-3-14"></a>        <span class="n">samples</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-3-15" name="__codelineno-3-15"></a>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<h3 id="78-8-comparison-with-other-methods">7.8 8. Comparison with Other Methods<a class="headerlink" href="#78-8-comparison-with-other-methods" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Method</th>
<th>Annealing Strategy</th>
<th>Noise Term</th>
<th>Suitable Scenarios</th>
</tr>
</thead>
<tbody>
<tr>
<td>Standard Langevin Dynamics</td>
<td>None</td>
<td>Yes</td>
<td>Single-mode stationary distributions</td>
</tr>
<tr>
<td>Annealed Langevin Dynamics</td>
<td>Yes</td>
<td>Yes</td>
<td>Multi-modal distributions, generative models</td>
</tr>
<tr>
<td>Simulated Annealing</td>
<td>Yes</td>
<td>No</td>
<td>Combinatorial optimization, discrete space</td>
</tr>
<tr>
<td>Hamiltonian Monte Carlo (HMC)</td>
<td>None</td>
<td>No</td>
<td>High-dimensional, parametric distributions</td>
</tr>
</tbody>
</table>
<h3 id="79-9-advanced-extensions">7.9 9. Advanced Extensions<a class="headerlink" href="#79-9-advanced-extensions" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p><strong>SGLD with Annealing</strong> :
Combines stochastic gradient Langevin dynamics with annealing for large-scale datasets.</p>
</li>
<li>
<p><strong>Adaptive Annealing</strong> :
Dynamically adjusts the annealing schedule based on feedback (e.g., acceptance rate, energy variance).</p>
</li>
</ul>
<hr />
<h3 id="710-10-key-considerations">7.10 10. Key Considerations<a class="headerlink" href="#710-10-key-considerations" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p><strong>Temperature Schedule</strong> : Improper schedules (e.g., too rapid cooling) may lead to poor convergence.</p>
</li>
<li>
<p><strong>Step Size Selection</strong> : Balances convergence speed with numerical stability.</p>
</li>
</ul>









  





                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../score_function/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Score Functions">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Score Functions
              </div>
            </div>
          </a>
        
        
          
          <a href="../cd/" class="md-footer__link md-footer__link--next" aria-label="Next: Contrastive Divergence">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Contrastive Divergence
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://mad-sg.github.io/generative-ai-start-to-surrender/" target="_blank" rel="noopener" title="mad-sg.github.io" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://hub.docker.com/r/squidfunk/mkdocs-material/" target="_blank" rel="noopener" title="hub.docker.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M349.9 236.3h-66.1v-59.4h66.1zm0-204.3h-66.1v60.7h66.1zm78.2 144.8H362v59.4h66.1zm-156.3-72.1h-66.1v60.1h66.1zm78.1 0h-66.1v60.1h66.1zm276.8 100c-14.4-9.7-47.6-13.2-73.1-8.4-3.3-24-16.7-44.9-41.1-63.7l-14-9.3-9.3 14c-18.4 27.8-23.4 73.6-3.7 103.8-8.7 4.7-25.8 11.1-48.4 10.7H2.4c-8.7 50.8 5.8 116.8 44 162.1 37.1 43.9 92.7 66.2 165.4 66.2 157.4 0 273.9-72.5 328.4-204.2 21.4.4 67.6.1 91.3-45.2 1.5-2.5 6.6-13.2 8.5-17.1zm-511.1-27.9h-66v59.4h66.1v-59.4zm78.1 0h-66.1v59.4h66.1zm78.1 0h-66.1v59.4h66.1zm-78.1-72.1h-66.1v60.1h66.1z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://pypi.org/project/mkdocs-material/" target="_blank" rel="noopener" title="pypi.org" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6M286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3M167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4m-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://bsky.app/profile/squidfunk.bsky.social" target="_blank" rel="noopener" title="bsky.app" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M111.8 62.2C170.2 105.9 233 194.7 256 242.4c23-47.6 85.8-136.4 144.2-180.2 42.1-31.6 110.3-56 110.3 21.8 0 15.5-8.9 130.5-14.1 149.2-18.2 64.8-84.4 81.4-143.3 71.3C456 322 482.2 380 425.6 438c-107.4 110.2-154.3-27.6-166.3-62.9-1.7-4.9-2.6-7.8-3.3-7.8s-1.6 3-3.3 7.8c-12 35.3-59 173.1-166.3 62.9-56.5-58-30.4-116 72.5-133.5C100 314.6 33.8 298 15.7 233.1 10.4 214.4 1.5 99.4 1.5 83.9c0-77.8 68.2-53.4 110.3-21.8z"/></svg>
    </a>
  
    
    
      
    
    
    
      
      
    
    <a href="https://fosstodon.org/@squidfunk" target="_blank" rel="noopener me" title="fosstodon.org" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M433 179.11c0-97.2-63.71-125.7-63.71-125.7-62.52-28.7-228.56-28.4-290.48 0 0 0-63.72 28.5-63.72 125.7 0 115.7-6.6 259.4 105.63 289.1 40.51 10.7 75.32 13 103.33 11.4 50.81-2.8 79.32-18.1 79.32-18.1l-1.7-36.9s-36.31 11.4-77.12 10.1c-40.41-1.4-83-4.4-89.63-54a102.5 102.5 0 0 1-.9-13.9c85.63 20.9 158.65 9.1 178.75 6.7 56.12-6.7 105-41.3 111.23-72.9 9.8-49.8 9-121.5 9-121.5m-75.12 125.2h-46.63v-114.2c0-49.7-64-51.6-64 6.9v62.5h-46.33V197c0-58.5-64-56.6-64-6.9v114.2H90.19c0-122.1-5.2-147.9 18.41-175 25.9-28.9 79.82-30.8 103.83 6.1l11.6 19.5 11.6-19.5c24.11-37.1 78.12-34.8 103.83-6.1 23.71 27.3 18.4 53 18.4 175z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://x.com/squidfunk" target="_blank" rel="noopener" title="x.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8l164.9-188.5L26.8 48h145.6l100.5 132.9zm-24.8 373.8h39.1L151.1 88h-42z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tabs", "toc.integrate", "content.code.copy", "content.code.select", "content.code.annotate", "content.tabs.link", "content.footnote.tooltips", "content.tooltips", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow", "announce.dismiss", "content.action.edit", "content.action.view", "content.code.annotate", "navigation.footer", "navigation.indexes", "navigation.sections", "navigation.tabs", "navigation.top", "navigation.expand", "search.share", "search.suggest"], "search": "../../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.88dd0f4e.min.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.min.js"></script>
      
        <script src="../../../javascripts/mathjax.js"></script>
      
        <script src="https://giscus.app/client.js"></script>
      
    
  <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body>
</html>
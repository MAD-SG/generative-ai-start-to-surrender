
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.50">
    
    
      
        <title>Stochastic Differential Equation for DDPM and DSM - Generative AI: From Start to Surrender</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.a40c8224.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#stochastic-differential-equation-for-ddpm-and-dsm" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Generative AI: From Start to Surrender" class="md-header__button md-logo" aria-label="Generative AI: From Start to Surrender" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Generative AI: From Start to Surrender
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Stochastic Differential Equation for DDPM and DSM
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../chapter1_Introduction/1.1terminology/" class="md-tabs__link">
          
  
  Introduction

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../chapter2_VAE/2.1introduction/" class="md-tabs__link">
          
  
  VAE

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../chapter3_GAN/3.1from_gan_to_stylegan/paper/" class="md-tabs__link">
          
  
  GANs

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../chapter4_diffusion/4.1introduction/" class="md-tabs__link">
          
  
  Diffusion

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../chapter5_generation_theory/5.1MLE/" class="md-tabs__link">
          
  
  Generation Theory

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../chapter6_ebm/introduction/" class="md-tabs__link">
          
  
  Energy Based Models

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Generative AI: From Start to Surrender" class="md-nav__button md-logo" aria-label="Generative AI: From Start to Surrender" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Generative AI: From Start to Surrender
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Introduction
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter1_Introduction/1.1terminology/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Terms
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter1_Introduction/1.2fourier_transform/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fourier Transform
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter1_Introduction/1.3signal_processing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Signal Processing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter1_Introduction/1.4statistics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Statistics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter1_Introduction/1.5SDE/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SDE
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter1_Introduction/tutorials/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tutorials
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    VAE
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            VAE
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter2_VAE/2.1introduction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    GANs
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            GANs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter3_GAN/3.1from_gan_to_stylegan/paper/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    From GAN to PGGAN
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter3_GAN/3.3stylegan/paper/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    StyleGAN
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter3_GAN/3.4stylegan2/paper/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    StyleGAN2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter3_GAN/3.5stylegan3/paper/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    StyleGAN3
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter3_GAN/3.6styleganT/paper/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    StyleGAN T
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter3_GAN/3.7R3Gan/paper/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    R3GAN
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Diffusion
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Diffusion
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter4_diffusion/4.1introduction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter4_diffusion/4.2DDPM/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DDPM
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Generation Theory
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Generation Theory
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter5_generation_theory/5.1MLE/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Maximal Likelihood
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter5_generation_theory/manifold_hypothesis/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Manifold Hypothesis
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Energy Based Models
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Energy Based Models
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter6_ebm/introduction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter6_ebm/score_function/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Score Function
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter6_ebm/sampling/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sampling
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter6_ebm/cd/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contrastive Divergence
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter6_ebm/score_matching/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Score Matching
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="stochastic-differential-equation-for-ddpm-and-dsm">Stochastic Differential Equation for DDPM and DSM<a class="headerlink" href="#stochastic-differential-equation-for-ddpm-and-dsm" title="Permanent link">&para;</a></h1>
<p>In this section, we show how connect SDE with the denoising defussion probabilistic model and
the denoising score matching.</p>
<h2 id="autocorrelation">Autocorrelation<a class="headerlink" href="#autocorrelation" title="Permanent link">&para;</a></h2>
<p>In the context of the excerpt, the term “autocorrelation function” refers to the covariance</p>
<div class="arithmatex">\[
 \mathbb{E}[\xi(t)\,\xi(t')]\quad
\]</div>
<p>of the noise process <span class="arithmatex">\(\xi(\cdot)\)</span> evaluated at two different times <span class="arithmatex">\(t\)</span> and <span class="arithmatex">\(t'\)</span>. For an
idealized <strong>white‐noise</strong>  process (as in standard Brownian motion), this autocorrelation is
taken to be a <strong>Dirac delta function</strong> :</p>
<div class="arithmatex">\[
 \mathbb{E}[\xi(t)\,\xi(t')] \;=\;\delta(t - t').
\]</div>
<p>Intuitively, this means that <span class="arithmatex">\(\xi(t)\)</span> is “uncorrelated” with itself at any times <span class="arithmatex">\(t \neq t'\)</span>,
and all of its correlation is concentrated at the single point <span class="arithmatex">\(t = t'\)</span>. In more precise terms,
the Dirac delta is not a function in the usual sense but a distribution, capturing the idea that
white noise has no memory or persistence in time—any two distinct instants are independent,
but at the same instant the variance (or “intensity”) is infinite in such a way that it integrates
to a finite value over an infinitesimal interval.</p>
<h2 id="forward-diffusion">Forward Diffusion<a class="headerlink" href="#forward-diffusion" title="Permanent link">&para;</a></h2>
<p>Suppose we have the <em>forward</em> SDE(1)</p>
<div class="arithmatex">\[
 \tag{1}
dx \;=\; f(x,t)\,dt \;+\; g(t)\,dW_t,
\]</div>
<p>where <span class="arithmatex">\(W_t\)</span> is a standard Wiener process, and <span class="arithmatex">\(g(t)\)</span> is (for simplicity) taken to be spatially
constant but possibly time‐dependent. Let <span class="arithmatex">\(p_t(x)\)</span> be the probability density of <span class="arithmatex">\(x_t\)</span> at
time <span class="arithmatex">\(t\)</span>.</p>
<h2 id="reverse-diffusion">Reverse Diffusion<a class="headerlink" href="#reverse-diffusion" title="Permanent link">&para;</a></h2>
<p>Suppose <span class="arithmatex">\(p_t(x)\)</span> is the density metric for <span class="arithmatex">\(x\)</span> at time <span class="arithmatex">\(t\)</span>, then by the Fokker-Planck Equation, we have</p>
<div class="arithmatex">\[
\tag{2}
 dx \;=\;
\bigl[f(x,t)\;-\;g(t)^2\,\nabla_x \log p_{t}(x)\bigr]\;dt \;+\; g(t)\,d\overline{W}_t,
\]</div>
<p>In the following, we give more details why this backward diffusion holds for the density function
<span class="arithmatex">\(p_t(x)\)</span>.</p>
<h3 id="fokkerplanck-forward-kolmogorov-equation">Fokker–Planck (Forward Kolmogorov) Equation<a class="headerlink" href="#fokkerplanck-forward-kolmogorov-equation" title="Permanent link">&para;</a></h3>
<p>The density <span class="arithmatex">\(p_t(x)\)</span> satisfies the Fokker–Planck (or forward‐Kolmogorov) PDE</p>
<p>$$\tag{3}
 \frac{\partial p_t(x)}{\partial t}
\;=\;
-\nabla!\cdot!\bigl[f(x,t)\,p_t(x)\bigr]
\;+\;
\frac{1}{2}\,g(t)^2\,\Delta p_t(x),
$$
where <span class="arithmatex">\(\Delta\)</span> is the Laplacian in <span class="arithmatex">\(x\)</span>.</p>
<p><strong>NOTE</strong></p>
<blockquote>
<p>In <strong>one dimension</strong> , the Laplacian simplifies to:</p>
<p>$$
 \Delta p_t(x) = \frac{\partial^2 p_t(x)}{\partial x^2}
 $$</p>
<p>In <strong>higher dimensions</strong> , the Laplacian is given by:</p>
<p>$$
 \Delta p_t(x) = \sum_{i=1}^{d} \frac{\partial^2 p_t(x)}{\partial x_i^2}
 $$</p>
<p>where <span class="arithmatex">\(d\)</span> is the dimension of the space. Thus, in the context of the <strong>Fokker-Planck equation</strong>, the Laplacian term governs the <strong>diffusive spreading</strong>  of the probability density due to the noise term <span class="arithmatex">\(g(t) dW_t\)</span> in the associated SDE.</p>
</blockquote>
<p>Now we prove that the reverse diffusion formula</p>
<h3 id="timereversal-strategy">Time‐Reversal Strategy<a class="headerlink" href="#timereversal-strategy" title="Permanent link">&para;</a></h3>
<p>We want an SDE whose sample paths “run backward” in time with the <em>same</em> distributions as <span class="arithmatex">\((x_t)\)</span>
 running forward. Concretely, define</p>
<p>$$
 \hat{X}<em>s \;=\; x</em>{T - s}
\quad
\text{for } 0 \le s \le T.
$$</p>
<p>That is, <span class="arithmatex">\(\hat{X}_0 = x_T\)</span>, <span class="arithmatex">\(\hat{X}_T = x_0\)</span>. Our goal is to find a stochastic differential
equation of the form</p>
<div class="arithmatex">\[
 \tag{2}
d\hat{X}_s
\;=\; \hat{f}\bigl(\hat{X}_s, s\bigr)\,ds
\;+\;
g(T-s)\,d\overline{W}_s
\]</div>
<p>(where <span class="arithmatex">\(\overline{W}_s\)</span> is another Wiener process) such that <span class="arithmatex">\(\hat{X}_s\)</span> has the <em>same</em> distribution as <span class="arithmatex">\(x_{T-s}\)</span>.In other words, if <span class="arithmatex">\(q_s(x)\)</span> denotes the density of <span class="arithmatex">\(\hat{X}_s\)</span>, we want <span class="arithmatex">\(q_s(x) = p_{T-s}(x)\)</span>. We must determine the drift <span class="arithmatex">\(\hat{f}(x,s)\)</span>.</p>
<h2 id="3-matching-probability-densities-via-fokkerplanck">3. Matching Probability Densities via Fokker–Planck<a class="headerlink" href="#3-matching-probability-densities-via-fokkerplanck" title="Permanent link">&para;</a></h2>
<h3 id="31-pde-for-the-reverse-process">3.1. PDE for the reverse process<a class="headerlink" href="#31-pde-for-the-reverse-process" title="Permanent link">&para;</a></h3>
<p>If <span class="arithmatex">\(<span class="arithmatex">\(\hat{X}_s\)</span>\)</span> satisfies$$
 d\hat{X}<em>s
= \hat{f}(\hat{X}_s, s)\,ds
\;+\;
g(T-s)\,d\overline{W}_s,
$$
then its density <span class="arithmatex">(<span class="arithmatex">\(q_s(x)\)</span>\)</span> obeys$$
 \frac{\partial q_s(x)}{\partial s}
\;=\;
-\nabla \cdot \bigl[\hat{f}(x, s)\;q_s(x)\bigr]
\;+\;
\frac{1}{2}\,g(T-s)^2\;\Delta\,q_s(x).
$$
We require <span class="arithmatex">(<span class="arithmatex">\(q_s(x) = p_{T-s}(x)\)</span>\)</span>. Substitute <span class="arithmatex">(<span class="arithmatex">\(q_s(x) = p_{T-s}(x)\)</span>\)</span> into the PDE. Note that$$
 \frac{\partial}{\partial s}\,p</em>{T-s}(x)
\;=\;
-\,\frac{\partial}{\partial t}\,p_{t}(x)\Bigr|_{\,t=T-s}.
$$</p>
<p>Hence
$$
 \frac{\partial q_s}{\partial s}(x)
\;=\;
-\,\frac{\partial}{\partial t}\,p_{t}(x)\Bigr|<em>{t=T-s}.
$$
But from the <em>forward</em> Fokker–Planck equation, we know$$
 \frac{\partial}{\partial t}\,p</em>{t}(x)
\;=\;
-\nabla!\cdot!\bigl[f(x,t)\,p_t(x)\bigr]
+\tfrac{1}{2}\,g(t)^2\,\Delta\,p_t(x).
$$
Putting <span class="arithmatex">\(<span class="arithmatex">\(t = T-s\)</span>\)</span> and changing the sign, we get$$
 \frac{\partial q_s}{\partial s}(x)
\;=\;
+\nabla!\cdot!\bigl[f(x,T-s)\,p_{T-s}(x)\bigr]
\;-\;
\tfrac{1}{2}\,g(T-s)^2\,\Delta\,p_{T-s}(x).
$$
3.2. Identifying the reversed drift <span class="arithmatex">\(<span class="arithmatex">\(\hat{f}\)</span>\)</span>Meanwhile, from the PDE for <span class="arithmatex">\(<span class="arithmatex">\(q_s\)</span>\)</span> we also have$$
 \frac{\partial q_s}{\partial s}(x)
\;=\;
-\,\nabla!\cdot!\bigl[\hat{f}(x,s)\,q_s(x)\bigr]
\;+\;
\tfrac12\,g(T-s)^2\,\Delta\,q_s(x).
$$
Because <span class="arithmatex">\(<span class="arithmatex">\(q_s(x) = p_{T-s}(x)\)</span>\)</span>, we can equate the two expressions. Matching terms gives$$
 \nabla!\cdot!\bigl[\hat{f}(x,s)\,p_{T-s}(x)\bigr]
\;=\;
-\,\nabla!\cdot!\bigl[f(x,T-s)\,p_{T-s}(x)\bigr]
\;+\;
g(T-s)^2 \,\nabla !\cdot!\bigl[\tfrac12\,p_{T-s}(x)\bigr],
$$
where we used that <span class="arithmatex">\(<span class="arithmatex">\(\Delta\,p_{T-s}(x) = \nabla \cdot (\nabla\,p_{T-s}(x))\)</span>\)</span>. Rearrange:$$
 \nabla!\cdot!\Bigl[\hat{f}(x,s)\,p_{T-s}(x)\Bigr]
\;=\;
-\nabla!\cdot!\Bigl[f(x,T-s)\,p_{T-s}(x)\Bigr]
\;+\;
\tfrac12\,g(T-s)^2\,\nabla \cdot!\Bigl[\nabla\,p_{T-s}(x)\Bigr].
$$
We can factor out <span class="arithmatex">\(<span class="arithmatex">\(p_{T-s}(x)\)</span>\)</span> to write$$
 \hat{f}(x,s)\,p_{T-s}(x)
\;=\;
f(x,T-s)\,p_{T-s}(x)
\;-\;
\tfrac12\,g(T-s)^2\,\nabla\,p_{T-s}(x)
\;+\;
\text{(gradient‐free constant in } x\text{)},
$$
but the divergence‐free “constant” in <span class="arithmatex">\(<span class="arithmatex">\(x\)</span>\)</span> must be zero if we want the correct boundary conditions at infinity and a well‐defined velocity field. Dividing both sides by <span class="arithmatex">\(<span class="arithmatex">\(p_{T-s}(x)\)</span>\)</span> then yields$$
 \hat{f}(x,s)
\;=\;
f(x,T-s)
\;-\;
\tfrac12\,g(T-s)^2\,\nabla \log p_{T-s}(x).
$$</p>
<p>This is precisely the extra “score‐function” correction term discovered by Nelson and Anderson.</p>
<hr />
<h2 id="4-final-reverse-sde">4. Final Reverse SDE<a class="headerlink" href="#4-final-reverse-sde" title="Permanent link">&para;</a></h2>
<p>Hence the <em>reversed</em> SDE can be written as$$
 \boxed{
d\hat{X}<em>s
\;=\;
\Bigl[
f(\hat{X}_s,\,T-s)
\;-\;
\tfrac12\,g(T-s)^2\,\nabla \log p</em>{T-s}(\hat{X}_s)
\Bigr]\;ds
\;+\;
g(T-s)\,d\overline{W}_s.
}
$$
Often one writes the time variable in the same forward direction and just says
“the reverse‐time SDE from <span class="arithmatex">\(<span class="arithmatex">\(t\)</span>\)</span> down to 0 is</p>
<div class="arithmatex">\[
 dx \;=\;
\bigl[f(x,t)\;-\;g(t)^2\,\nabla_x \log p_{t}(x)\bigr]\;dt \;+\; g(t)\,d\overline{W}_t,
\]</div>
<p>”
where <span class="arithmatex">\(<span class="arithmatex">\(\overline{W}_t\)</span>\)</span> is a standard Wiener process <em>when viewed backward</em> in the original clock. In either notation, the key extra piece is <span class="arithmatex">\(<span class="arithmatex">\(\,-\,g^{2}\nabla\log p_{t}(\cdot)\)</span>\)</span>, which ensures the <em>distributions</em> truly run in reverse.</p>
<hr />
<h3 id="key-intuition">Key Intuition<a class="headerlink" href="#key-intuition" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p>The drift in the reverse process must “compensate” for how diffusion was spreading mass forward in time.</p>
</li>
<li>
<p>This compensation appears as <span class="arithmatex">\(<span class="arithmatex">\(\,-\,\tfrac12\,g^2 \nabla \log p_t(x)\)</span>\)</span>.</p>
</li>
<li>
<p>Equivalently, one can say that in the backward direction, the random walk “knows” how to concentrate probability back into regions from which it had been dispersing forward.
This completes the derivation (sometimes known as <em>Anderson’s theorem</em>).</p>
</li>
</ul>
<p>hought about Fokker-Planck equation for 4 秒<strong>Understanding the Fokker–Planck Equation: A Gentle Introduction</strong> In many physical, biological, and financial systems, we are often interested not only in the behavior of individual particles or agents but also in how <em>probability distributions</em> evolve over time. If you have ever encountered a situation where randomness (noise) and drift (directed motion) both play roles in the dynamics, you have likely brushed up against the <em>Fokker–Planck equation (FP equation)</em>.
In this blog, we will explore:</p>
<ol>
<li>
<p><strong>What the Fokker–Planck equation is.</strong></p>
</li>
<li>
<p><strong>When and why the probability density follows it.</strong></p>
</li>
<li>
<p><strong>An intuitive explanation to help you understand it deeply.</strong></p>
</li>
</ol>
<hr />
<h2 id="1-what-is-the-fokkerplanck-equation">1. What is the Fokker–Planck Equation?<a class="headerlink" href="#1-what-is-the-fokkerplanck-equation" title="Permanent link">&para;</a></h2>
<p>Put simply, the Fokker–Planck equation describes how the <em>probability density function</em> (PDF) of a stochastic (random) process evolves over time. More formally, if we let <span class="arithmatex">\(p(x,t)\)</span> be the probability density of finding the system in state <span class="arithmatex">\(x\)</span> at time <span class="arithmatex">\(t\)</span>, the Fokker–Planck equation reads:$$
 \frac{\partial p(x,t)}{\partial t} = -\frac{\partial}{\partial x}\big[\,\mu(x)\,p(x,t)\big]
+ \frac{1}{2}\,\frac{\partial^2}{\partial x^2}\big[\,D(x)\,p(x,t)\big],
$$</p>
<p>where</p>
<ul>
<li>
<p><span class="arithmatex">\(\mu(x)\)</span> represents the <em>drift</em> (systematic motion) of the process in state <span class="arithmatex">\(x\)</span>,</p>
</li>
<li>
<p><span class="arithmatex">\(D(x)\)</span> represents the <em>diffusion</em> (random fluctuations) at state <span class="arithmatex">\(x\)</span>.</p>
</li>
</ul>
<p>For simplicity, we often see the equation in the case of constant diffusion <span class="arithmatex">\(D\)</span> and constant drift <span class="arithmatex">\(v\)</span>:
$$
 \frac{\partial p(x,t)}{\partial t} = -v\,\frac{\partial p(x,t)}{\partial x} + \frac{D}{2}\,\frac{\partial^2 p(x,t)}{\partial x^2}.
$$</p>
<p>This partial differential equation tells us how the probability density changes because of both deterministic drift (<span class="arithmatex">\(v\)</span>) and random diffusion (<span class="arithmatex">\(D\)</span>).</p>
<hr />
<h2 id="2-when-does-the-probability-follow-the-fokkerplanck-equation">2. When Does the Probability Follow the Fokker–Planck Equation?<a class="headerlink" href="#2-when-does-the-probability-follow-the-fokkerplanck-equation" title="Permanent link">&para;</a></h2>
<p>The Fokker–Planck equation is typically valid under these conditions:</p>
<ol>
<li><strong>Continuous Markov processes in one dimension (or higher).</strong></li>
<li>
<p>The process must be <em>Markovian</em>: the future depends only on the present state, not on the history.</p>
</li>
<li>
<p><strong>Stochastic differential equations (SDEs) of the form</strong> $$
 dX_t = \mu(X_t)\,dt + \sqrt{D(X_t)}\,dW_t,
$$</p>
</li>
<li>
<p>where <span class="arithmatex">\(W_t\)</span> is a standard Brownian motion (Wiener process).</p>
</li>
<li>
<p><strong>Small, Gaussian-like noise.</strong></p>
</li>
<li>
<p>The derivation of the Fokker–Planck relies on the assumption that increments of noise are small over short intervals (leading to the second-order derivative term in the FP equation).</p>
</li>
<li>
<p><strong>No long-range jumps (no Lévy flights).</strong></p>
</li>
<li>If jumps or large discontinuous moves exist, then we would use <em>generalized</em> kinetic equations (like fractional Fokker–Planck or Master equations) rather than the classical FP equation.
In essence, if your system follows an Itô-type (or Stratonovich-type) SDE with drift <span class="arithmatex">\(\mu\)</span> and diffusion coefficient <span class="arithmatex">\(D\)</span>, then the <em>probability density</em> of where that system might be at time <span class="arithmatex">\(t\)</span> will satisfy the Fokker–Planck equation.</li>
</ol>
<hr />
<h2 id="3-an-intuitive-explanation">3. An Intuitive Explanation<a class="headerlink" href="#3-an-intuitive-explanation" title="Permanent link">&para;</a></h2>
<h3 id="a-drift-term-moving-the-probability-along">(a) Drift Term: Moving the Probability Along<a class="headerlink" href="#a-drift-term-moving-the-probability-along" title="Permanent link">&para;</a></h3>
<p>Imagine you have a pile of sand on a table. If you tilt the table slightly, the sand starts sliding in a certain direction (the <em>drift</em>). In probability terms, this systematic motion is captured by <span class="arithmatex">\(-\frac{\partial}{\partial x}[\mu(x) p(x,t)]\)</span>. It tells us that if there is some drift velocity <span class="arithmatex">\(\mu(x)\)</span>, it will <em>transport</em> the probability density along <span class="arithmatex">\(x\)</span>.
- <strong>In words</strong> : “If the drift at position <span class="arithmatex">\(x\)</span> is large, probability quickly flows away from <span class="arithmatex">\(x\)</span> to neighboring states.”</p>
<h3 id="b-diffusion-term-spreading-the-probability-out">(b) Diffusion Term: Spreading the Probability Out<a class="headerlink" href="#b-diffusion-term-spreading-the-probability-out" title="Permanent link">&para;</a></h3>
<p>Returning to the sand analogy: in addition to sliding, random vibrations (like small shakes) cause the sand to spread out. This spreading effect is the <em>diffusion</em> and is captured by the second term <span class="arithmatex">\(\frac{1}{2}\frac{\partial^2}{\partial x^2}[D(x) p(x,t)]\)</span>.
- <strong>In words</strong> : “If there is diffusion at position <span class="arithmatex">\(x\)</span>, it causes probability to spread out from regions of higher density to lower density nearby.”</p>
<h3 id="c-combining-drift-and-diffusion">(c) Combining Drift and Diffusion<a class="headerlink" href="#c-combining-drift-and-diffusion" title="Permanent link">&para;</a></h3>
<p>The Fokker–Planck equation brings these two effects together. First, it shifts the distribution in the direction of the drift, and second, it broadens (or contracts) the distribution due to diffusion. Over time, the competition or combination of these two dynamics shapes the overall probability distribution in your system.</p>
<hr />
<h2 id="4-why-is-the-fokkerplanck-equation-important">4. Why is the Fokker–Planck Equation Important?<a class="headerlink" href="#4-why-is-the-fokkerplanck-equation-important" title="Permanent link">&para;</a></h2>
<ul>
<li>
<p><strong>Physical systems</strong> : Think of particles in a fluid (like pollen particles in water—Brownian motion). The drift might come from fluid flow or external forces, while the diffusion comes from thermal fluctuations.</p>
</li>
<li>
<p><strong>Financial mathematics</strong> : Stock prices are often modeled as stochastic processes with drift and diffusion terms. The FP equation describes the time evolution of the probability density of stock prices.</p>
</li>
<li>
<p><strong>Neuroscience</strong> : Membrane potentials of neurons under random synaptic inputs sometimes follow a Fokker–Planck-like dynamics to describe the distribution of firing times.</p>
</li>
<li>
<p><strong>Population genetics</strong> : Allele frequency distributions in a population can be governed by drift (selection) and diffusion (random genetic drift).
Whenever you have a random variable subject to a systematic force (drift) plus random noise (diffusion), the Fokker–Planck is <em>the</em> PDE that details how that random variable’s distribution evolves.</p>
</li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tabs", "toc.integrate"], "search": "../../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.60a45f97.min.js"></script>
      
        <script src="../../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>
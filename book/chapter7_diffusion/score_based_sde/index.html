
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../from_ddpm_2_sde/">
      
      
        <link rel="next" href="../probability_flow_ode/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.15">
    
    
      
        <title>Score Based SDE - Generative AI: From Start to Surrender</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../stylesheets/extra.css">
    
      <link rel="stylesheet" href="https://unpkg.com/katex@0/dist/katex.min.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config",""),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
   <link href="../../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#score-based-sdes" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Generative AI: From Start to Surrender" class="md-header__button md-logo" aria-label="Generative AI: From Start to Surrender" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Generative AI: From Start to Surrender
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Score Based SDE
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1M8 13h8v-2H8zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4a5 5 0 0 0 5-5 5 5 0 0 0-5-5"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5M7 15a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../chapter1_Introduction/1.1terminology/" class="md-tabs__link">
          
  
  
    
  
  Introduction

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../chapter2_generation_theory/mle/" class="md-tabs__link">
          
  
  
    
  
  Generation Theory

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../chapter3_energy_based_model/introduction/" class="md-tabs__link">
          
  
  
    
  
  Energy Based Models

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../chapter6_VAE/vae_introduction/" class="md-tabs__link">
          
  
  
    
  
  VAE

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../chapter5_GAN/3.1from_gan_to_stylegan/paper/" class="md-tabs__link">
          
  
  
    
  
  GANs

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../ddpm/" class="md-tabs__link">
          
  
  
    
  
  Diffusion Models

        </a>
      </li>
    
  

    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../chapter9_flow_matching/introduction/" class="md-tabs__link">
          
  
  
    
  
  Flow Matching

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../chapter11_hybrid_sota_models/hybrid_methods/" class="md-tabs__link">
          
  
  
    
  
  Hybrid SOTA Models

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../chapter12_applications/diffusion_anomaly_detection/" class="md-tabs__link">
          
  
  
    
  
  Application

        </a>
      </li>
    
  

    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Generative AI: From Start to Surrender" class="md-nav__button md-logo" aria-label="Generative AI: From Start to Surrender" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Generative AI: From Start to Surrender
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Introduction
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter1_Introduction/1.1terminology/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Terms
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter1_Introduction/1.2fourier_transform/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Fourier Transform
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter1_Introduction/1.3signal_processing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Signal Processing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter1_Introduction/1.4statistics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Statistics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter1_Introduction/tutorials/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorials
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Generation Theory
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Generation Theory
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter2_generation_theory/mle/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Maximal Likelihood
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter2_generation_theory/manifold_hypothesis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Manifold Hypothesis
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter2_generation_theory/generative_model_category/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Generative Model Category
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Energy Based Models
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Energy Based Models
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter3_energy_based_model/introduction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter3_energy_based_model/score_function/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Score Functions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter3_energy_based_model/sampling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Sampling Methods
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter3_energy_based_model/cd/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Contrastive Divergence
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter3_energy_based_model/score_matching/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Score Matching
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    VAE
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            VAE
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter6_VAE/vae_introduction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter6_VAE/vq_vae/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    VA-VAE
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    GANs
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            GANs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter5_GAN/3.1from_gan_to_stylegan/paper/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    From GAN to StyleGAN
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6_2" >
        
          
          <label class="md-nav__link" for="__nav_6_2" id="__nav_6_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    StyleGAN Variants
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_2">
            <span class="md-nav__icon md-icon"></span>
            StyleGAN Variants
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter5_GAN/3.3stylegan/paper/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    StyleGAN
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter5_GAN/3.4stylegan2/paper/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    StyleGAN2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter5_GAN/3.5stylegan3/paper/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    StyleGAN3
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter5_GAN/3.6styleganT/paper/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    StyleGAN-T
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter5_GAN/3.7R3Gan/paper/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    R3GAN
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter5_GAN/vq_gan/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    VQ-GAN
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" checked>
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Diffusion Models
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Diffusion Models
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7_1" >
        
          
          <label class="md-nav__link" for="__nav_7_1" id="__nav_7_1_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Discrete Diffusion
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_1">
            <span class="md-nav__icon md-icon"></span>
            Discrete Diffusion
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ddpm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    DDPM
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ldm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    LDM
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ldm_handson/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    LDM Handson
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../diffusion_model_varients/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Diffusion Model Varients
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../general_diffusion_model/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    General Diffusion Model
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_2" checked>
        
          
          <label class="md-nav__link" for="__nav_7_2" id="__nav_7_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    SDE Diffusion
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_7_2">
            <span class="md-nav__icon md-icon"></span>
            SDE Diffusion
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../introduction_sde/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SDE Fundamentals
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../from_ddpm_2_sde/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SDE for DDPM
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Score Based SDE
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Score Based SDE
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-introduction" class="md-nav__link">
    <span class="md-ellipsis">
      1. Introduction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-forward-process-adding-noise" class="md-nav__link">
    <span class="md-ellipsis">
      2. Forward Process (Adding Noise)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-constructing-x_t-from-x_0" class="md-nav__link">
    <span class="md-ellipsis">
      3. Constructing \( x_t \) from \( x_0 \)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. Constructing \( x_t \) from \( x_0 \)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-vpsde-variance-preserving-sde" class="md-nav__link">
    <span class="md-ellipsis">
      3.1 VPSDE (Variance Preserving SDE)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-vesde-variance-exploding-sde" class="md-nav__link">
    <span class="md-ellipsis">
      3.2 VESDE (Variance Exploding SDE)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33-sub-vpsde" class="md-nav__link">
    <span class="md-ellipsis">
      3.3 Sub-VPSDE
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-conditional-score-function" class="md-nav__link">
    <span class="md-ellipsis">
      4. Conditional Score Function
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. Conditional Score Function">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-for-vpsde" class="md-nav__link">
    <span class="md-ellipsis">
      4.1 For VPSDE:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-for-vesde" class="md-nav__link">
    <span class="md-ellipsis">
      4.2 For VESDE:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#43-for-sub-vpsde" class="md-nav__link">
    <span class="md-ellipsis">
      4.3 For Sub-VPSDE:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-training-loss-score-matching" class="md-nav__link">
    <span class="md-ellipsis">
      5. Training Loss (Score Matching)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5. Training Loss (Score Matching)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#51-code-for-constructing-x_t-and-training" class="md-nav__link">
    <span class="md-ellipsis">
      5.1 Code for Constructing \( x_t \) and Training
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-reverse-sampling" class="md-nav__link">
    <span class="md-ellipsis">
      6. Reverse Sampling
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6. Reverse Sampling">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#61-sampling-code-euler-maruyama" class="md-nav__link">
    <span class="md-ellipsis">
      6.1 Sampling Code (Euler-Maruyama)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-score-function" class="md-nav__link">
    <span class="md-ellipsis">
      7. Score function
    </span>
  </a>
  
    <nav class="md-nav" aria-label="7. Score function">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#71-the-forward-sde-and-its-score-function" class="md-nav__link">
    <span class="md-ellipsis">
      7.1 The Forward SDE and Its Score Function
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#72-deriving-the-score-function-under-gaussian-transition-assumptions" class="md-nav__link">
    <span class="md-ellipsis">
      7.2 Deriving the Score Function under Gaussian Transition Assumptions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#73-conditions-for-gaussian-transition-probabilities-from-the-fokkerplanck-perspective" class="md-nav__link">
    <span class="md-ellipsis">
      7.3 Conditions for Gaussian Transition Probabilities from the Fokker–Planck Perspective
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#74-relationship-between-the-state-transition-matrix-psit-and-at" class="md-nav__link">
    <span class="md-ellipsis">
      7.4 Relationship Between the State Transition Matrix \(\Psi(t)\) and \(A(t)\)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#75-explicit-expression-for-the-conditional-score-function" class="md-nav__link">
    <span class="md-ellipsis">
      7.5 Explicit Expression for the Conditional Score Function
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#76-example-non-gaussian-transition-probability" class="md-nav__link">
    <span class="md-ellipsis">
      7.6 Example: Non-Gaussian Transition Probability
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#77-when-the-score-function-is-fracx-x_0sigma_t2" class="md-nav__link">
    <span class="md-ellipsis">
      7.7 When the score function is \(-\frac{x-x_0}{\sigma_t^2}\)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#78-summary" class="md-nav__link">
    <span class="md-ellipsis">
      7.8 Summary
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#79-conclusion" class="md-nav__link">
    <span class="md-ellipsis">
      7.9 Conclusion
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#8-extenstion-types-of-score-based-sde" class="md-nav__link">
    <span class="md-ellipsis">
      8. Extenstion Types of Score Based SDE
    </span>
  </a>
  
    <nav class="md-nav" aria-label="8. Extenstion Types of Score Based SDE">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#81-critically-damped-langevin-diffusion-cld-sde" class="md-nav__link">
    <span class="md-ellipsis">
      8.1 Critically Damped Langevin Diffusion (CLD-SDE)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#82-rectified-flow-sde" class="md-nav__link">
    <span class="md-ellipsis">
      8.2 Rectified Flow SDE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#83-continuous-time-normalizing-flows-ctnf-sde" class="md-nav__link">
    <span class="md-ellipsis">
      8.3 Continuous-Time Normalizing Flows (CTNF-SDE)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#84-training-data-construction" class="md-nav__link">
    <span class="md-ellipsis">
      8.4 Training Data Construction
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#85-score-based-sdes-with-adaptive-noise-an-sde" class="md-nav__link">
    <span class="md-ellipsis">
      8.5 Score-Based SDEs with Adaptive Noise (AN-SDE)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#86-key-features" class="md-nav__link">
    <span class="md-ellipsis">
      8.6 Key Features
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#9-fractional-brownian-motion-sde-fbm-sde" class="md-nav__link">
    <span class="md-ellipsis">
      9. Fractional Brownian Motion SDE (FBM-SDE)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="9. Fractional Brownian Motion SDE (FBM-SDE)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#91-key-features" class="md-nav__link">
    <span class="md-ellipsis">
      9.1 Key Features
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#10-hybrid-sde-ode-models" class="md-nav__link">
    <span class="md-ellipsis">
      10. Hybrid SDE-ODE Models
    </span>
  </a>
  
    <nav class="md-nav" aria-label="10. Hybrid SDE-ODE Models">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#101-key-features" class="md-nav__link">
    <span class="md-ellipsis">
      10.1 Key Features
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#11-summary-of-score-based-sdes" class="md-nav__link">
    <span class="md-ellipsis">
      11. Summary of Score-Based SDEs
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#12-conclusion" class="md-nav__link">
    <span class="md-ellipsis">
      12. Conclusion
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../probability_flow_ode/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Probability Flow ODE
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sde_diffusion_speedup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SDE Diffusion Speedup
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sde_diffusion_unified_representation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Scaling and Scheduling
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7_3" >
        
          
          <label class="md-nav__link" for="__nav_7_3" id="__nav_7_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Diffusion Network
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_3">
            <span class="md-nav__icon md-icon"></span>
            Diffusion Network
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../DiT/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    DiT
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7_4" >
        
          
          <label class="md-nav__link" for="__nav_7_4" id="__nav_7_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Diffusion Solver
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_4">
            <span class="md-nav__icon md-icon"></span>
            Diffusion Solver
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../diffusion_solver/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    DPM Solver
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7_5" >
        
          
          <label class="md-nav__link" for="__nav_7_5" id="__nav_7_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Conditional Diffusion
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_5">
            <span class="md-nav__icon md-icon"></span>
            Conditional Diffusion
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../controlnet/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ControlNet
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sde_diffusion_guidance/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SDE Diffusion Guidance
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Flow Matching
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Flow Matching
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter9_flow_matching/introduction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter9_flow_matching/probability_with_velocity_field/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Probability Path and Velocity Fields
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter9_flow_matching/flow_matching_theory/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Flow Matching Theorem
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter9_flow_matching/affine_conditional_flows/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Affine Conditional Flow
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter9_flow_matching/optimal_transport_flow/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Optimal Transport Flow
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter9_flow_matching/comparison_with_flow_ode/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Comparison with Diffusion Flow ODE
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Hybrid SOTA Models
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            Hybrid SOTA Models
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter11_hybrid_sota_models/hybrid_methods/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Hybrid Methods
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter11_hybrid_sota_models/sota_closed_models/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Closed Models
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_9_3" >
        
          
          <label class="md-nav__link" for="__nav_9_3" id="__nav_9_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Open Models
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_9_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_3">
            <span class="md-nav__icon md-icon"></span>
            Open Models
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter11_hybrid_sota_models/sota_open_models/dalle_series/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Dalle Series
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_9_3_2" >
        
          
          <label class="md-nav__link" for="__nav_9_3_2" id="__nav_9_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Stable Diffusion Series
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_9_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_3_2">
            <span class="md-nav__icon md-icon"></span>
            Stable Diffusion Series
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter11_hybrid_sota_models/sota_open_models/stable_diffusion_series/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter11_hybrid_sota_models/sota_open_models/stable_diffusion_xl/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Stable Diffusion XL
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter11_hybrid_sota_models/sota_open_models/stable_diffusion_3_reading/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Stable Diffusion 3
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter11_hybrid_sota_models/sota_open_models/stable_diffusion_3_5_reading/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Stable Diffusion 3.5
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_9_3_3" >
        
          
          <label class="md-nav__link" for="__nav_9_3_3" id="__nav_9_3_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Flux
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_9_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_3_3">
            <span class="md-nav__icon md-icon"></span>
            Flux
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter11_hybrid_sota_models/sota_open_models/flux1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Flux.1
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter11_hybrid_sota_models/sota_open_models/flux.1_kontext/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Flux.1 Kontext
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter11_hybrid_sota_models/trends_future/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Future Trends
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_10" >
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Application
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            Application
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_10_1" >
        
          
          <label class="md-nav__link" for="__nav_10_1" id="__nav_10_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Anomaly Detection
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_1">
            <span class="md-nav__icon md-icon"></span>
            Anomaly Detection
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter12_applications/diffusion_anomaly_detection/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Diffusion Anomaly Detection
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_10_2" >
        
          
          <label class="md-nav__link" for="__nav_10_2" id="__nav_10_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Deepfake Detection
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_2">
            <span class="md-nav__icon md-icon"></span>
            Deepfake Detection
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter12_applications/deepfake_detection_structured/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    总览
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter12_applications/deepfake_detection/FOCAL/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    FOCAL
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter12_applications/deepfake_detection/PSCC-Net/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PSCC-Net
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter12_applications/deepfake_detection/DeCLIP/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    DeCLIP
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter12_applications/deepfake_detection/FakeLocator/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    FakeLocator
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter12_applications/deepfake_detection/Weakly-supervised-Deepfake-Localization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Weakly-supervised Deepfake Localization
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter12_applications/deepfake_detection/FSBI/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    FSBI
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter12_applications/deepfake_detection/DE-FAKE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    DE-FAKE
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter12_applications/deepfake_detection/DADF/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    DADF
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter12_applications/deepfake_detection/SIDA/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SIDA
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter12_applications/deepfake_detection/UnivCLIP/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    UnivCLIP
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter12_applications/deepfake_detection/Multi-Attention-Based-Approach/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Multi-Attention-Based-Approach
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter12_applications/deepfake_detection/Mastering-Deepfake-Detection/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Mastering-Deepfake-Detection
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter12_applications/deepfake_detection/Leveraging-Frequency-Analysis-for-Deep-Fake-Image-Recognition/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Leveraging-Frequency-Analysis-for-Deep-Fake-Image-Recognition
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter12_applications/deepfake_detection/An-Analysis-of-Recent-Advances-in-Deepfake-Image-Detection-in-an-Evolving-Threat-Landscape/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    An-Analysis-of-Recent-Advances-in-Deepfake-Image-Detection-in-an-Evolving-Threat-Landscape
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="score-based-sdes">Score-Based SDEs<a class="headerlink" href="#score-based-sdes" title="Permanent link">&para;</a></h1>
<h2 id="1-introduction">1. <strong>Introduction</strong><a class="headerlink" href="#1-introduction" title="Permanent link">&para;</a></h2>
<p>Score-based Stochastic Differential Equations (SDEs) provide a <strong>continuous-time framework</strong> for diffusion models. They define a <strong>forward diffusion process</strong> (adding noise) and a <strong>reverse process</strong> (denoising) using <strong>score functions</strong>.</p>
<p>In this guide, we will:</p>
<ul>
<li>Explain different <strong>SDE designs</strong> including <strong>VPSDE, VESDE, and Sub-VPSDE</strong>.</li>
<li>Show <strong>how to construct <span class="arithmatex">\( x_t \)</span> given <span class="arithmatex">\( x_0 \)</span></strong>.</li>
<li>Derive <strong>conditional SDE score functions</strong>.</li>
<li>Implement <strong>training, reverse sampling, and probability flow ODE sampling</strong>.</li>
</ul>
<hr />
<h2 id="2-forward-process-adding-noise">2. <strong>Forward Process (Adding Noise)</strong><a class="headerlink" href="#2-forward-process-adding-noise" title="Permanent link">&para;</a></h2>
<p>In <strong>Score-based SDEs</strong>, the forward process <strong>gradually adds noise</strong> to data:</p>
<div class="arithmatex">\[
dx = f(x, t) dt + g(t) dw
\]</div>
<p>where:</p>
<ul>
<li><span class="arithmatex">\( f(x, t) \)</span> is the <strong>drift term</strong> (controls decay).</li>
<li><span class="arithmatex">\( g(t) \)</span> is the <strong>diffusion term</strong> (controls noise strength).</li>
<li><span class="arithmatex">\( dw \)</span> is the <strong>Wiener process</strong> (random noise).</li>
</ul>
<p>At time <span class="arithmatex">\( t \)</span>, the noisy version of <span class="arithmatex">\( x_0 \)</span> is denoted as <strong><span class="arithmatex">\( x_t \)</span></strong>.</p>
<hr />
<h2 id="3-constructing-x_t-from-x_0">3. <strong>Constructing <span class="arithmatex">\( x_t \)</span> from <span class="arithmatex">\( x_0 \)</span></strong><a class="headerlink" href="#3-constructing-x_t-from-x_0" title="Permanent link">&para;</a></h2>
<p>For any SDE, we can write the transition distribution <span class="arithmatex">\( p_t(x_t | x_0) \)</span> as:</p>
<div class="arithmatex">\[
p_t(x_t | x_0) = \mathcal{N}(\mu_t(x_0), \Sigma_t)
\]</div>
<p>where:</p>
<ul>
<li><strong><span class="arithmatex">\( \mu_t(x_0) \)</span></strong> is the mean (drifted input).</li>
<li><strong><span class="arithmatex">\( \Sigma_t \)</span></strong> is the variance (accumulated noise).</li>
</ul>
<h3 id="31-vpsde-variance-preserving-sde">3.1 <strong>VPSDE (Variance Preserving SDE)</strong><a class="headerlink" href="#31-vpsde-variance-preserving-sde" title="Permanent link">&para;</a></h3>
<div class="arithmatex">\[
dx = -\frac{1}{2} \beta(t) x dt + \sqrt{\beta(t)} dw
\]</div>
<p>Solution:</p>
<div class="arithmatex">\[
x_t = x_0 e^{-\frac{1}{2} \int_0^t \beta(s) ds} + \sqrt{1 - e^{-\int_0^t \beta(s) ds}} \epsilon, \quad \epsilon \sim \mathcal{N}(0, I)
\]</div>
<h3 id="32-vesde-variance-exploding-sde">3.2 <strong>VESDE (Variance Exploding SDE)</strong><a class="headerlink" href="#32-vesde-variance-exploding-sde" title="Permanent link">&para;</a></h3>
<div class="arithmatex">\[
dx = \sigma(t) dw
\]</div>
<p>Solution:</p>
<div class="arithmatex">\[
x_t = x_0 + \sqrt{\int_0^t \sigma^2(s) ds} \epsilon, \quad \epsilon \sim \mathcal{N}(0, I)
\]</div>
<h3 id="33-sub-vpsde">3.3 <strong>Sub-VPSDE</strong><a class="headerlink" href="#33-sub-vpsde" title="Permanent link">&para;</a></h3>
<p>Sub-VPSDE is a modification of VPSDE that <strong>controls the noise level more finely</strong>:</p>
<div class="arithmatex">\[
dx = -\frac{1}{2} \beta(t) x dt + \sqrt{\beta(t) (1 - e^{-2 \int_0^t \beta(s) ds})} dw
\]</div>
<p>Solution:</p>
<div class="arithmatex">\[
x_t = x_0 e^{-\frac{1}{2} \int_0^t \beta(s) ds} + \sqrt{(1 - e^{-\int_0^t \beta(s) ds})} \epsilon, \quad \epsilon \sim \mathcal{N}(0, I)
\]</div>
<ul>
<li><strong>This keeps the noise level lower than VPSDE, helping preserve some structure in the data.</strong></li>
</ul>
<hr />
<h2 id="4-conditional-score-function">4. <strong>Conditional Score Function</strong><a class="headerlink" href="#4-conditional-score-function" title="Permanent link">&para;</a></h2>
<p>The <strong>score function</strong> is:</p>
<div class="arithmatex">\[
\nabla_x \log p_t(x_t | x_0) = -\Sigma_t^{-1} (x_t - \mu_t(x_0))
\]</div>
<h3 id="41-for-vpsde">4.1 <strong>For VPSDE:</strong><a class="headerlink" href="#41-for-vpsde" title="Permanent link">&para;</a></h3>
<div class="arithmatex">\[
\nabla_x \log p_t(x_t | x_0) = -\frac{x_t - x_0 e^{-\frac{1}{2} \int_0^t \beta(s) ds}}{(1 - e^{-\int_0^t \beta(s) ds})}
\]</div>
<h3 id="42-for-vesde">4.2 <strong>For VESDE:</strong><a class="headerlink" href="#42-for-vesde" title="Permanent link">&para;</a></h3>
<div class="arithmatex">\[
\nabla_x \log p_t(x_t | x_0) = -\frac{x_t - x_0}{\int_0^t \sigma^2(s) ds}
\]</div>
<h3 id="43-for-sub-vpsde">4.3 <strong>For Sub-VPSDE:</strong><a class="headerlink" href="#43-for-sub-vpsde" title="Permanent link">&para;</a></h3>
<div class="arithmatex">\[
\nabla_x \log p_t(x_t | x_0) = -\frac{x_t - x_0 e^{-\frac{1}{2} \int_0^t \beta(s) ds}}{(1 - e^{-\int_0^t \beta(s) ds})}
\]</div>
<ul>
<li>The score function is similar to VPSDE but adapted to Sub-VPSDE's noise control.</li>
</ul>
<hr />
<h2 id="5-training-loss-score-matching">5. <strong>Training Loss (Score Matching)</strong><a class="headerlink" href="#5-training-loss-score-matching" title="Permanent link">&para;</a></h2>
<p>We train a <strong>score network</strong> <span class="arithmatex">\( s_\theta(x, t) \)</span> to approximate the <strong>true score function</strong>:</p>
<div class="arithmatex">\[
s_\theta(x, t) \approx \nabla_x \log p_t(x)
\]</div>
<p>The training loss is:</p>
<div class="arithmatex">\[
\mathcal{L}(\theta) = \mathbb{E}_{t, x_0, \epsilon} \left[ \lambda(t) \| s_\theta(x_t, t) - \nabla_x \log p_t(x_t | x_0) \|^2 \right]
\]</div>
<p>where <span class="arithmatex">\( \lambda(t) \)</span> is a weighting function.</p>
<h3 id="51-code-for-constructing-x_t-and-training">5.1 <strong>Code for Constructing <span class="arithmatex">\( x_t \)</span> and Training</strong><a class="headerlink" href="#51-code-for-constructing-x_t-and-training" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-0-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-0-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-0-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-0-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-0-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-0-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-0-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-0-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-0-10">10</a></span>
<span class="normal"><a href="#__codelineno-0-11">11</a></span>
<span class="normal"><a href="#__codelineno-0-12">12</a></span>
<span class="normal"><a href="#__codelineno-0-13">13</a></span>
<span class="normal"><a href="#__codelineno-0-14">14</a></span>
<span class="normal"><a href="#__codelineno-0-15">15</a></span>
<span class="normal"><a href="#__codelineno-0-16">16</a></span>
<span class="normal"><a href="#__codelineno-0-17">17</a></span>
<span class="normal"><a href="#__codelineno-0-18">18</a></span>
<span class="normal"><a href="#__codelineno-0-19">19</a></span>
<span class="normal"><a href="#__codelineno-0-20">20</a></span>
<span class="normal"><a href="#__codelineno-0-21">21</a></span>
<span class="normal"><a href="#__codelineno-0-22">22</a></span>
<span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">torch.nn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nn</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">torch.optim</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">optim</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="c1"># Define the score network</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="k">class</span><span class="w"> </span><span class="nc">ScoreNetwork</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_dim</span><span class="p">):</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">net</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a>            <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">input_dim</span><span class="p">,</span> <span class="mi">128</span><span class="p">),</span> <span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">(),</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a>            <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="mi">128</span><span class="p">),</span> <span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">(),</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a>            <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="n">input_dim</span><span class="p">)</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a>        <span class="p">)</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">net</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="c1"># Construct x_t for Sub-VPSDE</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="k">def</span><span class="w"> </span><span class="nf">sample_xt_sub_vpsde</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>    <span class="n">beta_int</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">beta_t</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>    <span class="n">noise</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn_like</span><span class="p">(</span><span class="n">x0</span><span class="p">)</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>    <span class="k">return</span> <span class="n">beta_int</span> <span class="o">*</span> <span class="n">x0</span> <span class="o">+</span> <span class="n">torch</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="mi">1</span> <span class="o">-</span> <span class="n">beta_int</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="o">*</span> <span class="n">noise</span><span class="p">,</span> <span class="n">noise</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="c1"># Define loss function</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="k">def</span><span class="w"> </span><span class="nf">score_matching_loss</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">x0</span><span class="p">):</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>    <span class="n">t</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">((</span><span class="n">x0</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">))</span>  <span class="c1"># Random time</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a>    <span class="n">xt</span><span class="p">,</span> <span class="n">noise</span> <span class="o">=</span> <span class="n">sample_xt_sub_vpsde</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>    <span class="n">score</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">xt</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a>    <span class="k">return</span> <span class="p">((</span><span class="n">score</span> <span class="o">+</span> <span class="n">noise</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="c1"># Training loop</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="n">model</span> <span class="o">=</span> <span class="n">ScoreNetwork</span><span class="p">(</span><span class="n">input_dim</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="n">optimizer</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">)</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10000</span><span class="p">):</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>    <span class="n">x0</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">((</span><span class="mi">128</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>  <span class="c1"># Sample data</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>    <span class="n">loss</span> <span class="o">=</span> <span class="n">score_matching_loss</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">x0</span><span class="p">)</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>    <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>    <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>    <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>    <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="mi">1000</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Step </span><span class="si">{</span><span class="n">step</span><span class="si">}</span><span class="s2">, Loss: </span><span class="si">{</span><span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<hr />
<h2 id="6-reverse-sampling">6. <strong>Reverse Sampling</strong><a class="headerlink" href="#6-reverse-sampling" title="Permanent link">&para;</a></h2>
<p>Once trained, we use <strong>reverse SDE</strong>:</p>
<div class="arithmatex">\[
dx = \left[f(x, t) - g(t)^2 s_\theta(x, t) \right] dt + g(t) d\bar{w}
\]</div>
<h3 id="61-sampling-code-euler-maruyama">6.1 <strong>Sampling Code (Euler-Maruyama)</strong><a class="headerlink" href="#61-sampling-code-euler-maruyama" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-1-1">1</a></span>
<span class="normal"><a href="#__codelineno-1-2">2</a></span>
<span class="normal"><a href="#__codelineno-1-3">3</a></span>
<span class="normal"><a href="#__codelineno-1-4">4</a></span>
<span class="normal"><a href="#__codelineno-1-5">5</a></span>
<span class="normal"><a href="#__codelineno-1-6">6</a></span>
<span class="normal"><a href="#__codelineno-1-7">7</a></span>
<span class="normal"><a href="#__codelineno-1-8">8</a></span>
<span class="normal"><a href="#__codelineno-1-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">reverse_sde</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">xT</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
<a id="__codelineno-1-2" name="__codelineno-1-2"></a>    <span class="n">dt</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">steps</span>
<a id="__codelineno-1-3" name="__codelineno-1-3"></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">xT</span>
<a id="__codelineno-1-4" name="__codelineno-1-4"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">steps</span><span class="p">):</span>
<a id="__codelineno-1-5" name="__codelineno-1-5"></a>        <span class="n">t</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">x</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">i</span> <span class="o">/</span> <span class="n">steps</span><span class="p">)</span>
<a id="__codelineno-1-6" name="__codelineno-1-6"></a>        <span class="n">drift</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">beta_t</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">x</span> <span class="o">-</span> <span class="n">beta_t</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">model</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<a id="__codelineno-1-7" name="__codelineno-1-7"></a>        <span class="n">diffusion</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">beta_t</span><span class="p">(</span><span class="n">t</span><span class="p">))</span> <span class="o">*</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn_like</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-1-8" name="__codelineno-1-8"></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">drift</span> <span class="o">*</span> <span class="n">dt</span> <span class="o">+</span> <span class="n">diffusion</span> <span class="o">*</span> <span class="n">torch</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="o">-</span><span class="n">dt</span><span class="p">)</span>
<a id="__codelineno-1-9" name="__codelineno-1-9"></a>    <span class="k">return</span> <span class="n">x</span>
</code></pre></div></td></tr></table></div>
<h2 id="7-score-function">7. Score function<a class="headerlink" href="#7-score-function" title="Permanent link">&para;</a></h2>
<blockquote>
<p>Understanding Score Functions and Gaussian Transition Probabilities in Score-Based SDE Models</p>
</blockquote>
<h3 id="71-the-forward-sde-and-its-score-function">7.1 The Forward SDE and Its Score Function<a class="headerlink" href="#71-the-forward-sde-and-its-score-function" title="Permanent link">&para;</a></h3>
<p>A generalized SDE is often written as:</p>
<div class="arithmatex">\[
dx = f(x,t)\,dt + g(x,t)\,dw,
\]</div>
<p>where <span class="arithmatex">\(w\)</span> is a standard Brownian motion and <span class="arithmatex">\(p_t(x)\)</span> is the marginal density at time <span class="arithmatex">\(t\)</span>. The score function is defined as the gradient of the log probability density:</p>
<div class="arithmatex">\[
s(x,t) = \nabla_x \log p_t(x) = \frac{\nabla_x p_t(x)}{p_t(x)}.
\]</div>
<p>In practice, a neural network <span class="arithmatex">\(s_\theta(x,t)\)</span> approximates this score function to guide the reverse diffusion process in generative models.</p>
<h3 id="72-deriving-the-score-function-under-gaussian-transition-assumptions">7.2 Deriving the Score Function under Gaussian Transition Assumptions<a class="headerlink" href="#72-deriving-the-score-function-under-gaussian-transition-assumptions" title="Permanent link">&para;</a></h3>
<p>Assume that the transition probability from an initial state <span class="arithmatex">\(x_0\)</span> to <span class="arithmatex">\(x\)</span> at time <span class="arithmatex">\(t\)</span> is Gaussian:</p>
<div class="arithmatex">\[
p_{t|0}(x \mid x_0) = \frac{1}{\sqrt{2\pi\,\sigma_t^2}} \exp\left(-\frac{\left(x - m(x_0,t)\right)^2}{2\sigma_t^2}\right).
\]</div>
<p>Given an initial density <span class="arithmatex">\(p_0(x_0)\)</span>, the marginal density is</p>
<div class="arithmatex">\[
p_t(x) = \int p_{t|0}(x \mid x_0) \, p_0(x_0) \, dx_0.
\]</div>
<h4 id="721-marginal-score-function">7.2.1 Marginal Score Function<a class="headerlink" href="#721-marginal-score-function" title="Permanent link">&para;</a></h4>
<p>Differentiating <span class="arithmatex">\(p_t(x)\)</span> with respect to <span class="arithmatex">\(x\)</span> and using properties of the Gaussian yields</p>
<div class="arithmatex">\[
\nabla_x p_t(x) = -\frac{1}{\sigma_t^2}\int \bigl(x - m(x_0,t)\bigr)\, p_{t|0}(x \mid x_0)\, p_0(x_0) \, dx_0.
\]</div>
<p>Recognizing the conditional expectation</p>
<div class="arithmatex">\[
\mathbb{E}[m(x_0,t) \mid x] = \frac{\int m(x_0,t) \, p_{t|0}(x \mid x_0)\, p_0(x_0) \, dx_0}{p_t(x)},
\]</div>
<p>the <strong>marginal score function</strong> becomes</p>
<div class="arithmatex">\[
s(x,t) = \nabla_x \log p_t(x) = -\frac{x - \mathbb{E}[m(x_0,t) \mid x]}{\sigma_t^2}.
\]</div>
<p>A notable special case is when <span class="arithmatex">\(m(x_0,t) = x_0\)</span>, which leads to the well-known Tweedie's formula:</p>
<div class="arithmatex">\[
s(x,t) = -\frac{x - \mathbb{E}[x_0 \mid x]}{\sigma_t^2}.
\]</div>
<h4 id="722-conditional-score-function">7.2.2 Conditional Score Function<a class="headerlink" href="#722-conditional-score-function" title="Permanent link">&para;</a></h4>
<p>In many scenarios, it is useful to consider the score function for the <strong>conditional probability</strong> <span class="arithmatex">\(p_{t|0}(x \mid x_0)\)</span> directly. We define the <strong>conditional score function</strong> as:</p>
<div class="arithmatex">\[
s(x,t\mid x_0) = \nabla_x \log p_{t|0}(x \mid x_0).
\]</div>
<p>Since the conditional density is Gaussian,</p>
<div class="arithmatex">\[
p_{t|0}(x \mid x_0) = \frac{1}{\sqrt{2\pi\,\sigma_t^2}} \exp\left(-\frac{\left(x - m(x_0,t)\right)^2}{2\sigma_t^2}\right),
\]</div>
<p>its log-density is</p>
<div class="arithmatex">\[
\log p_{t|0}(x \mid x_0) = -\frac{1}{2}\log(2\pi\,\sigma_t^2) - \frac{\left(x - m(x_0,t)\right)^2}{2\sigma_t^2}.
\]</div>
<p>Taking the gradient with respect to <span class="arithmatex">\(x\)</span> yields</p>
<div class="arithmatex">\[
s(x,t\mid x_0) = \nabla_x \log p_{t|0}(x \mid x_0) = -\frac{x - m(x_0,t)}{\sigma_t^2}.
\]</div>
<p>This expression explicitly quantifies how the log-probability of <span class="arithmatex">\(x\)</span> given <span class="arithmatex">\(x_0\)</span> changes with <span class="arithmatex">\(x\)</span> under the Gaussian assumption.</p>
<hr />
<h3 id="73-conditions-for-gaussian-transition-probabilities-from-the-fokkerplanck-perspective">7.3 Conditions for Gaussian Transition Probabilities from the Fokker–Planck Perspective<a class="headerlink" href="#73-conditions-for-gaussian-transition-probabilities-from-the-fokkerplanck-perspective" title="Permanent link">&para;</a></h3>
<p>The evolution of the probability density <span class="arithmatex">\(p(x,t)\)</span> is governed by the Fokker–Planck equation:</p>
<div class="arithmatex">\[
\frac{\partial p(x,t)}{\partial t} = -\frac{\partial}{\partial x}\Bigl(f(x,t)\,p(x,t)\Bigr) + \frac{1}{2}\frac{\partial^2}{\partial x^2}\Bigl(g(x,t)^2\,p(x,t)\Bigr).
\]</div>
<p>For the Gaussian form of <span class="arithmatex">\(p(x,t)\)</span> to be preserved over time, the following conditions are necessary:</p>
<ol>
<li><strong>Linear (or Affine) Drift:</strong>
   The drift function must be linear in <span class="arithmatex">\(x\)</span>:</li>
</ol>
<p>$$
   f(x,t) = A(t)x + b(t),
   $$</p>
<p>where <span class="arithmatex">\(A(t)\)</span> is a matrix (or scalar) and <span class="arithmatex">\(b(t)\)</span> is a bias term. This ensures that applying the drift to a Gaussian density results in another Gaussian (or an affine-transformed Gaussian).</p>
<ol>
<li><strong>State-Independent Diffusion:</strong>
   The diffusion function must be independent of <span class="arithmatex">\(x\)</span>:</li>
</ol>
<p>$$
   g(x,t) = g(t).
   $$</p>
<p>When the noise is additive (i.e., <span class="arithmatex">\(g(x,t)\)</span> does not depend on <span class="arithmatex">\(x\)</span>), the diffusion term in the Fokker–Planck equation preserves the quadratic form in <span class="arithmatex">\(x\)</span> and, therefore, the Gaussian shape of the density.</p>
<p>For example, the Ornstein–Uhlenbeck process</p>
<div class="arithmatex">\[
dx = -\lambda x\,dt + \sigma\,dw,
\]</div>
<p>satisfies these conditions, resulting in a Gaussian transition probability.</p>
<h3 id="74-relationship-between-the-state-transition-matrix-psit-and-at">7.4 Relationship Between the State Transition Matrix <span class="arithmatex">\(\Psi(t)\)</span> and <span class="arithmatex">\(A(t)\)</span><a class="headerlink" href="#74-relationship-between-the-state-transition-matrix-psit-and-at" title="Permanent link">&para;</a></h3>
<p>For linear systems, the state transition matrix <span class="arithmatex">\(\Psi(t)\)</span> (often denoted as <span class="arithmatex">\(\Phi(t)\)</span> in some literature) is defined as the solution to the differential equation</p>
<div class="arithmatex">\[
\frac{d}{dt}\Psi(t) = A(t)\,\Psi(t), \quad \Psi(0)=I,
\]</div>
<p>where <span class="arithmatex">\(I\)</span> is the identity matrix. This matrix propagates the initial state <span class="arithmatex">\(x_0\)</span> to the state at time <span class="arithmatex">\(t\)</span> through the relation:</p>
<div class="arithmatex">\[
x(t) = \Psi(t)x_0 + \int_0^t \Psi(t,s)\,b(s)\,ds + \int_0^t \Psi(t,s)\,g(s)\,dw(s).
\]</div>
<h4 id="741-closed-forms-expression-for-psit">7.4.1 Closed-Forms Expression for <span class="arithmatex">\(\Psi(t)\)</span><a class="headerlink" href="#741-closed-forms-expression-for-psit" title="Permanent link">&para;</a></h4>
<p>Since the ODE for <span class="arithmatex">\(\Psi(t)\)</span> is linear, it is often possible to obtain a closed-form expression for <span class="arithmatex">\(\Psi(t)\)</span> under certain conditions. For example, if <span class="arithmatex">\(A(t)\)</span> is time-invariant, i.e., <span class="arithmatex">\(A(t) = A\)</span> for all <span class="arithmatex">\(t\)</span>, then the solution is given by the matrix exponential:</p>
<div class="arithmatex">\[
\Psi(t) = e^{At}.
\]</div>
<p>Even if <span class="arithmatex">\(A(t)\)</span> is time-dependent, if it commutes with itself at different times (i.e., <span class="arithmatex">\([A(t_1), A(t_2)] = 0\)</span> for all <span class="arithmatex">\(t_1, t_2\)</span>), the closed-form solution can be written as:</p>
<div class="arithmatex">\[
\Psi(t) = \exp\left(\int_0^t A(s)\,ds\right).
\]</div>
<p>In cases where <span class="arithmatex">\(A(t)\)</span> does not commute at different times, the closed-form expression might not be available, and one must resort to numerical integration or approximation methods.</p>
<hr />
<h3 id="75-explicit-expression-for-the-conditional-score-function">7.5 Explicit Expression for the Conditional Score Function<a class="headerlink" href="#75-explicit-expression-for-the-conditional-score-function" title="Permanent link">&para;</a></h3>
<p>Under the assumptions that the drift is linear and the diffusion is state-independent, the SDE becomes</p>
<div class="arithmatex">\[
dx = \bigl(A(t)x + b(t)\bigr)dt + g(t)\,dw.
\]</div>
<p>Its solution can be written as:</p>
<div class="arithmatex">\[
x(t) = \Psi(t)x_0 + \mu(t) + \int_0^t \Psi(t,s) g(s)\, dw(s),
\]</div>
<p>where:</p>
<ul>
<li><span class="arithmatex">\(\Psi(t)\)</span> is the state transition matrix defined above,</li>
<li><span class="arithmatex">\(\mu(t) = \int_0^t \Psi(t,s)\,b(s)\, ds\)</span>,</li>
<li>The noise integral is Gaussian with covariance</li>
</ul>
<div class="arithmatex">\[
\Sigma(t) = \int_0^t \Psi(t,s)\,g(s)^2\,\Psi(t,s)^\top ds.
\]</div>
<p>Thus, the conditional (or transition) probability is given by</p>
<div class="arithmatex">\[
p_{t|0}(x \mid x_0) = \mathcal{N}\Bigl(x; \Psi(t)x_0 + \mu(t),\, \Sigma(t)\Bigr).
\]</div>
<p>Assuming the initial distribution <span class="arithmatex">\(p_0(x_0)\)</span> is also Gaussian, the marginal distribution <span class="arithmatex">\(p_t(x)\)</span> remains Gaussian:</p>
<div class="arithmatex">\[
p_t(x) = \mathcal{N}\Bigl(x; m(t),\, \Sigma(t)\Bigr),
\]</div>
<p>with mean</p>
<div class="arithmatex">\[
m(t) = \Psi(t)m_0 + \mu(t),
\]</div>
<p>where <span class="arithmatex">\(m_0\)</span> is the mean of <span class="arithmatex">\(p_0(x_0)\)</span>.</p>
<p>The <strong>marginal score function</strong> is computed as the gradient of the log density of a Gaussian:</p>
<div class="arithmatex">\[
s(x,t) = \nabla_x \log p_t(x) = -\Sigma(t)^{-1}\bigl(x - m(t)\bigr).
\]</div>
<p>Recall that the <strong>conditional score function</strong> for <span class="arithmatex">\(p_{t|0}(x \mid x_0)\)</span> is</p>
<div class="arithmatex">\[
s(x,t\mid x_0) = \nabla_x \log p_{t|0}(x \mid x_0).
\]</div>
<p>Given the Gaussian form of <span class="arithmatex">\(p_{t|0}(x \mid x_0)\)</span>, we obtain</p>
<div class="arithmatex">\[
s(x,t\mid x_0) = -\frac{x - (\Psi(t)x_0 + \mu(t))}{\sigma_t^2},
\]</div>
<p>where, in this context, <span class="arithmatex">\(\sigma_t^2\)</span> relates to the covariance <span class="arithmatex">\(\Sigma(t)\)</span> (or is a scalar if the state is one-dimensional). This expression quantifies how the log-probability of <span class="arithmatex">\(x\)</span> given <span class="arithmatex">\(x_0\)</span> changes with <span class="arithmatex">\(x\)</span> under the Gaussian assumption.</p>
<hr />
<h3 id="76-example-non-gaussian-transition-probability">7.6 Example: Non-Gaussian Transition Probability<a class="headerlink" href="#76-example-non-gaussian-transition-probability" title="Permanent link">&para;</a></h3>
<p>When the conditions for Gaussian transitions are not met, the SDE may yield a non-Gaussian transition probability. A classic example is <strong>geometric Brownian motion</strong>, where the SDE is given by</p>
<div class="arithmatex">\[
dx = \mu x\,dt + \sigma x\,dw.
\]</div>
<p>Here, both the drift <span class="arithmatex">\(f(x,t) = \mu x\)</span> and the diffusion <span class="arithmatex">\(g(x,t)=\sigma x\)</span> depend linearly on <span class="arithmatex">\(x\)</span>. Although the drift is linear, the diffusion is state-dependent (multiplicative noise). The solution to this SDE is</p>
<div class="arithmatex">\[
x(t)= x_0\,\exp\Bigl\{\left(\mu - \frac{1}{2}\sigma^2\right)t + \sigma w_t\Bigr\},
\]</div>
<p>and the resulting distribution of <span class="arithmatex">\(x(t)\)</span> is <strong>log-normal</strong>, not Gaussian. This deviation occurs because the multiplicative nature of the noise distorts the Gaussian structure through a nonlinear transformation, resulting in a distribution with asymmetry (skewness) and a long tail.</p>
<h3 id="77-when-the-score-function-is-fracx-x_0sigma_t2">7.7 When the score function is <span class="arithmatex">\(-\frac{x-x_0}{\sigma_t^2}\)</span><a class="headerlink" href="#77-when-the-score-function-is-fracx-x_0sigma_t2" title="Permanent link">&para;</a></h3>
<p>When we say that the conditional mean is preserved, we mean that for a sample starting at <span class="arithmatex">\(x_0\)</span>, the mean of the transition density remains <span class="arithmatex">\(m(x_0,t)=x_0\)</span> for all <span class="arithmatex">\(t\)</span>. In terms of the SDE,</p>
<p>this property requires that the drift term does not “push” the process away from its initial value in expectation. Here are several common cases with specific forms for <span class="arithmatex">\(f(x,t)\)</span>:</p>
<h4 id="771-zero-drift">7.7.1 Zero Drift<a class="headerlink" href="#771-zero-drift" title="Permanent link">&para;</a></h4>
<p>The simplest case is when there is no drift at all. That is, set</p>
<div class="arithmatex">\[
f(x,t) = 0.
\]</div>
<p>Then the SDE becomes a pure diffusion process</p>
<div class="arithmatex">\[
dx = g(t)\,dw,
\]</div>
<p>and since there is no deterministic shift, we have</p>
<div class="arithmatex">\[
E[x(t) \mid x_0] = x_0.
\]</div>
<h4 id="772-centered-linear-drift">7.7.2 Centered Linear Drift<a class="headerlink" href="#772-centered-linear-drift" title="Permanent link">&para;</a></h4>
<p>Another case is to use a drift that is linear and “centered” at the initial condition. For the conditional process (i.e. given <span class="arithmatex">\(x(0)=x_0\)</span>), one can choose a drift of the form</p>
<div class="arithmatex">\[
f(x,t) = -a(t)\bigl(x - x_0\bigr),
\]</div>
<p>where <span class="arithmatex">\(a(t)\)</span> is a nonnegative function (or a positive function) of time. To see why this preserves the conditional mean, define</p>
<div class="arithmatex">\[
y(t)=x(t)-x_0.
\]</div>
<p>Then the SDE for <span class="arithmatex">\(y(t)\)</span> becomes</p>
<div class="arithmatex">\[
dy = -a(t)y\,dt + g(t)\,dw,
\]</div>
<p>with initial condition <span class="arithmatex">\(y(0)=0\)</span>. Since the drift term in <span class="arithmatex">\(y(t)\)</span> is proportional to <span class="arithmatex">\(y\)</span> and <span class="arithmatex">\(y(0)=0\)</span>, it follows by uniqueness and linearity of expectation that</p>
<div class="arithmatex">\[
E[y(t)] = 0,
\]</div>
<p>which implies</p>
<div class="arithmatex">\[
E[x(t) \mid x_0] = x_0.
\]</div>
<h4 id="773-symmetric-odd-drift-functions-around-x_0">7.7.3 Symmetric (Odd) Drift Functions Around <span class="arithmatex">\(x_0\)</span><a class="headerlink" href="#773-symmetric-odd-drift-functions-around-x_0" title="Permanent link">&para;</a></h4>
<p>More generally, any drift function that satisfies</p>
<div class="arithmatex">\[
f(x_0,t)=0 \quad \text{and} \quad f(x_0+\delta,t)=-f(x_0-\delta,t)
\]</div>
<p>for all small <span class="arithmatex">\(\delta\)</span> and for all <span class="arithmatex">\(t\)</span> will not induce a bias in the conditional mean. For example, one might choose</p>
<div class="arithmatex">\[
f(x,t) = -a(t)\,\tanh\bigl(x - x_0\bigr),
\]</div>
<p>where <span class="arithmatex">\(\tanh\)</span> is an odd function. Near <span class="arithmatex">\(x=x_0\)</span> (where <span class="arithmatex">\(\tanh(z) \approx z\)</span> for small <span class="arithmatex">\(z\)</span>), this behaves similarly to the linear case, ensuring that <span class="arithmatex">\(f(x_0,t)=0\)</span> and that the “push” is symmetric about <span class="arithmatex">\(x_0\)</span>. Hence, the conditional mean remains unchanged.</p>
<p>In summary, the conditional mean <span class="arithmatex">\(m(x_0,t)=x_0\)</span> is preserved if the drift <span class="arithmatex">\(f(x,t)\)</span> is chosen such that it does not introduce a net shift away from the initial condition <span class="arithmatex">\(x_0\)</span>. Common choices include:</p>
<ul>
<li><strong>Zero drift:</strong> <span class="arithmatex">\(f(x,t)=0\)</span>.</li>
<li><strong>Centered linear drift:</strong> <span class="arithmatex">\(f(x,t) = -a(t)(x-x_0)\)</span>.</li>
<li><strong>Symmetric (odd) drift:</strong> For instance, <span class="arithmatex">\(f(x,t) = -a(t)\,\tanh(x-x_0)\)</span>.</li>
</ul>
<h4 id="774-vp-vesub-ve-sdes">7.7.4 VP, VE,sub-VE SDEs<a class="headerlink" href="#774-vp-vesub-ve-sdes" title="Permanent link">&para;</a></h4>
<p>Below are the answers regarding the three SDE types and their conditional score functions:</p>
<h5 id="7741-vp-sde-variance-preserving-sde">7.7.4.1 VP SDE (Variance Preserving SDE)<a class="headerlink" href="#7741-vp-sde-variance-preserving-sde" title="Permanent link">&para;</a></h5>
<p><strong>Definition:</strong>
The VP SDE is typically defined as</p>
<div class="arithmatex">\[
dx = -\frac{1}{2}\beta(t)x\,dt + \sqrt{\beta(t)}\,dw.
\]</div>
<p><strong>Mean Behavior:</strong>
Its solution is</p>
<div class="arithmatex">\[
x(t) = e^{-\frac{1}{2}\int_0^t \beta(s)\,ds}\,x_0 + \sqrt{1-e^{-\int_0^t \beta(s)\,ds}}\,z,
\]</div>
<p>where <span class="arithmatex">\(z\sim\mathcal{N}(0,I)\)</span>. Therefore, the conditional mean is</p>
<div class="arithmatex">\[
m(x_0,t) = e^{-\frac{1}{2}\int_0^t \beta(s)\,ds}\,x_0,
\]</div>
<p>which is not equal to <span class="arithmatex">\(x_0\)</span> unless <span class="arithmatex">\(x_0=0\)</span> or <span class="arithmatex">\(\beta(t)\)</span> is zero. Hence, VP SDE does not preserve the mean.</p>
<p><strong>Conditional Score Function:</strong>
Since the conditional distribution is</p>
<div class="arithmatex">\[
p_{t|0}(x\mid x_0)=\mathcal{N}\Bigl(x;\, e^{-\frac{1}{2}\int_0^t \beta(s)\,ds}\,x_0,\; 1-e^{-\int_0^t \beta(s)\,ds}\Bigr),
\]</div>
<p>its conditional score function is</p>
<div class="arithmatex">\[
s(x,t\mid x_0) = \nabla_x \log p_{t|0}(x\mid x_0) = -\frac{x - e^{-\frac{1}{2}\int_0^t \beta(s)\,ds}\,x_0}{\,1-e^{-\int_0^t \beta(s)\,ds}\,}.
\]</div>
<hr />
<h5 id="7742-ve-sde-variance-exploding-sde">7.7.4.2 VE SDE (Variance Exploding SDE)<a class="headerlink" href="#7742-ve-sde-variance-exploding-sde" title="Permanent link">&para;</a></h5>
<p><strong>Definition:</strong>
The VE SDE is usually written as</p>
<div class="arithmatex">\[
dx = \sqrt{\frac{d\sigma^2(t)}{dt}}\,dw.
\]</div>
<p><strong>Mean Behavior:</strong>
Because there is no drift term, the solution is</p>
<div class="arithmatex">\[
x(t) = x_0 + \sigma(t)\,z,
\]</div>
<p>with <span class="arithmatex">\(z\sim\mathcal{N}(0,I)\)</span>. Thus, the conditional mean is</p>
<div class="arithmatex">\[
m(x_0,t)= x_0,
\]</div>
<p>i.e. the mean is preserved.</p>
<p><strong>Conditional Score Function:</strong>
Since</p>
<div class="arithmatex">\[
p_{t|0}(x\mid x_0)=\mathcal{N}\Bigl(x;\, x_0,\; \sigma^2(t)\Bigr),
\]</div>
<p>the conditional score function becomes</p>
<div class="arithmatex">\[
s(x,t\mid x_0) = -\frac{x-x_0}{\sigma^2(t)}.
\]</div>
<h5 id="7743-sub-vp-sde-sub-variance-preserving-sde">7.7.4.3 sub-VP SDE (Sub-Variance Preserving SDE)<a class="headerlink" href="#7743-sub-vp-sde-sub-variance-preserving-sde" title="Permanent link">&para;</a></h5>
<p><strong>Definition and Mean Behavior:</strong>
The sub-VP SDE is designed as a reparameterization of the VP SDE to cancel the exponential decay factor in the mean. By construction, its dynamics are modified so that the conditional mean is preserved:</p>
<div class="arithmatex">\[
m(x_0,t)= x_0.
\]</div>
<p>Although several equivalent formulations exist, a common interpretation is that the reparameterized process has a conditional distribution</p>
<div class="arithmatex">\[
p_{t|0}(x\mid x_0)=\mathcal{N}\Bigl(x;\, x_0,\; \tilde{\sigma}^2(t)\Bigr),
\]</div>
<p>with a suitably defined variance schedule <span class="arithmatex">\(\tilde{\sigma}^2(t)\)</span>.</p>
<p><strong>Conditional Score Function:</strong>
Then the conditional score function for the sub-VP SDE is</p>
<div class="arithmatex">\[
s(x,t\mid x_0) = -\frac{x-x_0}{\tilde{\sigma}^2(t)}.
\]</div>
<h3 id="78-summary">7.8 Summary<a class="headerlink" href="#78-summary" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>VP SDE:</strong></li>
<li><strong>Mean:</strong> <span class="arithmatex">\(m(x_0,t)= e^{-\frac{1}{2}\int_0^t \beta(s)\,ds}\,x_0\)</span> (not preserved)</li>
<li><strong>Conditional Score:</strong></li>
</ul>
<div class="arithmatex">\[
s(x,t\mid x_0) = -\frac{x - e^{-\frac{1}{2}\int_0^t \beta(s)\,ds}\,x_0}{\,1-e^{-\int_0^t \beta(s)\,ds}\,}.
\]</div>
<ul>
<li><strong>VE SDE:</strong></li>
<li><strong>Mean:</strong> <span class="arithmatex">\(m(x_0,t)= x_0\)</span> (preserved)</li>
<li><strong>Conditional Score:</strong></li>
</ul>
<div class="arithmatex">\[
s(x,t\mid x_0) = -\frac{x-x_0}{\sigma^2(t)}.
\]</div>
<ul>
<li><strong>sub-VP SDE:</strong></li>
<li><strong>Mean:</strong> <span class="arithmatex">\(m(x_0,t)= x_0\)</span> (by design)</li>
<li><strong>Conditional Score:</strong></li>
</ul>
<div class="arithmatex">\[
s(x,t\mid x_0) = -\frac{x-x_0}{\tilde{\sigma}^2(t)}.
\]</div>
<h3 id="79-conclusion">7.9 Conclusion<a class="headerlink" href="#79-conclusion" title="Permanent link">&para;</a></h3>
<p>To summarize:</p>
<ul>
<li><strong>Score Functions:</strong></li>
<li>The <strong>marginal score function</strong> is defined as <span class="arithmatex">\(\nabla_x \log p_t(x)\)</span>. Under Gaussian assumptions, we derived</li>
</ul>
<div class="arithmatex">\[
s(x,t) = -\frac{x - \mathbb{E}[m(x_0,t) \mid x]}{\sigma_t^2} \quad \text{or} \quad s(x,t) = -\Sigma(t)^{-1}\bigl(x - m(t)\bigr).
\]</div>
<ul>
<li>The <strong>conditional score function</strong> for the transition density <span class="arithmatex">\(p_{t|0}(x \mid x_0)\)</span> is</li>
</ul>
<div class="arithmatex">\[
s(x,t\mid x_0) = -\frac{x - m(x_0,t)}{\sigma_t^2},
\]</div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>and under linear drift and state-independent diffusion, this becomes
</code></pre></div></td></tr></table></div>
<div class="arithmatex">\[
s(x,t\mid x_0) = -\frac{x - (\Psi(t)x_0 + \mu(t))}{\sigma_t^2}.
\]</div>
<ul>
<li>
<p><strong>Gaussian Transition Probabilities:</strong>
  The transition probability remains Gaussian if the drift is linear (or affine), <span class="arithmatex">\(f(x,t)=A(t)x+b(t)\)</span>, and the diffusion is state-independent, <span class="arithmatex">\(g(x,t)=g(t)\)</span>.</p>
</li>
<li>
<p><strong>State Transition Matrix <span class="arithmatex">\(\Psi(t)\)</span> and <span class="arithmatex">\(A(t)\)</span>:</strong>
  <span class="arithmatex">\(\Psi(t)\)</span> satisfies</p>
</li>
</ul>
<p>$$
  \frac{d}{dt}\Psi(t) = A(t)\,\Psi(t) \quad \text{with} \quad \Psi(0)=I.
  $$</p>
<p>When <span class="arithmatex">\(A(t)\)</span> is time-invariant, <span class="arithmatex">\(\Psi(t) = e^{At}\)</span>. More generally, if <span class="arithmatex">\(A(t)\)</span> commutes with itself at different times, then</p>
<p>$$
  \Psi(t) = \exp\left(\int_0^t A(s)\,ds\right),
  $$</p>
<p>providing a closed-form expression for the state transition matrix.</p>
<ul>
<li><strong>Non-Gaussian Example:</strong>
  When <span class="arithmatex">\(g(x,t)\)</span> depends on <span class="arithmatex">\(x\)</span>, as in geometric Brownian motion (<span class="arithmatex">\(dx=\mu x\,dt + \sigma x\,dw\)</span>), the resulting transition probability becomes log-normal rather than Gaussian.</li>
</ul>
<h2 id="8-extenstion-types-of-score-based-sde">8. Extenstion Types of Score Based SDE<a class="headerlink" href="#8-extenstion-types-of-score-based-sde" title="Permanent link">&para;</a></h2>
<p>Beyond <strong>VPSDE, VESDE, and Sub-VPSDE</strong>, there are several other types of <strong>Score-based SDEs</strong> that modify the drift and diffusion terms to improve generation quality, stability, or computational efficiency.</p>
<p>Here are some additional <strong>Score-based SDEs</strong>:</p>
<h3 id="81-critically-damped-langevin-diffusion-cld-sde">8.1 Critically Damped Langevin Diffusion (CLD-SDE)<a class="headerlink" href="#81-critically-damped-langevin-diffusion-cld-sde" title="Permanent link">&para;</a></h3>
<p>This method introduces <strong>momentum variables</strong> to improve sampling efficiency. Unlike VPSDE/VESDE, which use only position updates, CLD-SDE includes velocity to achieve faster convergence.</p>
<h4 id="811-sde-formulation">8.1.1 SDE Formulation<a class="headerlink" href="#811-sde-formulation" title="Permanent link">&para;</a></h4>
<div class="arithmatex">\[
\begin{cases}
dx &amp;= v dt \\
dv &amp;= -\gamma v dt - \lambda^2 x dt + \sigma dw
\end{cases}
\]</div>
<p>where:</p>
<ul>
<li><span class="arithmatex">\( x \)</span> is the <strong>position</strong>.</li>
<li><span class="arithmatex">\( v \)</span> is the <strong>velocity</strong>.</li>
<li><span class="arithmatex">\( \gamma \)</span> is the <strong>friction coefficient</strong> (controls how fast momentum dissipates).</li>
<li><span class="arithmatex">\( \lambda \)</span> is the <strong>spring constant</strong> (pulls data towards the center).</li>
<li>
<p><span class="arithmatex">\( \sigma \)</span> is the <strong>noise strength</strong>.</p>
</li>
<li>
<p>score function</p>
</li>
</ul>
<div class="arithmatex">\[
\nabla_{v_t} \log p(v_t | x_t) = -\frac{v_t + \lambda^2 x_t}{\sigma^2}
\]</div>
<ul>
<li>training loss</li>
</ul>
<div class="arithmatex">\[|| \nabla_{v_t} \log p(v_t | x_t) - s_\theta(x,v)||^2\]</div>
<ul>
<li>initial condition</li>
<li><span class="arithmatex">\(v=0\)</span></li>
<li><span class="arithmatex">\(x \sim p_{data}(x)\)</span></li>
<li>training data construction</li>
<li>use the SDE discrete formula to estimate <span class="arithmatex">\(x_t, v_t\)</span> and calculate the score function accordingly</li>
</ul>
<h4 id="812-key-features">8.1.2 Key Features<a class="headerlink" href="#812-key-features" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Faster sampling</strong>: Uses both position and momentum to traverse the data manifold efficiently.</li>
<li><strong>Inspired by Langevin dynamics</strong>, used in Hamiltonian Monte Carlo (HMC).</li>
</ul>
<h3 id="82-rectified-flow-sde">8.2 Rectified Flow SDE<a class="headerlink" href="#82-rectified-flow-sde" title="Permanent link">&para;</a></h3>
<p>Instead of traditional diffusion, <strong>Rectified Flow SDE</strong> designs a flow field where trajectories follow a <strong>straight-line path</strong> from data to noise.</p>
<h4 id="821-sde-formulation">8.2.1 SDE Formulation<a class="headerlink" href="#821-sde-formulation" title="Permanent link">&para;</a></h4>
<div class="arithmatex">\[
dx = (x_T - x) dt + g(t) dw
\]</div>
<p>where:</p>
<ul>
<li><span class="arithmatex">\( x_T \)</span> is the terminal (noise) state.</li>
<li><span class="arithmatex">\( g(t) \)</span> controls the noise schedule.</li>
</ul>
<h4 id="822-key-features">8.2.2 Key Features<a class="headerlink" href="#822-key-features" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Deterministic reverse process</strong>: Paths are approximately straight, reducing error in reverse sampling.</li>
<li><strong>Faster convergence</strong>: Uses ODE-based sampling efficiently.</li>
</ul>
<h4 id="823-training-details">8.2.3 Training Details<a class="headerlink" href="#823-training-details" title="Permanent link">&para;</a></h4>
<ul>
<li>Loss: MSE loss on score function</li>
<li>data construction</li>
</ul>
<div class="arithmatex">\[x_t =(1-t) x_0 + t x_T\]</div>
<ul>
<li>score function</li>
</ul>
<div class="arithmatex">\[\nabla_x \log p_t (x_t|x_0) = - \frac{x_t - x_0}{\sigma_t}\]</div>
<h4 id="824-formula-for-sigma_t">8.2.4 Formula for <span class="arithmatex">\( \sigma_t \)</span><a class="headerlink" href="#824-formula-for-sigma_t" title="Permanent link">&para;</a></h4>
<p>The variance of the noise term in the Rectified Flow SDE can be written as:</p>
<div class="arithmatex">\[
\sigma_t^2 = \int_0^t g(s)^2 ds
\]</div>
<p>The function <span class="arithmatex">\( g(t) \)</span> is designed to <strong>minimize unnecessary randomness</strong>, leading to <strong>more deterministic trajectories</strong>.</p>
<p>A common choice for <span class="arithmatex">\( g(t) \)</span> is:</p>
<div class="arithmatex">\[
g(t) = \sigma_0 \sqrt{1 - t}
\]</div>
<p>where <span class="arithmatex">\( \sigma_0 \)</span> is a constant that determines the initial noise scale.</p>
<p>Thus, the variance accumulates as:</p>
<div class="arithmatex">\[
\sigma_t^2 = \int_0^t \sigma_0^2 (1 - s) ds = \sigma_0^2 \left( t - \frac{t^2}{2} \right)
\]</div>
<p>which gives:</p>
<div class="arithmatex">\[
\sigma_t = \sigma_0 \sqrt{t - \frac{t^2}{2}}
\]</div>
<p>This ensures that noise starts <strong>large</strong> at <span class="arithmatex">\( t=0 \)</span> and gradually decreases to <strong>zero</strong> as <span class="arithmatex">\( t \to 1 \)</span>, making the flow almost deterministic near the final state.</p>
<p>Using the definition:</p>
<div class="arithmatex">\[
\nabla_x \log p_t(x_t | x_0) = -\frac{x_t - x_0}{\sigma_t^2}
\]</div>
<p>we get:</p>
<div class="arithmatex">\[
\nabla_x \log p_t(x_t | x_0) = -\frac{x_t - x_0}{\sigma_0^2 (t - \frac{t^2}{2})}
\]</div>
<p>which reduces to:</p>
<div class="arithmatex">\[
\nabla_x \log p_t(x_t | x_0) = -\frac{x_t - x_0}{\sigma_0^2 t (1 - \frac{t}{2})}
\]</div>
<ul>
<li><strong>Noise scaling function:</strong></li>
</ul>
<div class="arithmatex">\[
g(t) = \sigma_0 \sqrt{1 - t}
\]</div>
<ul>
<li><strong>Variance accumulation:</strong></li>
</ul>
<div class="arithmatex">\[
\sigma_t^2 = \sigma_0^2 (t - \frac{t^2}{2})
\]</div>
<ul>
<li><strong>Score function:</strong></li>
</ul>
<div class="arithmatex">\[
\nabla_x \log p_t(x_t | x_0) = -\frac{x_t - x_0}{\sigma_0^2 t (1 - \frac{t}{2})}
\]</div>
<h3 id="83-continuous-time-normalizing-flows-ctnf-sde">8.3 Continuous-Time Normalizing Flows (CTNF-SDE)<a class="headerlink" href="#83-continuous-time-normalizing-flows-ctnf-sde" title="Permanent link">&para;</a></h3>
<p>Continuous-Time Normalizing Flows (CTNF) combine <strong>normalizing flows</strong> with <strong>stochastic differential equations (SDEs)</strong>. Unlike traditional diffusion models, CTNF explicitly models the log-likelihood of the data, making it a <strong>likelihood-based generative model</strong>.</p>
<h4 id="831-sde-formulation">8.3.1 SDE Formulation<a class="headerlink" href="#831-sde-formulation" title="Permanent link">&para;</a></h4>
<p>The <strong>CTNF-SDE</strong> is defined as:</p>
<div class="arithmatex">\[
dx = f(x, t) dt + g(x, t) dw
\]</div>
<p>where:</p>
<ul>
<li><span class="arithmatex">\( f(x, t) \)</span> is a <strong>learnable drift function</strong>.</li>
<li><span class="arithmatex">\( g(x, t) \)</span> is a <strong>learnable diffusion function</strong>.</li>
<li><span class="arithmatex">\( dw \)</span> is a <strong>Wiener process</strong> (Brownian motion).</li>
<li>The drift <span class="arithmatex">\( f(x, t) \)</span> and diffusion <span class="arithmatex">\( g(x, t) \)</span> are parameterized using neural networks.</li>
</ul>
<p>This SDE can be <strong>interpreted as a normalizing flow in continuous time</strong>, where we transform a simple base distribution (e.g., Gaussian) into the data distribution.</p>
<hr />
<h4 id="832-variance-function-sigma_t">8.3.2 Variance Function <span class="arithmatex">\( \sigma_t \)</span><a class="headerlink" href="#832-variance-function-sigma_t" title="Permanent link">&para;</a></h4>
<p>For CTNF, the variance function is <strong>learned</strong> rather than fixed. It follows:</p>
<div class="arithmatex">\[
\sigma_t^2 = \int_0^t g(x, s)^2 ds
\]</div>
<p>This means:</p>
<ul>
<li><span class="arithmatex">\( \sigma_t \)</span> is <strong>data-dependent</strong>.</li>
<li>The noise schedule adapts based on the dataset.</li>
</ul>
<h4 id="833-score-function">8.3.3 Score Function<a class="headerlink" href="#833-score-function" title="Permanent link">&para;</a></h4>
<p>The score function is derived as:</p>
<div class="arithmatex">\[
\nabla_x \log p_t(x_t | x_0) = -\frac{x_t - \mu_t}{\sigma_t^2}
\]</div>
<p>where:</p>
<ul>
<li><span class="arithmatex">\( \mu_t \)</span> and <span class="arithmatex">\( \sigma_t^2 \)</span> are estimated using the learned drift and diffusion functions.</li>
</ul>
<p>Since <span class="arithmatex">\( g(x, t) \)</span> is <strong>learned</strong>, the score function is <strong>not fixed</strong> like in traditional diffusion models.</p>
<hr />
<h4 id="834-training-loss">8.3.4 Training Loss<a class="headerlink" href="#834-training-loss" title="Permanent link">&para;</a></h4>
<p>CTNF optimizes a <strong>log-likelihood loss</strong> based on the probability flow ODE:</p>
<div class="arithmatex">\[
\mathcal{L}(\theta) = \mathbb{E}_{x_t} \left[ -\log p_t(x_t) \right]
\]</div>
<p>Alternatively, we can use <strong>score matching</strong>:</p>
<div class="arithmatex">\[
\mathbb{E}_{x_t} \left[ || \nabla_x \log p_t(x_t | x_0) - s_\theta(x, t) ||^2 \right]
\]</div>
<hr />
<h4 id="835-initial-condition">8.3.5 Initial Condition<a class="headerlink" href="#835-initial-condition" title="Permanent link">&para;</a></h4>
<ul>
<li><span class="arithmatex">\( x \sim p_{data}(x) \)</span> (samples from the data distribution).</li>
</ul>
<h3 id="84-training-data-construction">8.4 Training Data Construction<a class="headerlink" href="#84-training-data-construction" title="Permanent link">&para;</a></h3>
<p>Since <span class="arithmatex">\( x_t \)</span> does <strong>not</strong> have an analytical solution, we must <strong>numerically estimate it</strong>:</p>
<ul>
<li><strong>Use SDE discretization</strong>:</li>
</ul>
<p>$$
  x_{t+\Delta t} = x_t + f(x_t, t) \Delta t + g(x_t, t) \sqrt{\Delta t} \eta_t, \quad \eta_t \sim \mathcal{N}(0, I)
  $$</p>
<ul>
<li>Compute the <strong>score function</strong> numerically.</li>
</ul>
<hr />
<h4 id="841-summary">8.4.1 Summary<a class="headerlink" href="#841-summary" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th><strong>Property</strong></th>
<th><strong>CTNF-SDE</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Equation</strong></td>
<td><span class="arithmatex">\( dx = f(x, t) dt + g(x, t) dw \)</span></td>
</tr>
<tr>
<td><strong><span class="arithmatex">\( \sigma_t \)</span></strong></td>
<td><span class="arithmatex">\( \sigma_t^2 = \int_0^t g(x, s)^2 ds \)</span></td>
</tr>
<tr>
<td><strong>Score Function</strong></td>
<td><span class="arithmatex">\( \nabla_x \log p_t(x_t\| x_0) = -\frac{x_t - \mu_t}{\sigma_t^2} \)</span></td>
</tr>
<tr>
<td><strong>Training Loss</strong></td>
<td><span class="arithmatex">\( -\mathbb{E}_{x_t} \log p_t(x_t) \)</span> or score matching</td>
</tr>
<tr>
<td><strong>Training Data Construction</strong></td>
<td>SDE discretization</td>
</tr>
</tbody>
</table>
<h3 id="85-score-based-sdes-with-adaptive-noise-an-sde">8.5 Score-Based SDEs with Adaptive Noise (AN-SDE)<a class="headerlink" href="#85-score-based-sdes-with-adaptive-noise-an-sde" title="Permanent link">&para;</a></h3>
<p>Instead of fixing a noise schedule, <strong>Adaptive Noise SDE</strong> dynamically adjusts <span class="arithmatex">\( g(t) \)</span> based on data properties.</p>
<div class="arithmatex">\[
dx = f(x, t) dt + \sigma(x, t) dw
\]</div>
<p>where:</p>
<ul>
<li><span class="arithmatex">\( \sigma(x, t) \)</span> is <strong>data-dependent</strong> noise.</li>
</ul>
<h3 id="86-key-features">8.6 <strong>Key Features</strong><a class="headerlink" href="#86-key-features" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Adapts to dataset complexity</strong> (e.g., higher noise for high-frequency details).</li>
<li><strong>Better preservation of structure</strong> in images and 3D modeling.</li>
</ul>
<hr />
<h2 id="9-fractional-brownian-motion-sde-fbm-sde">9. Fractional Brownian Motion SDE (FBM-SDE)<a class="headerlink" href="#9-fractional-brownian-motion-sde-fbm-sde" title="Permanent link">&para;</a></h2>
<p>Instead of using standard <strong>Brownian motion</strong>, FBM-SDE incorporates <strong>long-range dependencies</strong>.</p>
<div class="arithmatex">\[
dx = -\alpha x dt + g(t) dB^H_t
\]</div>
<p>where:</p>
<ul>
<li><span class="arithmatex">\( B^H_t \)</span> is a <strong>fractional Brownian motion</strong> with <strong>Hurst parameter <span class="arithmatex">\( H \)</span></strong>.</li>
<li><span class="arithmatex">\( H \)</span> controls <strong>memory effects</strong> (larger <span class="arithmatex">\( H \)</span> → more persistent motion).</li>
</ul>
<h3 id="91-key-features">9.1 <strong>Key Features</strong><a class="headerlink" href="#91-key-features" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Models long-range dependencies</strong> (useful in speech, financial modeling).</li>
<li><strong>Better generation for sequential data</strong>.</li>
</ul>
<hr />
<h2 id="10-hybrid-sde-ode-models">10. Hybrid SDE-ODE Models<a class="headerlink" href="#10-hybrid-sde-ode-models" title="Permanent link">&para;</a></h2>
<p>Some models <strong>combine SDE and ODE approaches</strong> to get the best of both:</p>
<div class="arithmatex">\[
\begin{cases}
dx = f(x, t) dt + g(t) dw  &amp;\text{for } t &lt; T_1\\
dx = f(x, t) dt  &amp;\text{for } t \geq T_1
\end{cases}
\]</div>
<p>where:</p>
<ul>
<li>The system <strong>follows an SDE</strong> initially (better exploration).</li>
<li>The system <strong>switches to an ODE</strong> at a later stage (better precision).</li>
</ul>
<h3 id="101-key-features">10.1 <strong>Key Features</strong><a class="headerlink" href="#101-key-features" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Combines SDE exploration with ODE stability</strong>.</li>
<li><strong>More efficient sampling</strong> compared to full SDE models.</li>
</ul>
<hr />
<h2 id="11-summary-of-score-based-sdes">11. Summary of Score-Based SDEs<a class="headerlink" href="#11-summary-of-score-based-sdes" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th><strong>SDE Type</strong></th>
<th><strong>Equation</strong></th>
<th><strong>Key Features</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>VPSDE</strong></td>
<td><span class="arithmatex">\( dx = -\frac{1}{2} \beta(t) x dt + \sqrt{\beta(t)} dw \)</span></td>
<td>Standard variance-preserving diffusion</td>
</tr>
<tr>
<td><strong>VESDE</strong></td>
<td><span class="arithmatex">\( dx = \sigma(t) dw \)</span></td>
<td>Large-scale noise growth (variance exploding)</td>
</tr>
<tr>
<td><strong>Sub-VPSDE</strong></td>
<td><span class="arithmatex">\( dx = -\frac{1}{2} \beta(t) x dt + \sqrt{\beta(t)(1 - e^{-2\int_0^t \beta(s) ds})} dw \)</span></td>
<td>Controlled noise decay</td>
</tr>
<tr>
<td><strong>CLD-SDE</strong></td>
<td><span class="arithmatex">\( dx = v dt, \quad dv = -\gamma v dt - \lambda^2 x dt + \sigma dw \)</span></td>
<td>Faster convergence with momentum</td>
</tr>
<tr>
<td><strong>Rectified Flow SDE</strong></td>
<td><span class="arithmatex">\( dx = (x_T - x) dt + g(t) dw \)</span></td>
<td>Near-deterministic straight-line flow</td>
</tr>
<tr>
<td><strong>CTNF-SDE</strong></td>
<td><span class="arithmatex">\( dx = f(x, t) dt + g(x, t) dw \)</span></td>
<td>Normalizing flows + diffusion</td>
</tr>
<tr>
<td><strong>Generalized SDE</strong></td>
<td><span class="arithmatex">\( dx = -f(x, t) dt + g(t) dw \)</span></td>
<td>Customizable drift and noise schedules</td>
</tr>
<tr>
<td><strong>AN-SDE</strong></td>
<td><span class="arithmatex">\( dx = f(x, t) dt + \sigma(x, t) dw \)</span></td>
<td>Adaptive noise for structured data</td>
</tr>
<tr>
<td><strong>FBM-SDE</strong></td>
<td><span class="arithmatex">\( dx = -\alpha x dt + g(t) dB^H_t \)</span></td>
<td>Models long-range dependencies</td>
</tr>
<tr>
<td><strong>Hybrid SDE-ODE</strong></td>
<td><span class="arithmatex">\( dx = f(x, t) dt + g(t) dw \)</span> for early <span class="arithmatex">\( t \)</span>, <span class="arithmatex">\( dx = f(x, t) dt \)</span> later</td>
<td>Mixes SDE and ODE for stability</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="12-conclusion">12. <strong>Conclusion</strong><a class="headerlink" href="#12-conclusion" title="Permanent link">&para;</a></h2>
<p>While <strong>VPSDE and VESDE</strong> are the most widely used Score-based SDEs, many variations <strong>introduce optimizations</strong> for different tasks.</p>
<ul>
<li><strong>Momentum-based SDEs (CLD-SDE)</strong> → <strong>Faster sampling</strong>.</li>
<li><strong>Straight-line diffusion (Rectified Flow)</strong> → <strong>Better sample paths</strong>.</li>
<li><strong>Hybrid SDE-ODE models</strong> → <strong>Efficient sampling</strong>.</li>
<li><strong>Adaptive SDEs (AN-SDE)</strong> → <strong>Noise adjustment based on data</strong>.</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Score Based SDE vs SDE diffusion</p>
<p>SDE Diffusion (Stochastic Differential Equation-based diffusion models) and Score-based SDE (Score-based Stochastic Differential Equations) are closely related in the field of generative models, but they are not completely equivalent. Most SDE Diffusion models involve the estimation of score functions and therefore fall under the category of Score-based SDE. However, there are still some SDE Diffusion models that do not directly rely on the estimation of score functions.</p>
<p>For example, the Fractional SDE-Net is a generative model for time series data with long-term dependencies. This model is based on fractional Brownian motion and captures the long-range dependency characteristics in time series by introducing fractional-order stochastic differential equations. In this approach, the model focuses on simulating the temporal dependency structure of the data rather than directly estimating the score function of the data distribution.</p>
<p>Additionally, the Diffusion-Model-Assisted Supervised Learning method uses diffusion models to generate labeled data to assist in density estimation tasks in supervised learning. This method directly approximates the score function in the reverse-time SDE through a training-free score estimation method, thereby improving sampling efficiency and model performance. Although this method involves the estimation of score functions, its primary goal is to generate auxiliary data through diffusion models to enhance the supervised learning process.</p>
<p>In summary, while most SDE Diffusion models fall under the category of Score-based SDE, there are still some models, such as the Fractional SDE-Net and Diffusion-Model-Assisted Supervised Learning method, that focus on other aspects, such as modeling temporal dependency structures or assisting supervised learning, without directly relying on score function estimation.</p>
</div>









  



<!-- 段落注释系统
<div class="comments-container annotation-container">
  <div class="comments-header">
    <h2 id="__annotations" class="comments-title">
      <span class="comments-icon">🔍</span>
      段落注释
      <span class="comments-subtitle">您可以高亮并评论任何文本!</span>
    </h2>
    <div class="comments-divider"></div>
  </div>

  <div class="comments-wrapper">
    <div class="hypothesis-instructions">
      <p><strong>如何使用段落注释功能：</strong></p>
      <ol>
        <li>点击右上角的 <img src="https://hypothes.is/assets/images/logo.png" alt="Hypothesis" style="height: 16px; vertical-align: middle;"> 图标打开侧边栏</li>
        <li>选择任意文本段落即可高亮并添加注释</li>
        <li>您还可以对其他人的注释进行回复</li>
      </ol>
    </div>
  </div>
</div> -->

<!-- 加载  -->
<script type="application/json" class="js-hypothesis-config">
{
  "openSidebar": false,
  "showHighlights": true,
  "theme": "clean"
}
</script>
<script async src="https://hypothes.is/embed.js"></script>

<!-- Hypothesis 样式美化 -->
<style>
  /* 修改高亮效果为下划线和聊天泡泡 */
  .hypothesis-highlight {
    background-color: transparent !important; /* 移除高亮背景 */
    text-decoration: underline !important;
    text-decoration-color: #4285f4 !important;
    text-decoration-thickness: 2px !important;
    text-decoration-style: wavy !important;
    position: relative !important;
    cursor: pointer !important;
    border-bottom: none !important; /* 移除之前的边框 */
    box-shadow: none !important; /* 移除之前的阴影 */
  }

  .hypothesis-highlight::after {
    content: "💬" !important;
    position: absolute !important;
    display: inline-block !important;
    font-size: 14px !important;
    top: -10px !important;
    right: -5px !important;
    opacity: 0.7 !important;
    transition: opacity 0.3s ease !important;
  }

  .hypothesis-highlight:hover {
    background-color: rgba(66, 133, 244, 0.08) !important; /* 鼠标悬停时的轻微背景 */
  }

  .hypothesis-highlight:hover::after {
    opacity: 1 !important;
    transform: scale(1.2) !important;
  }

  /* 美化 Hypothesis 侧边栏 */
  hypothesis-sidebar {
    font-family: var(--md-text-font-family, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif) !important;
    box-shadow: -2px 0 10px rgba(0, 0, 0, 0.1) !important;
  }

  /* 美化卡片样式 */
  .hypothesis-annotation-card {
    border-radius: 8px !important;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05) !important;
    transition: transform 0.2s ease, box-shadow 0.2s ease !important;
    overflow: hidden !important;
  }

  .hypothesis-annotation-card:hover {
    transform: translateY(-2px) !important;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1) !important;
  }

  /* 美化 Hypothesis 按钮 */
  .hypothesis-button {
    border-radius: 4px !important;
    transition: background-color 0.2s ease !important;
  }

  /* 美化标签样式 */
  .hypothesis-tag {
    border-radius: 12px !important;
    padding: 2px 8px !important;
    font-size: 12px !important;
    background-color: rgba(0, 0, 0, 0.05) !important;
    color: #606060 !important;
  }

  /* 美化工具栏 */
  .hypothesis-toolbar {
    background: linear-gradient(to right, #f5f5f5, #ffffff) !important;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1) !important;
  }

  /* 美化注释面板header */
  .hypothesis-annotation-header {
    padding: 10px !important;
    background-color: #f9f9f9 !important;
  }

  /* 美化注释内容 */
  .hypothesis-annotation-body {
    font-size: 14px !important;
    line-height: 1.6 !important;
    color: #333 !important;
  }

  /* 美化用户名 */
  .hypothesis-user {
    font-weight: 600 !important;
    color: #3f51b5 !important;
  }

  /* 美化时间戳 */
  .hypothesis-timestamp {
    font-size: 12px !important;
    color: #757575 !important;
  }

  /* 美化输入框 */
  .hypothesis-input {
    border-radius: 4px !important;
    border: 1px solid #e0e0e0 !important;
    transition: border-color 0.2s ease, box-shadow 0.2s ease !important;
  }

  .hypothesis-input:focus {
    border-color: #4dabf7 !important;
    box-shadow: 0 0 0 2px rgba(77, 171, 247, 0.2) !important;
    outline: none !important;
  }
</style>

<!-- 页面评论系统 -->
<div class="comments-container utterances-container">
  <div class="comments-header">
    <h2 id="__comments" class="comments-title">
      <span class="comments-icon">💬</span>
      Comments
      <span class="comments-subtitle">Share your thoughts!</span>
    </h2>
    <div class="comments-divider"></div>
  </div>

  <div class="comments-wrapper">
    <script src="https://utteranc.es/client.js"
            repo="MAD-SG/generative-ai-start-to-surrender"
            issue-term="pathname"
            label="comment"
            theme="preferred-color-scheme"
            crossorigin="anonymous"
            async>
    </script>
  </div>
</div>

<style>
  .comments-container {
    margin: 2.5rem auto;
    padding: 1.5rem;
    background: var(--md-code-bg-color, rgba(0, 0, 0, 0.05));
    border-radius: 8px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    width: 100%;
    max-width: 100%;
    box-sizing: border-box;
  }

  .annotation-container {
    margin-bottom: 1rem;
    background: rgba(255, 255, 240, 0.5);
    border-left: 4px solid #ffeb3b;
  }

  .utterances-container {
    background: rgba(240, 248, 255, 0.5);
    border-left: 4px solid #2196f3;
  }

  .comments-container:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 12px rgba(0, 0, 0, 0.1);
  }

  .comments-header {
    margin-bottom: 1.5rem;
  }

  .comments-title {
    font-weight: 600;
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin-top: 0;
    margin-bottom: 0.75rem;
    color: var(--md-primary-fg-color, #2196f3);
    flex-wrap: wrap;
  }

  .annotation-container .comments-title {
    color: #f57c00;
  }

  .comments-icon {
    font-size: 1.4em;
  }

  .comments-subtitle {
    font-size: 0.7em;
    font-weight: 400;
    opacity: 0.8;
    margin-left: 1rem;
  }

  .comments-divider {
    height: 3px;
    background: linear-gradient(90deg,
      var(--md-primary-fg-color, #2196f3) 0%,
      rgba(255, 255, 255, 0) 100%);
    border-radius: 3px;
    margin-bottom: 1rem;
    width: 100%;
  }

  .annotation-container .comments-divider {
    background: linear-gradient(90deg,
      #f57c00 0%,
      rgba(255, 255, 255, 0) 100%);
  }

  .comments-wrapper {
    position: relative;
    min-height: 150px;
    width: 100%;
  }

  .hypothesis-instructions {
    padding: 1rem;
    background-color: rgba(255, 255, 255, 0.5);
    border-radius: 6px;
    margin-bottom: 1rem;
  }

  .hypothesis-instructions p {
    margin-top: 0;
    font-weight: 500;
  }

  .hypothesis-instructions ol {
    margin-bottom: 0;
    padding-left: 1.5rem;
  }

  .hypothesis-instructions li {
    margin-bottom: 0.5rem;
  }

  .hypothesis-instructions li:last-child {
    margin-bottom: 0;
  }

  /* 确保utterances的iframe填充可用宽度 */
  .utterances-container .comments-wrapper iframe {
    border-radius: 6px;
    width: 100% !important;
    max-width: 100% !important;
  }

  /* 动画效果 */
  @keyframes fadeInUp {
    from {
      opacity: 0;
      transform: translate3d(0, 20px, 0);
    }
    to {
      opacity: 1;
      transform: translate3d(0, 0, 0);
    }
  }

  .comments-wrapper {
    animation: fadeInUp 0.6s ease forwards;
  }

  /* 响应式设计 - 小屏幕调整 */
  @media (max-width: 768px) {
    .comments-container {
      padding: 1rem;
      margin: 1.5rem auto;
    }

    .comments-title {
      font-size: 1.3rem;
    }

    .comments-subtitle {
      display: block;
      width: 100%;
      margin-left: 0;
      margin-top: 0.3rem;
    }
  }
</style>
                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../from_ddpm_2_sde/" class="md-footer__link md-footer__link--prev" aria-label="Previous: SDE for DDPM">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                SDE for DDPM
              </div>
            </div>
          </a>
        
        
          
          <a href="../probability_flow_ode/" class="md-footer__link md-footer__link--next" aria-label="Next: Probability Flow ODE">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Probability Flow ODE
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://mad-sg.github.io/generative-ai-start-to-surrender/" target="_blank" rel="noopener" title="mad-sg.github.io" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://hub.docker.com/r/squidfunk/mkdocs-material/" target="_blank" rel="noopener" title="hub.docker.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M349.9 236.3h-66.1v-59.4h66.1zm0-204.3h-66.1v60.7h66.1zm78.2 144.8H362v59.4h66.1zm-156.3-72.1h-66.1v60.1h66.1zm78.1 0h-66.1v60.1h66.1zm276.8 100c-14.4-9.7-47.6-13.2-73.1-8.4-3.3-24-16.7-44.9-41.1-63.7l-14-9.3-9.3 14c-18.4 27.8-23.4 73.6-3.7 103.8-8.7 4.7-25.8 11.1-48.4 10.7H2.4c-8.7 50.8 5.8 116.8 44 162.1 37.1 43.9 92.7 66.2 165.4 66.2 157.4 0 273.9-72.5 328.4-204.2 21.4.4 67.6.1 91.3-45.2 1.5-2.5 6.6-13.2 8.5-17.1zm-511.1-27.9h-66v59.4h66.1v-59.4zm78.1 0h-66.1v59.4h66.1zm78.1 0h-66.1v59.4h66.1zm-78.1-72.1h-66.1v60.1h66.1z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://pypi.org/project/mkdocs-material/" target="_blank" rel="noopener" title="pypi.org" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6M286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3M167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4m-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://bsky.app/profile/squidfunk.bsky.social" target="_blank" rel="noopener" title="bsky.app" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M111.8 62.2C170.2 105.9 233 194.7 256 242.4c23-47.6 85.8-136.4 144.2-180.2 42.1-31.6 110.3-56 110.3 21.8 0 15.5-8.9 130.5-14.1 149.2-18.2 64.8-84.4 81.4-143.3 71.3C456 322 482.2 380 425.6 438c-107.4 110.2-154.3-27.6-166.3-62.9-1.7-4.9-2.6-7.8-3.3-7.8s-1.6 3-3.3 7.8c-12 35.3-59 173.1-166.3 62.9-56.5-58-30.4-116 72.5-133.5C100 314.6 33.8 298 15.7 233.1 10.4 214.4 1.5 99.4 1.5 83.9c0-77.8 68.2-53.4 110.3-21.8z"/></svg>
    </a>
  
    
    
      
    
    
    
      
      
    
    <a href="https://fosstodon.org/@squidfunk" target="_blank" rel="noopener me" title="fosstodon.org" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M433 179.11c0-97.2-63.71-125.7-63.71-125.7-62.52-28.7-228.56-28.4-290.48 0 0 0-63.72 28.5-63.72 125.7 0 115.7-6.6 259.4 105.63 289.1 40.51 10.7 75.32 13 103.33 11.4 50.81-2.8 79.32-18.1 79.32-18.1l-1.7-36.9s-36.31 11.4-77.12 10.1c-40.41-1.4-83-4.4-89.63-54a102.5 102.5 0 0 1-.9-13.9c85.63 20.9 158.65 9.1 178.75 6.7 56.12-6.7 105-41.3 111.23-72.9 9.8-49.8 9-121.5 9-121.5m-75.12 125.2h-46.63v-114.2c0-49.7-64-51.6-64 6.9v62.5h-46.33V197c0-58.5-64-56.6-64-6.9v114.2H90.19c0-122.1-5.2-147.9 18.41-175 25.9-28.9 79.82-30.8 103.83 6.1l11.6 19.5 11.6-19.5c24.11-37.1 78.12-34.8 103.83-6.1 23.71 27.3 18.4 53 18.4 175z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://x.com/squidfunk" target="_blank" rel="noopener" title="x.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8l164.9-188.5L26.8 48h145.6l100.5 132.9zm-24.8 373.8h39.1L151.1 88h-42z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tabs", "toc.integrate", "content.code.copy", "content.code.select", "content.code.annotate", "content.tabs.link", "content.footnote.tooltips", "content.tooltips", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow", "announce.dismiss", "content.action.edit", "content.action.view", "content.code.annotate", "navigation.footer", "navigation.indexes", "navigation.sections", "navigation.tabs", "navigation.top", "navigation.expand", "search.share", "search.suggest"], "search": "../../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.56ea9cef.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/core-js/3.26.1/minified.min.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="../../../javascripts/mathjax.js"></script>
      
    
  <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body>
</html>

<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../dalle_series/">
      
      
        <link rel="next" href="../stable_diffusion_xl/">
      
      
      <link rel="icon" href="../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.49">
    
    
      
        <title>Overview - Generative AI: From Start to Surrender</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.6f8fc17f.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../stylesheets/extra.css">
    
      <link rel="stylesheet" href="https://unpkg.com/katex@0/dist/katex.min.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config",""),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
   <link href="../../../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../../../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#stable-diffusion-series" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="Generative AI: From Start to Surrender" class="md-header__button md-logo" aria-label="Generative AI: From Start to Surrender" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Generative AI: From Start to Surrender
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Overview
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1M8 13h8v-2H8zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4a5 5 0 0 0 5-5 5 5 0 0 0-5-5"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5M7 15a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../chapter1_Introduction/1.1terminology/" class="md-tabs__link">
          
  
    
  
  Introduction

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../chapter2_generation_theory/mle/" class="md-tabs__link">
          
  
    
  
  Generation Theory

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../chapter3_energy_based_model/introduction/" class="md-tabs__link">
          
  
    
  
  Energy Based Models

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../chapter6_VAE/vae_introduction/" class="md-tabs__link">
          
  
    
  
  VAE

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../chapter5_GAN/3.1from_gan_to_stylegan/paper/" class="md-tabs__link">
          
  
    
  
  GANs

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../chapter7_diffusion/ddpm/" class="md-tabs__link">
          
  
    
  
  Diffusion Models

        </a>
      </li>
    
  

    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../chapter9_flow_matching/introduction/" class="md-tabs__link">
          
  
    
  
  Flow Matching

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../hybrid_methods/" class="md-tabs__link">
          
  
    
  
  Hybrid SOTA Models

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="Generative AI: From Start to Surrender" class="md-nav__button md-logo" aria-label="Generative AI: From Start to Surrender" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Generative AI: From Start to Surrender
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Introduction
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter1_Introduction/1.1terminology/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Terms
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter1_Introduction/1.2fourier_transform/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fourier Transform
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter1_Introduction/1.3signal_processing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Signal Processing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter1_Introduction/1.4statistics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Statistics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter1_Introduction/tutorials/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tutorials
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Generation Theory
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Generation Theory
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter2_generation_theory/mle/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Maximal Likelihood
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter2_generation_theory/manifold_hypothesis/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Manifold Hypothesis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter2_generation_theory/generative_model_category/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Generative Model Category
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Energy Based Models
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Energy Based Models
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter3_energy_based_model/introduction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter3_energy_based_model/score_function/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Score Functions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter3_energy_based_model/sampling/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sampling Methods
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter3_energy_based_model/cd/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contrastive Divergence
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter3_energy_based_model/score_matching/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Score Matching
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    VAE
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            VAE
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter6_VAE/vae_introduction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter6_VAE/vq_vae/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    VA-VAE
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    GANs
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            GANs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter5_GAN/3.1from_gan_to_stylegan/paper/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    From GAN to StyleGAN
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6_2" >
        
          
          <label class="md-nav__link" for="__nav_6_2" id="__nav_6_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    StyleGAN Variants
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_2">
            <span class="md-nav__icon md-icon"></span>
            StyleGAN Variants
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter5_GAN/3.3stylegan/paper/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    StyleGAN
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter5_GAN/3.4stylegan2/paper/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    StyleGAN2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter5_GAN/3.5stylegan3/paper/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    StyleGAN3
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter5_GAN/3.6styleganT/paper/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    StyleGAN-T
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter5_GAN/3.7R3Gan/paper/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    R3GAN
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter5_GAN/vq_gan/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    VQ-GAN
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Diffusion Models
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Diffusion Models
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7_1" >
        
          
          <label class="md-nav__link" for="__nav_7_1" id="__nav_7_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Discrete Diffusion
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_1">
            <span class="md-nav__icon md-icon"></span>
            Discrete Diffusion
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter7_diffusion/ddpm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DDPM
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter7_diffusion/ldm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LDM
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter7_diffusion/ldm_handson/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LDM Handson
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter7_diffusion/diffusion_model_varients/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Diffusion Model Varients
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter7_diffusion/general_diffusion_model/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    General Diffusion Model
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7_2" >
        
          
          <label class="md-nav__link" for="__nav_7_2" id="__nav_7_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    SDE Diffusion
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_2">
            <span class="md-nav__icon md-icon"></span>
            SDE Diffusion
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter7_diffusion/introduction_sde/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SDE Fundamentals
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter7_diffusion/from_ddpm_2_sde/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SDE for DDPM
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter7_diffusion/score_based_sde/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Score Based SDE
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter7_diffusion/probability_flow_ode/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Probability Flow ODE
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter7_diffusion/sde_diffusion_speedup/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SDE Diffusion Speedup
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter7_diffusion/sde_diffusion_unified_representation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Scaling and Scheduling
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7_3" >
        
          
          <label class="md-nav__link" for="__nav_7_3" id="__nav_7_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Diffusion Network
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_3">
            <span class="md-nav__icon md-icon"></span>
            Diffusion Network
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter7_diffusion/DiT/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DiT
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7_4" >
        
          
          <label class="md-nav__link" for="__nav_7_4" id="__nav_7_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Diffusion Solver
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_4">
            <span class="md-nav__icon md-icon"></span>
            Diffusion Solver
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter7_diffusion/diffusion_solver/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DPM Solver
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7_5" >
        
          
          <label class="md-nav__link" for="__nav_7_5" id="__nav_7_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Conditional Diffusion
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_5">
            <span class="md-nav__icon md-icon"></span>
            Conditional Diffusion
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter7_diffusion/controlnet/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ControlNet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter7_diffusion/sde_diffusion_guidance/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SDE Diffusion Guidance
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Flow Matching
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Flow Matching
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter9_flow_matching/introduction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter9_flow_matching/probability_with_velocity_field/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Probability Path and Velocity Fields
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter9_flow_matching/flow_matching_theory/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Flow Matching Theorem
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter9_flow_matching/affine_conditional_flows/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Affine Conditional Flow
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter9_flow_matching/optimal_transport_flow/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Optimal Transport Flow
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="/book/chapter9_flow_matching/comparison_with_flow_ode.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Comparison with Diffusion Flow ODE
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" checked>
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Hybrid SOTA Models
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            Hybrid SOTA Models
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hybrid_methods/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hybrid Methods
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../sota_closed_models/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Closed Models
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_3" checked>
        
          
          <label class="md-nav__link" for="__nav_9_3" id="__nav_9_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Open Models
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_9_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_9_3">
            <span class="md-nav__icon md-icon"></span>
            Open Models
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dalle_series/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dalle Series
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_3_2" checked>
        
          
          <label class="md-nav__link" for="__nav_9_3_2" id="__nav_9_3_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Stable Diffusion Series
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_9_3_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_9_3_2">
            <span class="md-nav__icon md-icon"></span>
            Stable Diffusion Series
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Overview
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-vq-gan" class="md-nav__link">
    <span class="md-ellipsis">
      1. VQ-GAN
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-stable-diffusion-v0" class="md-nav__link">
    <span class="md-ellipsis">
      2. Stable Diffusion v0
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-stable-diffusion-v1" class="md-nav__link">
    <span class="md-ellipsis">
      3. Stable Diffusion v1
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. Stable Diffusion v1">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-summary" class="md-nav__link">
    <span class="md-ellipsis">
      3.1 Summary
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-difference-between-v0-and-v1" class="md-nav__link">
    <span class="md-ellipsis">
      3.2 Difference between v0 and v1
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33-dataset" class="md-nav__link">
    <span class="md-ellipsis">
      3.3 Dataset
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-stable-diffusion-v2" class="md-nav__link">
    <span class="md-ellipsis">
      4. Stable Diffusion v2
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. Stable Diffusion v2">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-summary" class="md-nav__link">
    <span class="md-ellipsis">
      4.1 Summary
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-differences-change-details" class="md-nav__link">
    <span class="md-ellipsis">
      4.2 Differences change details
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#43-other-types-of-conditions" class="md-nav__link">
    <span class="md-ellipsis">
      4.3 Other Types of Conditions
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-stable-diffusion-sdxl" class="md-nav__link">
    <span class="md-ellipsis">
      5. Stable Diffusion SDXL
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5. Stable Diffusion SDXL">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#51-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      5.1 Architecture
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-stable-diffusion-v3" class="md-nav__link">
    <span class="md-ellipsis">
      6. Stable Diffusion v3
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-stable-diffusion-v35" class="md-nav__link">
    <span class="md-ellipsis">
      7. Stable Diffusion v3.5
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../stable_diffusion_xl/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Stable Diffusion XL
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../stable_diffusion_3_reading/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Stable Diffusion 3
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../stable_diffusion_3_5_reading/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Stable Diffusion 3.5
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../flux1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Flux.1
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../trends_future/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Future Trends
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="stable-diffusion-series">Stable Diffusion Series<a class="headerlink" href="#stable-diffusion-series" title="Permanent link">&para;</a></h1>
<h2 id="1-vq-gan">1. VQ-GAN<a class="headerlink" href="#1-vq-gan" title="Permanent link">&para;</a></h2>
<ul>
<li>Year: 2020 Dec - 2022 Jan</li>
<li>Paper:</li>
<li><a href="https://compvis.github.io/taming-transformers/">Taming Transformers for High-Resolution Image Synthesis</a></li>
<li>Repo: <a href="https://github.com/CompVis/taming-transformers">taming-transformers</a></li>
<li>Organization: CompVis</li>
</ul>
<p>Please refer to <a href="../../../chapter5_GAN/vq_gan/">VQ-GAN</a> for more details.</p>
<h2 id="2-stable-diffusion-v0">2. Stable Diffusion v0<a class="headerlink" href="#2-stable-diffusion-v0" title="Permanent link">&para;</a></h2>
<ul>
<li>Year: Dec 2021 -Nov 2022</li>
<li>Paper: <a href="https://arxiv.org/abs/2112.10752">High-Resolution Image Synthesis with Latent Diffusion Models</a></li>
<li>Repo: <a href="https://github.com/CompVis/latent-diffusion"><a href="https://github.com/Stability-AI/stablediffusion?tab=readme-ov-file">https://github.com/Stability-AI/stablediffusion?tab=readme-ov-file</a></a></li>
<li>Organization: CompVis</li>
</ul>
<p>Please refer to <a href="../../../chapter7_diffusion/ldm/">LDM</a> for more details.</p>
<h2 id="3-stable-diffusion-v1">3. Stable Diffusion v1<a class="headerlink" href="#3-stable-diffusion-v1" title="Permanent link">&para;</a></h2>
<ul>
<li>Year</li>
<li>Ideas</li>
<li><a href="https://arxiv.org/abs/2112.10752">High-Resolution Image Synthesis with Latent Diffusion Models</a></li>
<li><a href="https://arxiv.org/pdf/2207.12598">Classifier-Free Guidance Sampling</a></li>
<li>Repo: <a href="https://github.com/CompVis/stable-diffusion/blob/main/Stable_Diffusion_v1_Model_Card.md">Stable_Diffusion_v1_Model_Card.md</a></li>
<li>Organization: CompVis</li>
</ul>
<h3 id="31-summary">3.1 Summary<a class="headerlink" href="#31-summary" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Architecture:</strong></li>
<li>A <em>latent diffusion model</em> that combines an autoencoder with a diffusion model operating in the autoencoder’s latent space.</li>
<li><strong>Image Encoding:</strong> Images are downsampled by a factor of 8, converting an image from shape H x W x 3 to a latent representation of shape H/8 x W/8 x 4.</li>
<li>
<p><strong>Text Conditioning:</strong> Uses a ViT-L/14 text encoder; its non-pooled output is integrated into the UNet backbone via cross-attention.</p>
</li>
<li>
<p><strong>Training Objective:</strong></p>
</li>
<li>
<p>The model is trained to reconstruct the noise added to the latent representations, essentially predicting the noise in the latent space.</p>
</li>
<li>
<p><strong>Training Data:</strong></p>
</li>
<li>
<p>Primarily trained on LAION-5B and various curated subsets, including:</p>
<ul>
<li><em>laion2B-en</em></li>
<li><em>laion-high-resolution</em> (for high-resolution images)</li>
<li><em>laion-aesthetics v2 5+</em> (filtered for aesthetics and watermark probability)</li>
</ul>
</li>
<li>
<p><strong>Checkpoints Overview:</strong></p>
</li>
<li><strong>sd-v1-1.ckpt:</strong><ul>
<li>237k steps at 256x256 resolution (laion2B-en)</li>
<li>194k steps at 512x512 resolution (laion-high-resolution)</li>
</ul>
</li>
<li><strong>sd-v1-2.ckpt:</strong><ul>
<li>Continued from v1-1; 515k steps at 512x512 using laion-aesthetics v2 5+ data.</li>
</ul>
</li>
<li>
<p><strong>sd-v1-3.ckpt &amp; sd-v1-4.ckpt:</strong></p>
<ul>
<li>Both resumed from v1-2 with additional 10% text-conditioning drop to improve classifier-free guidance sampling.</li>
</ul>
</li>
<li>
<p><strong>Training Setup:</strong></p>
</li>
<li><strong>Hardware:</strong> 32 x 8 x A100 GPUs</li>
<li><strong>Optimizer:</strong> AdamW</li>
<li><strong>Batch Details:</strong> Gradient accumulations and batch size set to a total of 2048 images per update</li>
<li><strong>Learning Rate:</strong> Warmup to 0.0001 over 10,000 steps, then kept constant</li>
</ul>
<h3 id="32-difference-between-v0-and-v1">3.2 Difference between v0 and v1<a class="headerlink" href="#32-difference-between-v0-and-v1" title="Permanent link">&para;</a></h3>
<p>The code is basically the same as Stable Diffusion v0, which is latent diffusion.</p>
<h3 id="33-dataset">3.3 Dataset<a class="headerlink" href="#33-dataset" title="Permanent link">&para;</a></h3>
<h4 id="331-laion-aesthetics-dataset-summary">3.3.1 LAION-Aesthetics Dataset Summary<a class="headerlink" href="#331-laion-aesthetics-dataset-summary" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Overview:</strong></li>
<li>A curated subset of the larger LAION image-text dataset that emphasizes high-quality, visually appealing images.</li>
<li>
<p>Utilizes a deep learning–based aesthetic predictor to assign scores reflecting the perceived visual quality of each image.</p>
</li>
<li>
<p><strong>Filtering Process:</strong></p>
</li>
<li><strong>Aesthetic Scoring:</strong> Images are evaluated with the LAION-Aesthetics Predictor, and only those exceeding a certain score threshold (e.g., &gt;5.0) are selected.</li>
<li>
<p><strong>Additional Filters:</strong></p>
<ul>
<li>Ensures images have a minimum resolution (original size ≥ 512×512).</li>
<li>Applies a watermark probability filter to exclude images with a high likelihood of watermarks.</li>
</ul>
</li>
<li>
<p><strong>Purpose and Applications:</strong></p>
</li>
<li>Designed to serve as high-quality training data for generative models, such as Stable Diffusion.</li>
<li>Aims to improve the aesthetic quality of generated images by providing models with visually appealing training examples.</li>
</ul>
<p>This dataset provided a smaller dataset with higher aesthetics scores, so that it may be used to fine-tune a model.</p>
<ul>
<li>1,2B image-text pairs with predicted aesthetics scores of 4.5 or higher: <a href="https://huggingface.co/datasets/ChristophSchuhmann/improved_aesthetics_4.5plus">huggingface</a></li>
<li>939M image-text pairs with predicted aesthetics scores of 4.75 or higher: <a href="https://huggingface.co/datasets/ChristophSchuhmann/improved_aesthetics_4.75plus">huggingface</a></li>
<li>600M image-text pairs with predicted aesthetics scores of 5 or higher: <a href="https://huggingface.co/datasets/ChristophSchuhmann/improved_aesthetics_5">huggingface</a></li>
<li>12M image-text pairs with predicted aesthetics scores of 6 or higher: <a href="https://huggingface.co/datasets/ChristophSchuhmann/improved_aesthetics_6">huggingface</a></li>
<li>3M image-text pairs with predicted aesthetics scores of 6.25 or higher: <a href="https://huggingface.co/datasets/ChristophSchuhmann/improved_aesthetics_6.25">huggingface</a></li>
<li>625K image-text pairs with predicted aesthetics scores of 6.5 or higher: <a href="https://huggingface.co/datasets/ChristophSchuhmann/improved_aesthetics_6.5">huggingface</a></li>
</ul>
<h4 id="332-laion-5b-dataset">3.3.2 LAION-5B Dataset<a class="headerlink" href="#332-laion-5b-dataset" title="Permanent link">&para;</a></h4>
<ul>
<li>Massive Scale: Contains around 5 billion image-text pairs scraped from the internet.</li>
<li>Diversity: Offers a broad spectrum of visual content and associated textual descriptions.</li>
<li>Purpose: Designed to power large-scale machine learning and generative models, ensuring rich semantic variety.</li>
<li>Open Access: Available for research and development, promoting transparency and innovation in</li>
<li>Total size: 12 TB</li>
</ul>
<h2 id="4-stable-diffusion-v2">4. Stable Diffusion v2<a class="headerlink" href="#4-stable-diffusion-v2" title="Permanent link">&para;</a></h2>
<ul>
<li>Year: Dec 2021 -Nov 2022</li>
<li>Ideas:</li>
<li>/<a href="https://arxiv.org/pdf/2204.06125">https://arxiv.org/pdf/2204.06125</a></li>
<li><a href="https://arxiv.org/pdf/2202.00512">https://arxiv.org/pdf/2202.00512</a></li>
<li>repo: <a href="https://github.com/Stability-AI/stablediffusion?tab=readme-ov-file">https://github.com/Stability-AI/stablediffusion?tab=readme-ov-file</a></li>
<li>organization: Stability-AI</li>
</ul>
<h3 id="41-summary">4.1 Summary<a class="headerlink" href="#41-summary" title="Permanent link">&para;</a></h3>
<p>Generated Image
<a class="glightbox" href="../../../../images/image-57.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="../../../../images/image-57.png" /></a>
<a class="glightbox" href="../../../../images/Unknown.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="../../../../images/Unknown.png" /></a>
Unchanged</p>
<ol>
<li>VAE structure</li>
<li>Latent Diffusions Structure (text condition embedding changes)</li>
<li>Basic DDPM sampling (it has extra progressive sampling method)</li>
</ol>
<p>The base model is still the latent diffusion. The main differences are:</p>
<ol>
<li>Resolution. The original model is 512x512, we use 768x768 in the future.</li>
<li>Use the idea of progressive distillation for fast sampling</li>
<li>Use clip guided for text2image sampling</li>
</ol>
<h3 id="42-differences-change-details">4.2 Differences change details<a class="headerlink" href="#42-differences-change-details" title="Permanent link">&para;</a></h3>
<blockquote>
<p>The code is still based on the original LDM repo</p>
</blockquote>
<h4 id="421-latentdiffusion-with-condition-processing">4.2.1 LatentDiffusion with condition processing<a class="headerlink" href="#421-latentdiffusion-with-condition-processing" title="Permanent link">&para;</a></h4>
<h4 id="422-image-embedding-condition">4.2.2 Image Embedding Condition<a class="headerlink" href="#422-image-embedding-condition" title="Permanent link">&para;</a></h4>
<p>This used the image embedding as the condition to guide the generation</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">ImageEmbeddingConditionedLatentDiffusion</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-0-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-0-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-0-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-0-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-0-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-0-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-0-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-0-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-0-10">10</a></span>
<span class="normal"><a href="#__codelineno-0-11">11</a></span>
<span class="normal"><a href="#__codelineno-0-12">12</a></span>
<span class="normal"><a href="#__codelineno-0-13">13</a></span>
<span class="normal"><a href="#__codelineno-0-14">14</a></span>
<span class="normal"><a href="#__codelineno-0-15">15</a></span>
<span class="normal"><a href="#__codelineno-0-16">16</a></span>
<span class="normal"><a href="#__codelineno-0-17">17</a></span>
<span class="normal"><a href="#__codelineno-0-18">18</a></span>
<span class="normal"><a href="#__codelineno-0-19">19</a></span>
<span class="normal"><a href="#__codelineno-0-20">20</a></span>
<span class="normal"><a href="#__codelineno-0-21">21</a></span>
<span class="normal"><a href="#__codelineno-0-22">22</a></span>
<span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="k">class</span> <span class="nc">ImageEmbeddingConditionedLatentDiffusion</span><span class="p">(</span><span class="n">LatentDiffusion</span><span class="p">):</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">embedder_config</span><span class="p">,</span> <span class="n">embedding_key</span><span class="o">=</span><span class="s2">&quot;jpg&quot;</span><span class="p">,</span> <span class="n">embedding_dropout</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>                 <span class="n">freeze_embedder</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">noise_aug_config</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">embed_key</span> <span class="o">=</span> <span class="n">embedding_key</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">embedding_dropout</span> <span class="o">=</span> <span class="n">embedding_dropout</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_init_embedder</span><span class="p">(</span><span class="n">embedder_config</span><span class="p">,</span> <span class="n">freeze_embedder</span><span class="p">)</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_init_noise_aug</span><span class="p">(</span><span class="n">noise_aug_config</span><span class="p">)</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a>    <span class="k">def</span> <span class="nf">_init_embedder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">freeze</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a>        <span class="n">embedder</span> <span class="o">=</span> <span class="n">instantiate_from_config</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a>        <span class="k">if</span> <span class="n">freeze</span><span class="p">:</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">embedder</span> <span class="o">=</span> <span class="n">embedder</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">embedder</span><span class="o">.</span><span class="n">train</span> <span class="o">=</span> <span class="n">disabled_train</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a>            <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">embedder</span><span class="o">.</span><span class="n">parameters</span><span class="p">():</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a>                <span class="n">param</span><span class="o">.</span><span class="n">requires_grad</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a>    <span class="k">def</span> <span class="nf">_init_noise_aug</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">):</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>        <span class="k">if</span> <span class="n">config</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>            <span class="c1"># use the KARLO schedule for noise augmentation on CLIP image embeddings</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>            <span class="n">noise_augmentor</span> <span class="o">=</span> <span class="n">instantiate_from_config</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">noise_augmentor</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">)</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>            <span class="n">noise_augmentor</span> <span class="o">=</span> <span class="n">noise_augmentor</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>            <span class="n">noise_augmentor</span><span class="o">.</span><span class="n">train</span> <span class="o">=</span> <span class="n">disabled_train</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">noise_augmentor</span> <span class="o">=</span> <span class="n">noise_augmentor</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">noise_augmentor</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a>    <span class="k">def</span> <span class="nf">get_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">cond_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>        <span class="n">outputs</span> <span class="o">=</span> <span class="n">LatentDiffusion</span><span class="o">.</span><span class="n">get_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">bs</span><span class="o">=</span><span class="n">bs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>        <span class="n">z</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">outputs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">outputs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>        <span class="n">img</span> <span class="o">=</span> <span class="n">batch</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">embed_key</span><span class="p">][:</span><span class="n">bs</span><span class="p">]</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a>        <span class="n">img</span> <span class="o">=</span> <span class="n">rearrange</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="s1">&#39;b h w c -&gt; b c h w&#39;</span><span class="p">)</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>        <span class="n">c_adm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">embedder</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise_augmentor</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>            <span class="n">c_adm</span><span class="p">,</span> <span class="n">noise_level_emb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise_augmentor</span><span class="p">(</span><span class="n">c_adm</span><span class="p">)</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>            <span class="c1"># assume this gives embeddings of noise levels</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>            <span class="n">c_adm</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">((</span><span class="n">c_adm</span><span class="p">,</span> <span class="n">noise_level_emb</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">training</span><span class="p">:</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>            <span class="n">c_adm</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">bernoulli</span><span class="p">((</span><span class="mf">1.</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">embedding_dropout</span><span class="p">)</span> <span class="o">*</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">c_adm</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>                                                                               <span class="n">device</span><span class="o">=</span><span class="n">c_adm</span><span class="o">.</span><span class="n">device</span><span class="p">)[:,</span> <span class="kc">None</span><span class="p">])</span> <span class="o">*</span> <span class="n">c_adm</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>        <span class="n">all_conds</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;c_crossattn&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">c</span><span class="p">],</span> <span class="s2">&quot;c_adm&quot;</span><span class="p">:</span> <span class="n">c_adm</span><span class="p">}</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>        <span class="n">noutputs</span> <span class="o">=</span> <span class="p">[</span><span class="n">z</span><span class="p">,</span> <span class="n">all_conds</span><span class="p">]</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>        <span class="n">noutputs</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">outputs</span><span class="p">[</span><span class="mi">2</span><span class="p">:])</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>        <span class="k">return</span> <span class="n">noutputs</span>
</code></pre></div></td></tr></table></div>
<p>Compared with previous LDM, it added another variable <code>c_adm</code> for the clip image embedding of the images. Please see <a href="../dalle_series/">unCLIP</a> for the details on taking CLIP image embedding as condition.</p>
<p>Refer to the code explanation of latent diffusion model <a href="../../../chapter7_diffusion/ldm_handson/">Latent Diffusion Model</a>, the <code>c_adm</code> is assigned to <code>y</code> and later will be added into the time embedding.</p>
<p>It also takes the embedding dropout such that the model is trained both with image embedding or not.</p>
<h4 id="423-v-prediction">4.2.3 v-prediction<a class="headerlink" href="#423-v-prediction" title="Permanent link">&para;</a></h4>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">get_v</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-1-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-1-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-1-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-1-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-1-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-1-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-1-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-1-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-1-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-1-10">10</a></span>
<span class="normal"><a href="#__codelineno-1-11">11</a></span>
<span class="normal"><a href="#__codelineno-1-12">12</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1"></a><span class="k">def</span> <span class="nf">get_v</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">noise</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
<a id="__codelineno-1-2" name="__codelineno-1-2"></a>    <span class="k">return</span> <span class="p">(</span>
<a id="__codelineno-1-3" name="__codelineno-1-3"></a>            <span class="n">extract_into_tensor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sqrt_alphas_cumprod</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">*</span> <span class="n">noise</span> <span class="o">-</span>
<a id="__codelineno-1-4" name="__codelineno-1-4"></a>            <span class="n">extract_into_tensor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sqrt_one_minus_alphas_cumprod</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">*</span> <span class="n">x</span>
<a id="__codelineno-1-5" name="__codelineno-1-5"></a>    <span class="p">)</span>
<a id="__codelineno-1-6" name="__codelineno-1-6"></a>
<a id="__codelineno-1-7" name="__codelineno-1-7"></a><span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameterization</span> <span class="o">==</span> <span class="s2">&quot;x0&quot;</span><span class="p">:</span>
<a id="__codelineno-1-8" name="__codelineno-1-8"></a>    <span class="n">target</span> <span class="o">=</span> <span class="n">x_start</span>
<a id="__codelineno-1-9" name="__codelineno-1-9"></a><span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameterization</span> <span class="o">==</span> <span class="s2">&quot;eps&quot;</span><span class="p">:</span>
<a id="__codelineno-1-10" name="__codelineno-1-10"></a>    <span class="n">target</span> <span class="o">=</span> <span class="n">noise</span>
<a id="__codelineno-1-11" name="__codelineno-1-11"></a><span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameterization</span> <span class="o">==</span> <span class="s2">&quot;v&quot;</span><span class="p">:</span>
<a id="__codelineno-1-12" name="__codelineno-1-12"></a>    <span class="n">target</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_v</span><span class="p">(</span><span class="n">x_start</span><span class="p">,</span> <span class="n">noise</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p>In many diffusion models, the forward process is defined as:</p>
<div class="arithmatex">\[
 x_t = \sqrt{\bar{\alpha}_t}\, x_0 + \sqrt{1 - \bar{\alpha}_t}\, \varepsilon, \quad \varepsilon \sim \mathcal{N}(0, I)
\]</div>
<p>For v-prediction, we reparameterize the process by defining a new variable <span class="arithmatex">\(v\)</span> as:</p>
<div class="arithmatex">\[
 v = \sqrt{\bar{\alpha}_t}\, \varepsilon - \sqrt{1 - \bar{\alpha}_t}\, x_0
\]</div>
<p>This formulation offers certain benefits in terms of training stability and sample quality. With <span class="arithmatex">\(v\)</span> predicted by the model, one can later recover either the noise <span class="arithmatex">\(\varepsilon\)</span> or the original image <span class="arithmatex">\(x_0\)</span> via:</p>
<ul>
<li>Recovering <span class="arithmatex">\(x_0\)</span>:</li>
</ul>
<div class="arithmatex">\[
x_0 = \sqrt{\bar{\alpha}_t}\, x_t - \sqrt{1 - \bar{\alpha}_t}\, v
\]</div>
<ul>
<li>Recovering <span class="arithmatex">\(\varepsilon\)</span>:</li>
</ul>
<div class="arithmatex">\[
 \varepsilon = \sqrt{1 - \bar{\alpha}_t}\, x_t + \sqrt{\bar{\alpha}_t}\, v
\]</div>
<p>Different</p>
<h3 id="43-other-types-of-conditions">4.3 Other Types of Conditions<a class="headerlink" href="#43-other-types-of-conditions" title="Permanent link">&para;</a></h3>
<p>In the main latent diffusion condition process block, all the concat conditions will follow the process</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">concat condition processing</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-2-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-2-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-2-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-2-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-2-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-2-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-2-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-2-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-2-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-2-10">10</a></span>
<span class="normal"><a href="#__codelineno-2-11">11</a></span>
<span class="normal"><a href="#__codelineno-2-12">12</a></span>
<span class="normal"><a href="#__codelineno-2-13">13</a></span>
<span class="normal"><a href="#__codelineno-2-14">14</a></span>
<span class="normal"><a href="#__codelineno-2-15">15</a></span>
<span class="normal"><a href="#__codelineno-2-16">16</a></span>
<span class="normal"><a href="#__codelineno-2-17">17</a></span>
<span class="normal"><a href="#__codelineno-2-18">18</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1"></a>        <span class="k">assert</span> <span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">concat_keys</span><span class="p">)</span>
<a id="__codelineno-2-2" name="__codelineno-2-2"></a>        <span class="n">c_cat</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
<a id="__codelineno-2-3" name="__codelineno-2-3"></a>        <span class="k">for</span> <span class="n">ck</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">concat_keys</span><span class="p">:</span>
<a id="__codelineno-2-4" name="__codelineno-2-4"></a>            <span class="n">cc</span> <span class="o">=</span> <span class="n">rearrange</span><span class="p">(</span><span class="n">batch</span><span class="p">[</span><span class="n">ck</span><span class="p">],</span> <span class="s1">&#39;b h w c -&gt; b c h w&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">memory_format</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">contiguous_format</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span>
<a id="__codelineno-2-5" name="__codelineno-2-5"></a>            <span class="k">if</span> <span class="n">bs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-2-6" name="__codelineno-2-6"></a>                <span class="n">cc</span> <span class="o">=</span> <span class="n">cc</span><span class="p">[:</span><span class="n">bs</span><span class="p">]</span>
<a id="__codelineno-2-7" name="__codelineno-2-7"></a>                <span class="n">cc</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
<a id="__codelineno-2-8" name="__codelineno-2-8"></a>            <span class="n">bchw</span> <span class="o">=</span> <span class="n">z</span><span class="o">.</span><span class="n">shape</span>
<a id="__codelineno-2-9" name="__codelineno-2-9"></a>            <span class="k">if</span> <span class="n">ck</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">masked_image_key</span><span class="p">:</span>
<a id="__codelineno-2-10" name="__codelineno-2-10"></a>                <span class="n">cc</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">functional</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">cc</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">bchw</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:])</span>
<a id="__codelineno-2-11" name="__codelineno-2-11"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-2-12" name="__codelineno-2-12"></a>                <span class="n">cc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_first_stage_encoding</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encode_first_stage</span><span class="p">(</span><span class="n">cc</span><span class="p">))</span>
<a id="__codelineno-2-13" name="__codelineno-2-13"></a>            <span class="n">c_cat</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
<a id="__codelineno-2-14" name="__codelineno-2-14"></a>        <span class="n">c_cat</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span><span class="n">c_cat</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-2-15" name="__codelineno-2-15"></a>        <span class="n">all_conds</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;c_concat&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">c_cat</span><span class="p">],</span> <span class="s2">&quot;c_crossattn&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">c</span><span class="p">]}</span>
<a id="__codelineno-2-16" name="__codelineno-2-16"></a>        <span class="k">if</span> <span class="n">return_first_stage_outputs</span><span class="p">:</span>
<a id="__codelineno-2-17" name="__codelineno-2-17"></a>            <span class="k">return</span> <span class="n">z</span><span class="p">,</span> <span class="n">all_conds</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">xrec</span><span class="p">,</span> <span class="n">xc</span>
<a id="__codelineno-2-18" name="__codelineno-2-18"></a>        <span class="k">return</span> <span class="n">z</span><span class="p">,</span> <span class="n">all_conds</span>
</code></pre></div></td></tr></table></div>
<p>If the concat condition is not of the same shape, it will be interpolated into the same shape with the image shape.
Recall the steps in the Latent Diffusion forward step, the concat condition will be concatenated together with the input <span class="arithmatex">\(z\)</span> as the start of the diffusion model.</p>
<h4 id="431-low-resolution-condition">4.3.1 Low resolution condition<a class="headerlink" href="#431-low-resolution-condition" title="Permanent link">&para;</a></h4>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">LatentUpscaleDiffusion</label><label for="__tabbed_1_2">LatentUpscaleFinetuneDiffusion</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">LatentUpscaleDiffusion</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-3-1">1</a></span>
<span class="normal"><a href="#__codelineno-3-2">2</a></span>
<span class="normal"><a href="#__codelineno-3-3">3</a></span>
<span class="normal"><a href="#__codelineno-3-4">4</a></span>
<span class="normal"><a href="#__codelineno-3-5">5</a></span>
<span class="normal"><a href="#__codelineno-3-6">6</a></span>
<span class="normal"><a href="#__codelineno-3-7">7</a></span>
<span class="normal"><a href="#__codelineno-3-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1"></a>        <span class="n">x_low</span> <span class="o">=</span> <span class="n">batch</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">low_scale_key</span><span class="p">][:</span><span class="n">bs</span><span class="p">]</span>
<a id="__codelineno-3-2" name="__codelineno-3-2"></a>        <span class="n">x_low</span> <span class="o">=</span> <span class="n">rearrange</span><span class="p">(</span><span class="n">x_low</span><span class="p">,</span> <span class="s1">&#39;b h w c -&gt; b c h w&#39;</span><span class="p">)</span>
<a id="__codelineno-3-3" name="__codelineno-3-3"></a>        <span class="n">x_low</span> <span class="o">=</span> <span class="n">x_low</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">memory_format</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">contiguous_format</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span>
<a id="__codelineno-3-4" name="__codelineno-3-4"></a>        <span class="n">zx</span><span class="p">,</span> <span class="n">noise_level</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">low_scale_model</span><span class="p">(</span><span class="n">x_low</span><span class="p">)</span>
<a id="__codelineno-3-5" name="__codelineno-3-5"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise_level_key</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-3-6" name="__codelineno-3-6"></a>            <span class="c1"># get noise level from batch instead, e.g. when extracting a custom noise level for bsr</span>
<a id="__codelineno-3-7" name="__codelineno-3-7"></a>            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;TODO&#39;</span><span class="p">)</span>
<a id="__codelineno-3-8" name="__codelineno-3-8"></a>        <span class="n">all_conds</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;c_concat&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">zx</span><span class="p">],</span> <span class="s2">&quot;c_crossattn&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">c</span><span class="p">],</span> <span class="s2">&quot;c_adm&quot;</span><span class="p">:</span> <span class="n">noise_level</span><span class="p">}</span>
</code></pre></div></td></tr></table></div>
</div>
<div class="tabbed-block">
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Low Res Condition</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-4-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-4-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-4-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-4-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-4-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-4-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-4-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-4-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-4-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-4-10">10</a></span>
<span class="normal"><a href="#__codelineno-4-11">11</a></span>
<span class="normal"><a href="#__codelineno-4-12">12</a></span>
<span class="normal"><a href="#__codelineno-4-13">13</a></span>
<span class="normal"><a href="#__codelineno-4-14">14</a></span>
<span class="normal"><a href="#__codelineno-4-15">15</a></span>
<span class="normal"><a href="#__codelineno-4-16">16</a></span>
<span class="normal"><a href="#__codelineno-4-17">17</a></span>
<span class="normal"><a href="#__codelineno-4-18">18</a></span>
<span class="normal"><a href="#__codelineno-4-19">19</a></span>
<span class="normal"><a href="#__codelineno-4-20">20</a></span>
<span class="normal"><a href="#__codelineno-4-21">21</a></span>
<span class="normal"><a href="#__codelineno-4-22">22</a></span>
<span class="normal"><a href="#__codelineno-4-23">23</a></span>
<span class="normal"><a href="#__codelineno-4-24">24</a></span>
<span class="normal"><a href="#__codelineno-4-25">25</a></span>
<span class="normal"><a href="#__codelineno-4-26">26</a></span>
<span class="normal"><a href="#__codelineno-4-27">27</a></span>
<span class="normal"><a href="#__codelineno-4-28">28</a></span>
<span class="normal"><a href="#__codelineno-4-29">29</a></span>
<span class="normal"><a href="#__codelineno-4-30">30</a></span>
<span class="normal"><a href="#__codelineno-4-31">31</a></span>
<span class="normal"><a href="#__codelineno-4-32">32</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1"></a>    <span class="nd">@torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">()</span>
<a id="__codelineno-4-2" name="__codelineno-4-2"></a>    <span class="k">def</span> <span class="nf">get_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">cond_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">return_first_stage_outputs</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<a id="__codelineno-4-3" name="__codelineno-4-3"></a>        <span class="c1"># note: restricted to non-trainable encoders currently</span>
<a id="__codelineno-4-4" name="__codelineno-4-4"></a>        <span class="k">assert</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">cond_stage_trainable</span><span class="p">,</span> <span class="s1">&#39;trainable cond stages not yet supported for upscaling-ft&#39;</span>
<a id="__codelineno-4-5" name="__codelineno-4-5"></a>        <span class="n">z</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">xrec</span><span class="p">,</span> <span class="n">xc</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_input</span><span class="p">(</span><span class="n">batch</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">first_stage_key</span><span class="p">,</span> <span class="n">return_first_stage_outputs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-4-6" name="__codelineno-4-6"></a>                                              <span class="n">force_c_encode</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_original_cond</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bs</span><span class="o">=</span><span class="n">bs</span><span class="p">)</span>
<a id="__codelineno-4-7" name="__codelineno-4-7"></a>        <span class="k">assert</span> <span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">concat_keys</span><span class="p">)</span>
<a id="__codelineno-4-8" name="__codelineno-4-8"></a>        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">concat_keys</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
<a id="__codelineno-4-9" name="__codelineno-4-9"></a>        <span class="c1"># optionally make spatial noise_level here</span>
<a id="__codelineno-4-10" name="__codelineno-4-10"></a>        <span class="n">c_cat</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
<a id="__codelineno-4-11" name="__codelineno-4-11"></a>        <span class="n">noise_level</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-4-12" name="__codelineno-4-12"></a>        <span class="k">for</span> <span class="n">ck</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">concat_keys</span><span class="p">:</span>
<a id="__codelineno-4-13" name="__codelineno-4-13"></a>            <span class="n">cc</span> <span class="o">=</span> <span class="n">batch</span><span class="p">[</span><span class="n">ck</span><span class="p">]</span>
<a id="__codelineno-4-14" name="__codelineno-4-14"></a>            <span class="n">cc</span> <span class="o">=</span> <span class="n">rearrange</span><span class="p">(</span><span class="n">cc</span><span class="p">,</span> <span class="s1">&#39;b h w c -&gt; b c h w&#39;</span><span class="p">)</span>
<a id="__codelineno-4-15" name="__codelineno-4-15"></a>            <span class="k">if</span> <span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reshuffle_patch_size</span><span class="p">):</span>
<a id="__codelineno-4-16" name="__codelineno-4-16"></a>                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reshuffle_patch_size</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
<a id="__codelineno-4-17" name="__codelineno-4-17"></a>                <span class="n">cc</span> <span class="o">=</span> <span class="n">rearrange</span><span class="p">(</span><span class="n">cc</span><span class="p">,</span> <span class="s1">&#39;b c (p1 h) (p2 w) -&gt; b (p1 p2 c) h w&#39;</span><span class="p">,</span>
<a id="__codelineno-4-18" name="__codelineno-4-18"></a>                              <span class="n">p1</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">reshuffle_patch_size</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">reshuffle_patch_size</span><span class="p">)</span>
<a id="__codelineno-4-19" name="__codelineno-4-19"></a>            <span class="k">if</span> <span class="n">bs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-4-20" name="__codelineno-4-20"></a>                <span class="n">cc</span> <span class="o">=</span> <span class="n">cc</span><span class="p">[:</span><span class="n">bs</span><span class="p">]</span>
<a id="__codelineno-4-21" name="__codelineno-4-21"></a>                <span class="n">cc</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
<a id="__codelineno-4-22" name="__codelineno-4-22"></a>            <span class="k">if</span> <span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">low_scale_model</span><span class="p">)</span> <span class="ow">and</span> <span class="n">ck</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">low_scale_key</span><span class="p">:</span>
<a id="__codelineno-4-23" name="__codelineno-4-23"></a>                <span class="n">cc</span><span class="p">,</span> <span class="n">noise_level</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">low_scale_model</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
<a id="__codelineno-4-24" name="__codelineno-4-24"></a>            <span class="n">c_cat</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
<a id="__codelineno-4-25" name="__codelineno-4-25"></a>        <span class="n">c_cat</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span><span class="n">c_cat</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-4-26" name="__codelineno-4-26"></a>        <span class="k">if</span> <span class="n">exists</span><span class="p">(</span><span class="n">noise_level</span><span class="p">):</span>
<a id="__codelineno-4-27" name="__codelineno-4-27"></a>            <span class="n">all_conds</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;c_concat&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">c_cat</span><span class="p">],</span> <span class="s2">&quot;c_crossattn&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">c</span><span class="p">],</span> <span class="s2">&quot;c_adm&quot;</span><span class="p">:</span> <span class="n">noise_level</span><span class="p">}</span>
<a id="__codelineno-4-28" name="__codelineno-4-28"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-4-29" name="__codelineno-4-29"></a>            <span class="n">all_conds</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;c_concat&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">c_cat</span><span class="p">],</span> <span class="s2">&quot;c_crossattn&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">c</span><span class="p">]}</span>
<a id="__codelineno-4-30" name="__codelineno-4-30"></a>        <span class="k">if</span> <span class="n">return_first_stage_outputs</span><span class="p">:</span>
<a id="__codelineno-4-31" name="__codelineno-4-31"></a>            <span class="k">return</span> <span class="n">z</span><span class="p">,</span> <span class="n">all_conds</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">xrec</span><span class="p">,</span> <span class="n">xc</span>
<a id="__codelineno-4-32" name="__codelineno-4-32"></a>        <span class="k">return</span> <span class="n">z</span><span class="p">,</span> <span class="n">all_conds</span>
</code></pre></div></td></tr></table></div>
</div>
</div>
</div>
<p>The low resolution condition is considered as the concat condition and will later be concatenated with the input <span class="arithmatex">\(z\)</span>. Also, the condition is combined with noise to match the diffusion steps in case it provides too much clear information for the model.</p>
<h4 id="432-depth-condition">4.3.2 Depth Condition<a class="headerlink" href="#432-depth-condition" title="Permanent link">&para;</a></h4>
<p>The MiDaSInference module is used for predicting depth information from a single RGB image, using the MiDaS model. The MiDaS model is a monocular depth estimation model, which is trained on multiple datasets and has strong cross-domain generalization capabilities. It can generate relative depth maps for images, which are commonly used in 3D reconstruction, augmented reality, and other computer vision tasks. For more details, refer to the open-source implementation of the project.</p>
<p>With the help from the MiDaSInference, we can convert the image into depth, thus used in the diffusion model to train depth2image model.</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">depth condition</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-5-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-5-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-5-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-5-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-5-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-5-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-5-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-5-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-5-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-5-10">10</a></span>
<span class="normal"><a href="#__codelineno-5-11">11</a></span>
<span class="normal"><a href="#__codelineno-5-12">12</a></span>
<span class="normal"><a href="#__codelineno-5-13">13</a></span>
<span class="normal"><a href="#__codelineno-5-14">14</a></span>
<span class="normal"><a href="#__codelineno-5-15">15</a></span>
<span class="normal"><a href="#__codelineno-5-16">16</a></span>
<span class="normal"><a href="#__codelineno-5-17">17</a></span>
<span class="normal"><a href="#__codelineno-5-18">18</a></span>
<span class="normal"><a href="#__codelineno-5-19">19</a></span>
<span class="normal"><a href="#__codelineno-5-20">20</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1"></a>        <span class="n">c_cat</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
<a id="__codelineno-5-2" name="__codelineno-5-2"></a>        <span class="k">for</span> <span class="n">ck</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">concat_keys</span><span class="p">:</span>
<a id="__codelineno-5-3" name="__codelineno-5-3"></a>            <span class="n">cc</span> <span class="o">=</span> <span class="n">batch</span><span class="p">[</span><span class="n">ck</span><span class="p">]</span>
<a id="__codelineno-5-4" name="__codelineno-5-4"></a>            <span class="k">if</span> <span class="n">bs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-5-5" name="__codelineno-5-5"></a>                <span class="n">cc</span> <span class="o">=</span> <span class="n">cc</span><span class="p">[:</span><span class="n">bs</span><span class="p">]</span>
<a id="__codelineno-5-6" name="__codelineno-5-6"></a>                <span class="n">cc</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
<a id="__codelineno-5-7" name="__codelineno-5-7"></a>            <span class="n">cc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">depth_model</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
<a id="__codelineno-5-8" name="__codelineno-5-8"></a>            <span class="n">cc</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">functional</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span>
<a id="__codelineno-5-9" name="__codelineno-5-9"></a>                <span class="n">cc</span><span class="p">,</span>
<a id="__codelineno-5-10" name="__codelineno-5-10"></a>                <span class="n">size</span><span class="o">=</span><span class="n">z</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">:],</span>
<a id="__codelineno-5-11" name="__codelineno-5-11"></a>                <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;bicubic&quot;</span><span class="p">,</span>
<a id="__codelineno-5-12" name="__codelineno-5-12"></a>                <span class="n">align_corners</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-5-13" name="__codelineno-5-13"></a>            <span class="p">)</span>
<a id="__codelineno-5-14" name="__codelineno-5-14"></a>
<a id="__codelineno-5-15" name="__codelineno-5-15"></a>            <span class="n">depth_min</span><span class="p">,</span> <span class="n">depth_max</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">amin</span><span class="p">(</span><span class="n">cc</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">keepdim</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="n">torch</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">cc</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
<a id="__codelineno-5-16" name="__codelineno-5-16"></a>                                                                                           <span class="n">keepdim</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-5-17" name="__codelineno-5-17"></a>            <span class="n">cc</span> <span class="o">=</span> <span class="mf">2.</span> <span class="o">*</span> <span class="p">(</span><span class="n">cc</span> <span class="o">-</span> <span class="n">depth_min</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">depth_max</span> <span class="o">-</span> <span class="n">depth_min</span> <span class="o">+</span> <span class="mf">0.001</span><span class="p">)</span> <span class="o">-</span> <span class="mf">1.</span>
<a id="__codelineno-5-18" name="__codelineno-5-18"></a>            <span class="n">c_cat</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
<a id="__codelineno-5-19" name="__codelineno-5-19"></a>        <span class="n">c_cat</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span><span class="n">c_cat</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-5-20" name="__codelineno-5-20"></a>        <span class="n">all_conds</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;c_concat&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">c_cat</span><span class="p">],</span> <span class="s2">&quot;c_crossattn&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">c</span><span class="p">]}</span>
</code></pre></div></td></tr></table></div>
<p>It processes the condition the same way as the low-res condition</p>
<h4 id="433-inpaint-condition">4.3.3 Inpaint Condition<a class="headerlink" href="#433-inpaint-condition" title="Permanent link">&para;</a></h4>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Inpaint Condition</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-6-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-6-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-6-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-6-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-6-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-6-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-6-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-6-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-6-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-6-10">10</a></span>
<span class="normal"><a href="#__codelineno-6-11">11</a></span>
<span class="normal"><a href="#__codelineno-6-12">12</a></span>
<span class="normal"><a href="#__codelineno-6-13">13</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1"></a>        <span class="n">c_cat</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
<a id="__codelineno-6-2" name="__codelineno-6-2"></a>        <span class="k">for</span> <span class="n">ck</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">concat_keys</span><span class="p">:</span>
<a id="__codelineno-6-3" name="__codelineno-6-3"></a>            <span class="n">cc</span> <span class="o">=</span> <span class="n">rearrange</span><span class="p">(</span><span class="n">batch</span><span class="p">[</span><span class="n">ck</span><span class="p">],</span> <span class="s1">&#39;b h w c -&gt; b c h w&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">memory_format</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">contiguous_format</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span>
<a id="__codelineno-6-4" name="__codelineno-6-4"></a>            <span class="k">if</span> <span class="n">bs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-6-5" name="__codelineno-6-5"></a>                <span class="n">cc</span> <span class="o">=</span> <span class="n">cc</span><span class="p">[:</span><span class="n">bs</span><span class="p">]</span>
<a id="__codelineno-6-6" name="__codelineno-6-6"></a>                <span class="n">cc</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
<a id="__codelineno-6-7" name="__codelineno-6-7"></a>            <span class="n">bchw</span> <span class="o">=</span> <span class="n">z</span><span class="o">.</span><span class="n">shape</span>
<a id="__codelineno-6-8" name="__codelineno-6-8"></a>            <span class="k">if</span> <span class="n">ck</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">masked_image_key</span><span class="p">:</span>
<a id="__codelineno-6-9" name="__codelineno-6-9"></a>                <span class="n">cc</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">functional</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">cc</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">bchw</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:])</span>
<a id="__codelineno-6-10" name="__codelineno-6-10"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-6-11" name="__codelineno-6-11"></a>                <span class="n">cc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_first_stage_encoding</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encode_first_stage</span><span class="p">(</span><span class="n">cc</span><span class="p">))</span>
<a id="__codelineno-6-12" name="__codelineno-6-12"></a>            <span class="n">c_cat</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
<a id="__codelineno-6-13" name="__codelineno-6-13"></a>        <span class="n">c_cat</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span><span class="n">c_cat</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p>The concat keys are <code>["mask", "masked_image"]</code> which provide the masked image and the masks.</p>
<ul>
<li>The mask will be resized to the same size as the input <span class="arithmatex">\(z\)</span></li>
<li>The masked_image will be encoded by the same encoder as the target image.</li>
</ul>
<h2 id="5-stable-diffusion-sdxl">5. Stable Diffusion SDXL<a class="headerlink" href="#5-stable-diffusion-sdxl" title="Permanent link">&para;</a></h2>
<p><a class="glightbox" href="../../../../images/Unknown-2.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="../../../../images/Unknown-2.png" /></a></p>
<ul>
<li>repo: <a href="https://github.com/Stability-AI/generative-models">https://github.com/Stability-AI/generative-models</a></li>
<li>paper: /<a href="https://arxiv.org/pdf/2307.01952">https://arxiv.org/pdf/2307.01952</a></li>
<li>date: 2023 July</li>
<li>Main changes</li>
<li>Three times large UNet</li>
<li>Second text encoder</li>
<li>novel conditioning schemes</li>
<li>train on multiple aspect ratios</li>
<li>refinement model to improve the visual fidelity</li>
</ul>
<h3 id="51-architecture">5.1 Architecture<a class="headerlink" href="#51-architecture" title="Permanent link">&para;</a></h3>
<p><a class="glightbox" href="../../../../images/image-58.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="../../../../images/image-58.png" /></a>
Participants were asked to choose their favorite image generation among four models, the results are shown above.</p>
<h4 id="511-network-structure">5.1.1 Network structure<a class="headerlink" href="#511-network-structure" title="Permanent link">&para;</a></h4>
<p><a class="glightbox" href="../../../../images/image-59.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="../../../../images/image-59.png" /></a></p>
<ul>
<li>VAE:</li>
<li>VAE is almost the same, but it implemented a memory-efficient cross-attention, which used the package <code>xformers</code></li>
</ul>
<h4 id="512-condition-on-image-size">5.1.2 Condition on image size<a class="headerlink" href="#512-condition-on-image-size" title="Permanent link">&para;</a></h4>
<p>Previous training discarded images under 512 pixels which could discard a large portion of data, leading to a loss in performance and generalization.</p>
<p>We provide the original (i.e., before any rescaling) height and width of the images as an additional conditioning to the model csize = (h-original, w-original). Each component is independently embedded using a Fourier feature encoding, and these encodings are concatenated into a single vector that we feed into the model by adding it to the timestep embedding.</p>
<p><a class="glightbox" href="../../../../images/image-60.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="../../../../images/image-60.png" /></a></p>
<h4 id="513-condition-on-cropping-parameters">5.1.3 Condition on cropping parameters<a class="headerlink" href="#513-condition-on-cropping-parameters" title="Permanent link">&para;</a></h4>
<p>Random cropping during training could lead to incomplete generation like the following. So we put it in the condition and set (<span class="arithmatex">\(c_top,c_left\)</span>) to be zeros to obtain object-centered samples. Further, we can tune the two parameters to simulate the amount of cropping during inference.
<a class="glightbox" href="../../../../images/image-61.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="../../../../images/image-61.png" /></a>
<a class="glightbox" href="../../../../images/image-62.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="../../../../images/image-62.png" /></a></p>
<ul>
<li>Method:
    During data loading, we uniformly sample crop coordinates ctop and cleft (integers specifying the amount of pixels cropped from the top-left corner along the height and width axes, respectively) and feed them into the model as conditioning parameters via Fourier feature embeddings, similar to the size conditioning described above.</li>
</ul>
<h4 id="514-condition-on-aspect-ratio">5.1.4 Condition on aspect ratio<a class="headerlink" href="#514-condition-on-aspect-ratio" title="Permanent link">&para;</a></h4>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code>Most text2image models produce square images.
- Training tricks:
  - Prepare different buckets of images, each bucket has the same shape, while the total number of pixels is approximately $1024^2$.
  - During training, a single batch comes from the same bucket, and we change the bucket for different steps in the training loop.
- Condition tricks:
  - Similar to the size condition and crop-parameter condition, the target shape $(h_{target},w_{target})$ is embedded into a Fourier space.
</code></pre></div></td></tr></table></div>
<h4 id="515-improved-autoencoder">5.1.5 Improved autoencoder<a class="headerlink" href="#515-improved-autoencoder" title="Permanent link">&para;</a></h4>
<ol>
<li>used ema in training</li>
<li>large batchsize 9-&gt; 256
    <a class="glightbox" href="../../../../images/image-63.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="../../../../images/image-63.png" /></a>
See more details for stable-diffusion xl in <a href="../stable_diffusion_xl/">stable diffusion xl</a></li>
</ol>
<h2 id="6-stable-diffusion-v3">6. Stable Diffusion v3<a class="headerlink" href="#6-stable-diffusion-v3" title="Permanent link">&para;</a></h2>
<blockquote>
<p>Scaling Rectified Flow Transformers for High-Resolution Image Synthesis</p>
</blockquote>
<ul>
<li>Paper: <a href="https://arxiv.org/pdf/2403.03206">https://arxiv.org/pdf/2403.03206</a></li>
<li>Report: <a href="https://stability.ai/news/stable-diffusion-3">https://stability.ai/news/stable-diffusion-3</a></li>
<li>Year: 2024 Mar</li>
<li>Resources</li>
<li>stable diffusion 3 reading: <a href="https://zhuanlan.zhihu.com/p/684068402?utm_source=chatgpt.com">https://zhuanlan.zhihu.com/p/684068402?utm_source=chatgpt.com</a></li>
<li>Code:</li>
<li><a href="https://github.com/Stability-AI/sd3-ref">sd 3 inference code</a></li>
<li><a href="https://github.com/huggingface/diffusers/blob/main/examples/instruct_pix2pix/train_instruct_pix2pix_sdxl.py">Instruct Training script based on SD3</a></li>
<li><a href="https://github.com/haoningwu3639/SimpleSDM-3">Flexible PyTorch implementation of StableDiffusion-3 based on  diffusers</a></li>
<li><a href="https://stabilityai.notion.site/Stable-Diffusion-3-Medium-Fine-tuning-Tutorial-17f90df74bce4c62a295849f0dc8fb7e">Stable Diffusion 3 Fintune Guide</a></li>
</ul>
<div class="admonition note">
<p class="admonition-title">study of sd3</p>
<p>See the paper reading in <a href="../stable_diffusion_3_reading/">Stable Diffusion v3</a></p>
</div>
<h2 id="7-stable-diffusion-v35">7. Stable Diffusion v3.5<a class="headerlink" href="#7-stable-diffusion-v35" title="Permanent link">&para;</a></h2>
<ul>
<li>
<p>repo: <a href="https://github.com/Stability-AI/sd3.5">https://github.com/Stability-AI/sd3.5</a></p>
</li>
<li>
<p>Resources:</p>
</li>
<li>applications on stable diffusion: <a href="https://github.com/awesome-stable-diffusion/awesome-stable-diffusion">https://github.com/awesome-stable-diffusion/awesome-stable-diffusion</a></li>
<li>
<p>inference code: <a href="https://github.com/Stability-AI/sd3.5">https://github.com/Stability-AI/sd3.5</a></p>
</li>
<li>
<p>Unchanged</p>
<ol>
<li>VAE</li>
<li>latent diffusion scheme</li>
<li>prompt processing: all using the clip_l, clip_G, and T5</li>
<li><span class="arithmatex">\(\sigma(t)\)</span>: use same scheduling</li>
<li>euler: same euler sampling method, but sd3.5 has another sampler  "dpmpp_2m"</li>
</ol>
</li>
<li>Changes<ol>
<li>SD 3.5 added support for ControlNet</li>
<li>Sampling: SD 3.5 version supports multiple samplers, such as "dpmpp_2m", "euler", etc., not just "euler". The default is "dpmpp_2m".</li>
<li>Sampling: SD 3.5 version added support for SkipLayerCFGDenoiser.</li>
<li>Config: SD 3.5 version changed the default steps from 50 to 40, and CFG_SCALE from 5 to 4.5.</li>
<li>MM-DiT -&gt; MM-DiTX</li>
</ol>
</li>
</ul>
<p>See more details of the implementation in <a href="../stable_diffusion_3_5_reading/">stable diffusion 3.5</a></p>









  



<!-- 段落注释系统
<div class="comments-container annotation-container">
  <div class="comments-header">
    <h2 id="__annotations" class="comments-title">
      <span class="comments-icon">🔍</span>
      段落注释
      <span class="comments-subtitle">您可以高亮并评论任何文本!</span>
    </h2>
    <div class="comments-divider"></div>
  </div>

  <div class="comments-wrapper">
    <div class="hypothesis-instructions">
      <p><strong>如何使用段落注释功能：</strong></p>
      <ol>
        <li>点击右上角的 <img src="https://hypothes.is/assets/images/logo.png" alt="Hypothesis" style="height: 16px; vertical-align: middle;"> 图标打开侧边栏</li>
        <li>选择任意文本段落即可高亮并添加注释</li>
        <li>您还可以对其他人的注释进行回复</li>
      </ol>
    </div>
  </div>
</div> -->

<!-- 加载  -->
<script type="application/json" class="js-hypothesis-config">
{
  "openSidebar": false,
  "showHighlights": true,
  "theme": "clean"
}
</script>
<script async src="https://hypothes.is/embed.js"></script>

<!-- Hypothesis 样式美化 -->
<style>
  /* 修改高亮效果为下划线和聊天泡泡 */
  .hypothesis-highlight {
    background-color: transparent !important; /* 移除高亮背景 */
    text-decoration: underline !important;
    text-decoration-color: #4285f4 !important;
    text-decoration-thickness: 2px !important;
    text-decoration-style: wavy !important;
    position: relative !important;
    cursor: pointer !important;
    border-bottom: none !important; /* 移除之前的边框 */
    box-shadow: none !important; /* 移除之前的阴影 */
  }

  .hypothesis-highlight::after {
    content: "💬" !important;
    position: absolute !important;
    display: inline-block !important;
    font-size: 14px !important;
    top: -10px !important;
    right: -5px !important;
    opacity: 0.7 !important;
    transition: opacity 0.3s ease !important;
  }

  .hypothesis-highlight:hover {
    background-color: rgba(66, 133, 244, 0.08) !important; /* 鼠标悬停时的轻微背景 */
  }

  .hypothesis-highlight:hover::after {
    opacity: 1 !important;
    transform: scale(1.2) !important;
  }

  /* 美化 Hypothesis 侧边栏 */
  hypothesis-sidebar {
    font-family: var(--md-text-font-family, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif) !important;
    box-shadow: -2px 0 10px rgba(0, 0, 0, 0.1) !important;
  }

  /* 美化卡片样式 */
  .hypothesis-annotation-card {
    border-radius: 8px !important;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05) !important;
    transition: transform 0.2s ease, box-shadow 0.2s ease !important;
    overflow: hidden !important;
  }

  .hypothesis-annotation-card:hover {
    transform: translateY(-2px) !important;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1) !important;
  }

  /* 美化 Hypothesis 按钮 */
  .hypothesis-button {
    border-radius: 4px !important;
    transition: background-color 0.2s ease !important;
  }

  /* 美化标签样式 */
  .hypothesis-tag {
    border-radius: 12px !important;
    padding: 2px 8px !important;
    font-size: 12px !important;
    background-color: rgba(0, 0, 0, 0.05) !important;
    color: #606060 !important;
  }

  /* 美化工具栏 */
  .hypothesis-toolbar {
    background: linear-gradient(to right, #f5f5f5, #ffffff) !important;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1) !important;
  }

  /* 美化注释面板header */
  .hypothesis-annotation-header {
    padding: 10px !important;
    background-color: #f9f9f9 !important;
  }

  /* 美化注释内容 */
  .hypothesis-annotation-body {
    font-size: 14px !important;
    line-height: 1.6 !important;
    color: #333 !important;
  }

  /* 美化用户名 */
  .hypothesis-user {
    font-weight: 600 !important;
    color: #3f51b5 !important;
  }

  /* 美化时间戳 */
  .hypothesis-timestamp {
    font-size: 12px !important;
    color: #757575 !important;
  }

  /* 美化输入框 */
  .hypothesis-input {
    border-radius: 4px !important;
    border: 1px solid #e0e0e0 !important;
    transition: border-color 0.2s ease, box-shadow 0.2s ease !important;
  }

  .hypothesis-input:focus {
    border-color: #4dabf7 !important;
    box-shadow: 0 0 0 2px rgba(77, 171, 247, 0.2) !important;
    outline: none !important;
  }
</style>

<!-- 页面评论系统 -->
<div class="comments-container utterances-container">
  <div class="comments-header">
    <h2 id="__comments" class="comments-title">
      <span class="comments-icon">💬</span>
      Comments
      <span class="comments-subtitle">Share your thoughts!</span>
    </h2>
    <div class="comments-divider"></div>
  </div>

  <div class="comments-wrapper">
    <script src="https://utteranc.es/client.js"
            repo="MAD-SG/generative-ai-start-to-surrender"
            issue-term="pathname"
            label="comment"
            theme="preferred-color-scheme"
            crossorigin="anonymous"
            async>
    </script>
  </div>
</div>

<style>
  .comments-container {
    margin: 2.5rem auto;
    padding: 1.5rem;
    background: var(--md-code-bg-color, rgba(0, 0, 0, 0.05));
    border-radius: 8px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    width: 100%;
    max-width: 100%;
    box-sizing: border-box;
  }

  .annotation-container {
    margin-bottom: 1rem;
    background: rgba(255, 255, 240, 0.5);
    border-left: 4px solid #ffeb3b;
  }

  .utterances-container {
    background: rgba(240, 248, 255, 0.5);
    border-left: 4px solid #2196f3;
  }

  .comments-container:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 12px rgba(0, 0, 0, 0.1);
  }

  .comments-header {
    margin-bottom: 1.5rem;
  }

  .comments-title {
    font-weight: 600;
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin-top: 0;
    margin-bottom: 0.75rem;
    color: var(--md-primary-fg-color, #2196f3);
    flex-wrap: wrap;
  }

  .annotation-container .comments-title {
    color: #f57c00;
  }

  .comments-icon {
    font-size: 1.4em;
  }

  .comments-subtitle {
    font-size: 0.7em;
    font-weight: 400;
    opacity: 0.8;
    margin-left: 1rem;
  }

  .comments-divider {
    height: 3px;
    background: linear-gradient(90deg,
      var(--md-primary-fg-color, #2196f3) 0%,
      rgba(255, 255, 255, 0) 100%);
    border-radius: 3px;
    margin-bottom: 1rem;
    width: 100%;
  }

  .annotation-container .comments-divider {
    background: linear-gradient(90deg,
      #f57c00 0%,
      rgba(255, 255, 255, 0) 100%);
  }

  .comments-wrapper {
    position: relative;
    min-height: 150px;
    width: 100%;
  }

  .hypothesis-instructions {
    padding: 1rem;
    background-color: rgba(255, 255, 255, 0.5);
    border-radius: 6px;
    margin-bottom: 1rem;
  }

  .hypothesis-instructions p {
    margin-top: 0;
    font-weight: 500;
  }

  .hypothesis-instructions ol {
    margin-bottom: 0;
    padding-left: 1.5rem;
  }

  .hypothesis-instructions li {
    margin-bottom: 0.5rem;
  }

  .hypothesis-instructions li:last-child {
    margin-bottom: 0;
  }

  /* 确保utterances的iframe填充可用宽度 */
  .utterances-container .comments-wrapper iframe {
    border-radius: 6px;
    width: 100% !important;
    max-width: 100% !important;
  }

  /* 动画效果 */
  @keyframes fadeInUp {
    from {
      opacity: 0;
      transform: translate3d(0, 20px, 0);
    }
    to {
      opacity: 1;
      transform: translate3d(0, 0, 0);
    }
  }

  .comments-wrapper {
    animation: fadeInUp 0.6s ease forwards;
  }

  /* 响应式设计 - 小屏幕调整 */
  @media (max-width: 768px) {
    .comments-container {
      padding: 1rem;
      margin: 1.5rem auto;
    }

    .comments-title {
      font-size: 1.3rem;
    }

    .comments-subtitle {
      display: block;
      width: 100%;
      margin-left: 0;
      margin-top: 0.3rem;
    }
  }
</style>
                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../dalle_series/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Dalle Series">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Dalle Series
              </div>
            </div>
          </a>
        
        
          
          <a href="../stable_diffusion_xl/" class="md-footer__link md-footer__link--next" aria-label="Next: Stable Diffusion XL">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Stable Diffusion XL
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://mad-sg.github.io/generative-ai-start-to-surrender/" target="_blank" rel="noopener" title="mad-sg.github.io" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://hub.docker.com/r/squidfunk/mkdocs-material/" target="_blank" rel="noopener" title="hub.docker.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M349.9 236.3h-66.1v-59.4h66.1zm0-204.3h-66.1v60.7h66.1zm78.2 144.8H362v59.4h66.1zm-156.3-72.1h-66.1v60.1h66.1zm78.1 0h-66.1v60.1h66.1zm276.8 100c-14.4-9.7-47.6-13.2-73.1-8.4-3.3-24-16.7-44.9-41.1-63.7l-14-9.3-9.3 14c-18.4 27.8-23.4 73.6-3.7 103.8-8.7 4.7-25.8 11.1-48.4 10.7H2.4c-8.7 50.8 5.8 116.8 44 162.1 37.1 43.9 92.7 66.2 165.4 66.2 157.4 0 273.9-72.5 328.4-204.2 21.4.4 67.6.1 91.3-45.2 1.5-2.5 6.6-13.2 8.5-17.1zm-511.1-27.9h-66v59.4h66.1v-59.4zm78.1 0h-66.1v59.4h66.1zm78.1 0h-66.1v59.4h66.1zm-78.1-72.1h-66.1v60.1h66.1z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://pypi.org/project/mkdocs-material/" target="_blank" rel="noopener" title="pypi.org" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6M286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3M167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4m-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://bsky.app/profile/squidfunk.bsky.social" target="_blank" rel="noopener" title="bsky.app" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M111.8 62.2C170.2 105.9 233 194.7 256 242.4c23-47.6 85.8-136.4 144.2-180.2 42.1-31.6 110.3-56 110.3 21.8 0 15.5-8.9 130.5-14.1 149.2-18.2 64.8-84.4 81.4-143.3 71.3C456 322 482.2 380 425.6 438c-107.4 110.2-154.3-27.6-166.3-62.9-1.7-4.9-2.6-7.8-3.3-7.8s-1.6 3-3.3 7.8c-12 35.3-59 173.1-166.3 62.9-56.5-58-30.4-116 72.5-133.5C100 314.6 33.8 298 15.7 233.1 10.4 214.4 1.5 99.4 1.5 83.9c0-77.8 68.2-53.4 110.3-21.8z"/></svg>
    </a>
  
    
    
      
    
    
    
      
      
    
    <a href="https://fosstodon.org/@squidfunk" target="_blank" rel="noopener me" title="fosstodon.org" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M433 179.11c0-97.2-63.71-125.7-63.71-125.7-62.52-28.7-228.56-28.4-290.48 0 0 0-63.72 28.5-63.72 125.7 0 115.7-6.6 259.4 105.63 289.1 40.51 10.7 75.32 13 103.33 11.4 50.81-2.8 79.32-18.1 79.32-18.1l-1.7-36.9s-36.31 11.4-77.12 10.1c-40.41-1.4-83-4.4-89.63-54a102.5 102.5 0 0 1-.9-13.9c85.63 20.9 158.65 9.1 178.75 6.7 56.12-6.7 105-41.3 111.23-72.9 9.8-49.8 9-121.5 9-121.5m-75.12 125.2h-46.63v-114.2c0-49.7-64-51.6-64 6.9v62.5h-46.33V197c0-58.5-64-56.6-64-6.9v114.2H90.19c0-122.1-5.2-147.9 18.41-175 25.9-28.9 79.82-30.8 103.83 6.1l11.6 19.5 11.6-19.5c24.11-37.1 78.12-34.8 103.83-6.1 23.71 27.3 18.4 53 18.4 175z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://x.com/squidfunk" target="_blank" rel="noopener" title="x.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8l164.9-188.5L26.8 48h145.6l100.5 132.9zm-24.8 373.8h39.1L151.1 88h-42z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../../..", "features": ["navigation.tabs", "toc.integrate", "content.code.copy", "content.code.select", "content.code.annotate", "content.tabs.link", "content.footnote.tooltips", "content.tooltips", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow", "announce.dismiss", "content.action.edit", "content.action.view", "content.code.annotate", "navigation.footer", "navigation.indexes", "navigation.sections", "navigation.tabs", "navigation.top", "navigation.expand", "search.share", "search.suggest"], "search": "../../../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.88dd0f4e.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/core-js/3.26.1/minified.min.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="../../../../javascripts/mathjax.js"></script>
      
    
  <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body>
</html>
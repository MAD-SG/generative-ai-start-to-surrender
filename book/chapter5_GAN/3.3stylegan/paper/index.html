
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../../3.1from_gan_to_stylegan/paper/">
      
      
        <link rel="next" href="../../3.4stylegan2/paper/">
      
      
      <link rel="icon" href="../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.49">
    
    
      
        <title>StyleGAN - Generative AI: From Start to Surrender</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.6f8fc17f.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../stylesheets/extra.css">
    
      <link rel="stylesheet" href="https://unpkg.com/katex@0/dist/katex.min.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config",""),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
   <link href="../../../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../../../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#stylegan-a-style-based-generator-architecture-for-generative-adversarial-networks" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="Generative AI: From Start to Surrender" class="md-header__button md-logo" aria-label="Generative AI: From Start to Surrender" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Generative AI: From Start to Surrender
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              StyleGAN
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1M8 13h8v-2H8zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4a5 5 0 0 0 5-5 5 5 0 0 0-5-5"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5M7 15a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../chapter1_Introduction/1.1terminology/" class="md-tabs__link">
          
  
    
  
  Introduction

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../chapter2_generation_theory/mle/" class="md-tabs__link">
          
  
    
  
  Generation Theory

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../chapter3_energy_based_model/introduction/" class="md-tabs__link">
          
  
    
  
  Energy Based Models

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../chapter6_VAE/vae_introduction/" class="md-tabs__link">
          
  
    
  
  VAE

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../3.1from_gan_to_stylegan/paper/" class="md-tabs__link">
          
  
    
  
  GANs

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../chapter7_diffusion/ddpm/" class="md-tabs__link">
          
  
    
  
  Diffusion Models

        </a>
      </li>
    
  

    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../chapter9_flow_matching/introduction/" class="md-tabs__link">
          
  
    
  
  Flow Matching

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../chapter11_hybrid_sota_models/hybrid_methods/" class="md-tabs__link">
          
  
    
  
  Hybrid SOTA Models

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../chapter12_applications/diffusion_anomaly_detection/" class="md-tabs__link">
          
  
    
  
  Application

        </a>
      </li>
    
  

    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="Generative AI: From Start to Surrender" class="md-nav__button md-logo" aria-label="Generative AI: From Start to Surrender" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Generative AI: From Start to Surrender
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Introduction
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter1_Introduction/1.1terminology/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Terms
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter1_Introduction/1.2fourier_transform/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fourier Transform
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter1_Introduction/1.3signal_processing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Signal Processing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter1_Introduction/1.4statistics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Statistics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter1_Introduction/tutorials/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tutorials
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Generation Theory
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Generation Theory
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter2_generation_theory/mle/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Maximal Likelihood
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter2_generation_theory/manifold_hypothesis/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Manifold Hypothesis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter2_generation_theory/generative_model_category/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Generative Model Category
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Energy Based Models
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Energy Based Models
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter3_energy_based_model/introduction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter3_energy_based_model/score_function/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Score Functions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter3_energy_based_model/sampling/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sampling Methods
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter3_energy_based_model/cd/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contrastive Divergence
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter3_energy_based_model/score_matching/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Score Matching
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    VAE
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            VAE
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter6_VAE/vae_introduction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter6_VAE/vq_vae/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    VA-VAE
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" checked>
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="">
            
  
  <span class="md-ellipsis">
    GANs
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            GANs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../3.1from_gan_to_stylegan/paper/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    From GAN to StyleGAN
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_2" checked>
        
          
          <label class="md-nav__link" for="__nav_6_2" id="__nav_6_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    StyleGAN Variants
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6_2">
            <span class="md-nav__icon md-icon"></span>
            StyleGAN Variants
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    StyleGAN
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    StyleGAN
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    <span class="md-ellipsis">
      1. 核心创新
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    <span class="md-ellipsis">
      2. 技术细节
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    <span class="md-ellipsis">
      3. 代码解读
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. 代码解读">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-1-generator" class="md-nav__link">
    <span class="md-ellipsis">
      3.1 1. Generator
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-synthesis-network" class="md-nav__link">
    <span class="md-ellipsis">
      2. synthesis network
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-convblock" class="md-nav__link">
    <span class="md-ellipsis">
      3. ConvBlock
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../3.4stylegan2/paper/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    StyleGAN2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../3.5stylegan3/paper/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    StyleGAN3
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../3.6styleganT/paper/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    StyleGAN-T
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../3.7R3Gan/paper/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    R3GAN
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../vq_gan/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    VQ-GAN
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Diffusion Models
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Diffusion Models
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7_1" >
        
          
          <label class="md-nav__link" for="__nav_7_1" id="__nav_7_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Discrete Diffusion
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_1">
            <span class="md-nav__icon md-icon"></span>
            Discrete Diffusion
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter7_diffusion/ddpm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DDPM
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter7_diffusion/ldm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LDM
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter7_diffusion/ldm_handson/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LDM Handson
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter7_diffusion/diffusion_model_varients/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Diffusion Model Varients
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter7_diffusion/general_diffusion_model/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    General Diffusion Model
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7_2" >
        
          
          <label class="md-nav__link" for="__nav_7_2" id="__nav_7_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    SDE Diffusion
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_2">
            <span class="md-nav__icon md-icon"></span>
            SDE Diffusion
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter7_diffusion/introduction_sde/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SDE Fundamentals
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter7_diffusion/from_ddpm_2_sde/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SDE for DDPM
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter7_diffusion/score_based_sde/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Score Based SDE
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter7_diffusion/probability_flow_ode/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Probability Flow ODE
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter7_diffusion/sde_diffusion_speedup/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SDE Diffusion Speedup
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter7_diffusion/sde_diffusion_unified_representation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Scaling and Scheduling
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7_3" >
        
          
          <label class="md-nav__link" for="__nav_7_3" id="__nav_7_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Diffusion Network
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_3">
            <span class="md-nav__icon md-icon"></span>
            Diffusion Network
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter7_diffusion/DiT/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DiT
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7_4" >
        
          
          <label class="md-nav__link" for="__nav_7_4" id="__nav_7_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Diffusion Solver
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_4">
            <span class="md-nav__icon md-icon"></span>
            Diffusion Solver
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter7_diffusion/diffusion_solver/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DPM Solver
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7_5" >
        
          
          <label class="md-nav__link" for="__nav_7_5" id="__nav_7_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Conditional Diffusion
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_5">
            <span class="md-nav__icon md-icon"></span>
            Conditional Diffusion
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter7_diffusion/controlnet/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ControlNet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter7_diffusion/sde_diffusion_guidance/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SDE Diffusion Guidance
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Flow Matching
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Flow Matching
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter9_flow_matching/introduction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter9_flow_matching/probability_with_velocity_field/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Probability Path and Velocity Fields
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter9_flow_matching/flow_matching_theory/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Flow Matching Theorem
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter9_flow_matching/affine_conditional_flows/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Affine Conditional Flow
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter9_flow_matching/optimal_transport_flow/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Optimal Transport Flow
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter9_flow_matching/comparison_with_flow_ode/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Comparison with Diffusion Flow ODE
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Hybrid SOTA Models
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            Hybrid SOTA Models
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter11_hybrid_sota_models/hybrid_methods/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hybrid Methods
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter11_hybrid_sota_models/sota_closed_models/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Closed Models
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_9_3" >
        
          
          <label class="md-nav__link" for="__nav_9_3" id="__nav_9_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Open Models
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_9_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_3">
            <span class="md-nav__icon md-icon"></span>
            Open Models
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter11_hybrid_sota_models/sota_open_models/dalle_series/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dalle Series
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_9_3_2" >
        
          
          <label class="md-nav__link" for="__nav_9_3_2" id="__nav_9_3_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Stable Diffusion Series
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_9_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_3_2">
            <span class="md-nav__icon md-icon"></span>
            Stable Diffusion Series
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter11_hybrid_sota_models/sota_open_models/stable_diffusion_series/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter11_hybrid_sota_models/sota_open_models/stable_diffusion_xl/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Stable Diffusion XL
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter11_hybrid_sota_models/sota_open_models/stable_diffusion_3_reading/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Stable Diffusion 3
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter11_hybrid_sota_models/sota_open_models/stable_diffusion_3_5_reading/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Stable Diffusion 3.5
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter11_hybrid_sota_models/sota_open_models/flux1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Flux.1
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter11_hybrid_sota_models/trends_future/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Future Trends
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_10" >
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Application
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            Application
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_10_1" >
        
          
          <label class="md-nav__link" for="__nav_10_1" id="__nav_10_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Anomaly Detection
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_1">
            <span class="md-nav__icon md-icon"></span>
            Anomaly Detection
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../chapter12_applications/diffusion_anomaly_detection/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Diffuson Anomaly Detection
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="stylegan-a-style-based-generator-architecture-for-generative-adversarial-networks">StyleGAN: A Style-Based Generator Architecture for Generative Adversarial Networks<a class="headerlink" href="#stylegan-a-style-based-generator-architecture-for-generative-adversarial-networks" title="Permanent link">&para;</a></h1>
<p><a href="https://arxiv.org/abs/1812.04948">Paper Link</a>
<a class="glightbox" href="../../../../images/image-14.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="../../../../images/image-14.png" /></a></p>
<h2 id="1">1. 核心创新<a class="headerlink" href="#1" title="Permanent link">&para;</a></h2>
<ol>
<li><strong>基于风格的生成器架构</strong>
<a class="glightbox" href="../../../../images/image-13.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="../../../../images/image-13.png" /></a></li>
<li>将传统的输入层替换为常量输入</li>
<li>通过AdaIN层将潜在编码注入到不同的层级</li>
<li>
<p>实现了对不同尺度特征的精确控制</p>
</li>
<li>
<p><strong>中间潜在空间W</strong></p>
</li>
<li>引入映射网络F将潜在空间Z映射到中间潜在空间W</li>
<li>W空间具有更好的解耦特性</li>
<li>
<p>支持更好的特征混合和编辑操作</p>
</li>
<li>
<p><strong>自适应实例归一化(AdaIN)</strong></p>
</li>
<li>通过风格向量调制每个通道的均值和方差</li>
<li>实现了对特定特征的精确控制</li>
</ol>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">*</span> <span class="p">(</span><span class="n">style_split</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">style_split</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
<ul>
<li>每个channel的feature map显式调节方差和均值，这两个统计量表示图片的风格</li>
</ul>
<h2 id="2">2. 技术细节<a class="headerlink" href="#2" title="Permanent link">&para;</a></h2>
<ol>
<li><strong>LOD (Level of Detail) 计算</strong>:</li>
<li><strong>目的</strong>: 控制训练期间的分辨率级别，支持渐进式增长。</li>
<li><strong>计算</strong>:<ul>
<li><code>lod</code> 基于已见图像数量 (<code>seen_img</code>) 和每个级别的持续时间 (<code>lod_duration</code>) 计算。</li>
<li>随训练进展而减少，平滑过渡于不同分辨率。</li>
</ul>
</li>
<li>
<p><strong>阶段</strong>:</p>
<ul>
<li>稳定阶段：<code>lod</code> 保持不变。</li>
<li>过渡阶段：<code>lod</code> 取分数值，平滑分辨率变化。</li>
</ul>
</li>
<li>
<p><strong>合成网络 (Synthesis Network)</strong>:</p>
</li>
<li><strong>结构</strong>: 由多个分辨率层组成，每层包含两个卷积块。</li>
<li><strong>分辨率层</strong>:<ul>
<li><strong>初始层</strong>: 将常量输入转换为特征图。</li>
<li><strong>后续层</strong>: 每层分辨率加倍，通道减半，保持参数一致。</li>
</ul>
</li>
<li>
<p><strong>卷积块 (ConvBlock)</strong>:</p>
<ul>
<li><strong>上采样</strong>: 使用最近邻插值增加分辨率。</li>
<li><strong>卷积</strong>: 受 PGGAN 启发的缩放权重，稳定训练。</li>
<li><strong>噪声添加</strong>: 空间或通道噪声，增强细节多样性。</li>
<li><strong>激活</strong>: LeakyReLU 防止神经元死亡，改善梯度流动。</li>
<li><strong>归一化</strong>: 实例归一化标准化特征图。</li>
<li><strong>风格化</strong>: 使用学习的风格向量调制特征图，调整每个特征图的均值和方差。</li>
</ul>
</li>
<li>
<p><strong>风格调制 (Style Modulation)</strong>:</p>
</li>
<li><strong>过程</strong>: 每个特征图通道使用风格向量调制。</li>
<li>
<p><strong>方程</strong>:</p>
<div class="arithmatex">\[
 x = x \times (\text{style\_split}[:, 0] + 1) + \text{style\_split}[:, 1]
\]</div>
</li>
<li>
<p><strong>目的</strong>: 显式调整特征图方差和均值，表示图片风格。</p>
</li>
<li>
<p><strong>截断技巧 (Truncation Trick)</strong>:</p>
</li>
<li><strong>目的</strong>: 控制生成图像的多样性与稳定性。</li>
<li>
<p><strong>过程</strong>: 使用中心平均值 (<code>w_{avg}</code>) 和缩放因子 (<code>trunc_psi</code>) 调整风格向量。它更相当于一个缩放操作，而不是传统意义上的截断操作。</p>
</li>
<li>
<p><strong>噪声注入 (Noise Injection)</strong>:</p>
</li>
<li><strong>类型</strong>: 空间或通道。</li>
<li><strong>目的</strong>: 为特征图添加随机变化，增强细节多样性。</li>
</ol>
<h2 id="3">3. 代码解读<a class="headerlink" href="#3" title="Permanent link">&para;</a></h2>
<h3 id="31-1-generator">3.1 1. Generator<a class="headerlink" href="#31-1-generator" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-1-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-1-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-1-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-1-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-1-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-1-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-1-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-1-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-1-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-1-10">10</a></span>
<span class="normal"><a href="#__codelineno-1-11">11</a></span>
<span class="normal"><a href="#__codelineno-1-12">12</a></span>
<span class="normal"><a href="#__codelineno-1-13">13</a></span>
<span class="normal"><a href="#__codelineno-1-14">14</a></span>
<span class="normal"><a href="#__codelineno-1-15">15</a></span>
<span class="normal"><a href="#__codelineno-1-16">16</a></span>
<span class="normal"><a href="#__codelineno-1-17">17</a></span>
<span class="normal"><a href="#__codelineno-1-18">18</a></span>
<span class="normal"><a href="#__codelineno-1-19">19</a></span>
<span class="normal"><a href="#__codelineno-1-20">20</a></span>
<span class="normal"><a href="#__codelineno-1-21">21</a></span>
<span class="normal"><a href="#__codelineno-1-22">22</a></span>
<span class="normal"><a href="#__codelineno-1-23">23</a></span>
<span class="normal"><a href="#__codelineno-1-24">24</a></span>
<span class="normal"><a href="#__codelineno-1-25">25</a></span>
<span class="normal"><a href="#__codelineno-1-26">26</a></span>
<span class="normal"><a href="#__codelineno-1-27">27</a></span>
<span class="normal"><a href="#__codelineno-1-28">28</a></span>
<span class="normal"><a href="#__codelineno-1-29">29</a></span>
<span class="normal"><a href="#__codelineno-1-30">30</a></span>
<span class="normal"><a href="#__codelineno-1-31">31</a></span>
<span class="normal"><a href="#__codelineno-1-32">32</a></span>
<span class="normal"><a href="#__codelineno-1-33">33</a></span>
<span class="normal"><a href="#__codelineno-1-34">34</a></span>
<span class="normal"><a href="#__codelineno-1-35">35</a></span>
<span class="normal"><a href="#__codelineno-1-36">36</a></span>
<span class="normal"><a href="#__codelineno-1-37">37</a></span>
<span class="normal"><a href="#__codelineno-1-38">38</a></span>
<span class="normal"><a href="#__codelineno-1-39">39</a></span>
<span class="normal"><a href="#__codelineno-1-40">40</a></span>
<span class="normal"><a href="#__codelineno-1-41">41</a></span>
<span class="normal"><a href="#__codelineno-1-42">42</a></span>
<span class="normal"><a href="#__codelineno-1-43">43</a></span>
<span class="normal"><a href="#__codelineno-1-44">44</a></span>
<span class="normal"><a href="#__codelineno-1-45">45</a></span>
<span class="normal"><a href="#__codelineno-1-46">46</a></span>
<span class="normal"><a href="#__codelineno-1-47">47</a></span>
<span class="normal"><a href="#__codelineno-1-48">48</a></span>
<span class="normal"><a href="#__codelineno-1-49">49</a></span>
<span class="normal"><a href="#__codelineno-1-50">50</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1"></a>    def forward(self,
<a id="__codelineno-1-2" name="__codelineno-1-2"></a>                z,
<a id="__codelineno-1-3" name="__codelineno-1-3"></a>                label=None,
<a id="__codelineno-1-4" name="__codelineno-1-4"></a>                lod=None,
<a id="__codelineno-1-5" name="__codelineno-1-5"></a>                w_moving_decay=0.995,
<a id="__codelineno-1-6" name="__codelineno-1-6"></a>                style_mixing_prob=0.9,
<a id="__codelineno-1-7" name="__codelineno-1-7"></a>                trunc_psi=None,
<a id="__codelineno-1-8" name="__codelineno-1-8"></a>                trunc_layers=None,
<a id="__codelineno-1-9" name="__codelineno-1-9"></a>                randomize_noise=False,
<a id="__codelineno-1-10" name="__codelineno-1-10"></a>                **_unused_kwargs):
<a id="__codelineno-1-11" name="__codelineno-1-11"></a>        mapping_results = self.mapping(z, label) # label 是用于条件生成的标签
<a id="__codelineno-1-12" name="__codelineno-1-12"></a>        w = mapping_results[&#39;w&#39;] #  W空间
<a id="__codelineno-1-13" name="__codelineno-1-13"></a>        # w shape : [batch_size, w_space_dim] = [B,512]
<a id="__codelineno-1-14" name="__codelineno-1-14"></a>
<a id="__codelineno-1-15" name="__codelineno-1-15"></a>        if self.training and w_moving_decay &lt; 1:
<a id="__codelineno-1-16" name="__codelineno-1-16"></a>            batch_w_avg = all_gather(w).mean(dim=0)
<a id="__codelineno-1-17" name="__codelineno-1-17"></a>            self.truncation.w_avg.copy_(
<a id="__codelineno-1-18" name="__codelineno-1-18"></a>                self.truncation.w_avg * w_moving_decay +
<a id="__codelineno-1-19" name="__codelineno-1-19"></a>                batch_w_avg * (1 - w_moving_decay))
<a id="__codelineno-1-20" name="__codelineno-1-20"></a>            # 计算一个W空间中的中心点,用于截断操作
<a id="__codelineno-1-21" name="__codelineno-1-21"></a>        if self.training and style_mixing_prob &gt; 0:
<a id="__codelineno-1-22" name="__codelineno-1-22"></a>            new_z = torch.randn_like(z)
<a id="__codelineno-1-23" name="__codelineno-1-23"></a>            new_w = self.mapping(new_z, label)[&#39;w&#39;]
<a id="__codelineno-1-24" name="__codelineno-1-24"></a>            lod = self.synthesis.lod.cpu().tolist() if lod is None else lod
<a id="__codelineno-1-25" name="__codelineno-1-25"></a>            # 这里的 tolist() 可能造成混淆，但对于0维tensor（标量tensor），它返回的是一个标量值。例如：
<a id="__codelineno-1-26" name="__codelineno-1-26"></a>            # 所以在这里，lod 就是一个数值，比如 0、1、2 或者 1.5 这样的值，用于控制生成图像的分辨率级别。这个值：
<a id="__codelineno-1-27" name="__codelineno-1-27"></a>
<a id="__codelineno-1-28" name="__codelineno-1-28"></a>            # 可以是整数：直接对应某个分辨率级别
<a id="__codelineno-1-29" name="__codelineno-1-29"></a>            # 也可以是小数：表示在两个分辨率级别之间进行插值
<a id="__codelineno-1-30" name="__codelineno-1-30"></a>
<a id="__codelineno-1-31" name="__codelineno-1-31"></a>            current_layers = self.num_layers - int(lod) * 2
<a id="__codelineno-1-32" name="__codelineno-1-32"></a>            if np.random.uniform() &lt; style_mixing_prob:
<a id="__codelineno-1-33" name="__codelineno-1-33"></a>                mixing_cutoff = np.random.randint(1, current_layers)
<a id="__codelineno-1-34" name="__codelineno-1-34"></a>                # 前面的current_layers 表示当前的分辨率级别
<a id="__codelineno-1-35" name="__codelineno-1-35"></a>                # 后面的 mixing_cutoff 表示截断点
<a id="__codelineno-1-36" name="__codelineno-1-36"></a>                # 这里的 np.random.randint(1, current_layers) 表示随机选择一个截断点
<a id="__codelineno-1-37" name="__codelineno-1-37"></a>
<a id="__codelineno-1-38" name="__codelineno-1-38"></a>                w = self.truncation(w)
<a id="__codelineno-1-39" name="__codelineno-1-39"></a>                new_w = self.truncation(new_w)
<a id="__codelineno-1-40" name="__codelineno-1-40"></a>                w[:, mixing_cutoff:] = new_w[:, mixing_cutoff:]
<a id="__codelineno-1-41" name="__codelineno-1-41"></a>                # 前半部分的 W 空间不变，后半部分的 W 空间进行了替换
<a id="__codelineno-1-42" name="__codelineno-1-42"></a>
<a id="__codelineno-1-43" name="__codelineno-1-43"></a>        wp = self.truncation(w, trunc_psi, trunc_layers)
<a id="__codelineno-1-44" name="__codelineno-1-44"></a>        # wp 也进行了截断。
<a id="__codelineno-1-45" name="__codelineno-1-45"></a>        # 形状变化  ：
<a id="__codelineno-1-46" name="__codelineno-1-46"></a>        # 输入 w: [batch_size, w_space_dim] = [B, 512]
<a id="__codelineno-1-47" name="__codelineno-1-47"></a>        # 输出 wp: [batch_size, num_layers, w_space_dim] = [B, num_layers, 512]
<a id="__codelineno-1-48" name="__codelineno-1-48"></a>        synthesis_results = self.synthesis(wp, lod, randomize_noise)
<a id="__codelineno-1-49" name="__codelineno-1-49"></a>
<a id="__codelineno-1-50" name="__codelineno-1-50"></a>        return {**mapping_results, **synthesis_results}
</code></pre></div></td></tr></table></div>
<p>generator 分成几个步骤</p>
<h4 id="311-1-mapping-network">3.1.1 1. 映射网络 (Mapping Network)<a class="headerlink" href="#311-1-mapping-network" title="Permanent link">&para;</a></h4>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-2-1">1</a></span>
<span class="normal"><a href="#__codelineno-2-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1"></a>mapping_results = self.mapping(z, label) # label 是用于条件生成的标签
<a id="__codelineno-2-2" name="__codelineno-2-2"></a>w = mapping_results[&#39;w&#39;]
</code></pre></div></td></tr></table></div>
<p><strong>输入</strong> :</p>
<ul>
<li><span class="arithmatex">\(z\)</span>: 潜在向量，通常是从标准正态分布中采样，形状为 <span class="arithmatex">\([B, z\_dim]\)</span></li>
<li><span class="arithmatex">\(\text{label}\)</span>: 条件生成的标签，可选，用于控制生成内容。</li>
<li><strong>过程</strong> :</li>
<li>
<p>使用一个多层感知机 (MLP) 将潜在向量 <span class="arithmatex">\(z\)</span> 映射到样式空间 <span class="arithmatex">\(w\)</span>：</p>
<div class="arithmatex">\[w = f(z) \]</div>
<p>其中 <span class="arithmatex">\(f\)</span> 是映射网络，输出 <span class="arithmatex">\(w\)</span> 的形状为 <span class="arithmatex">\([B, w\_dim]\)</span>，  通常 <span class="arithmatex">\(w\_dim = 512\)</span>。
- <strong>输出</strong> :
  - <span class="arithmatex">\(w\)</span>: 样式向量，作为后续生成过程中的特征控制参数。</p>
</li>
</ul>
<h4 id="312-2-w">3.1.2 2. W 空间均值的移动平均更新<a class="headerlink" href="#312-2-w" title="Permanent link">&para;</a></h4>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-3-1">1</a></span>
<span class="normal"><a href="#__codelineno-3-2">2</a></span>
<span class="normal"><a href="#__codelineno-3-3">3</a></span>
<span class="normal"><a href="#__codelineno-3-4">4</a></span>
<span class="normal"><a href="#__codelineno-3-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1"></a><span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">training</span> <span class="ow">and</span> <span class="n">w_moving_decay</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-3-2" name="__codelineno-3-2"></a>    <span class="n">batch_w_avg</span> <span class="o">=</span> <span class="n">all_gather</span><span class="p">(</span><span class="n">w</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-3-3" name="__codelineno-3-3"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">truncation</span><span class="o">.</span><span class="n">w_avg</span><span class="o">.</span><span class="n">copy_</span><span class="p">(</span>
<a id="__codelineno-3-4" name="__codelineno-3-4"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">truncation</span><span class="o">.</span><span class="n">w_avg</span> <span class="o">*</span> <span class="n">w_moving_decay</span> <span class="o">+</span>
<a id="__codelineno-3-5" name="__codelineno-3-5"></a>        <span class="n">batch_w_avg</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">w_moving_decay</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
<ul>
<li><strong>目的</strong> :</li>
<li>
<p>在训练阶段，计算 <span class="arithmatex">\(w\)</span> 的均值并进行移动平均更新，得到样式空间的中心点 <span class="arithmatex">\(w_{avg}\)</span>。</p>
</li>
<li>
<p><span class="arithmatex">\(w_{avg}\)</span> 用于后续的截断操作（truncation trick），以控制生成内容的多样性和平衡性。</p>
</li>
<li>
<p><strong>过程</strong> :</p>
</li>
<li>
<p>计算当前批次的样式向量平均值 <span class="arithmatex">\(\text{batch\_w\_avg}\)</span>。</p>
</li>
<li>
<p>使用指数移动平均 (EMA) 更新全局样式均值 <span class="arithmatex">\(w\_avg\)</span>:</p>
<div class="arithmatex">\[
w_{avg} \gets w_{avg} \cdot \text{decay} + \text{batch-w-avg} \cdot (1 - \text{decay})
\]</div>
</li>
</ul>
<h4 id="313-3-style-mixing">3.1.3 3. 样式混合 (Style Mixing)<a class="headerlink" href="#313-3-style-mixing" title="Permanent link">&para;</a></h4>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-4-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-4-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-4-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-4-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-4-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-4-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-4-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-4-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-4-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-4-10">10</a></span>
<span class="normal"><a href="#__codelineno-4-11">11</a></span>
<span class="normal"><a href="#__codelineno-4-12">12</a></span>
<span class="normal"><a href="#__codelineno-4-13">13</a></span>
<span class="normal"><a href="#__codelineno-4-14">14</a></span>
<span class="normal"><a href="#__codelineno-4-15">15</a></span>
<span class="normal"><a href="#__codelineno-4-16">16</a></span>
<span class="normal"><a href="#__codelineno-4-17">17</a></span>
<span class="normal"><a href="#__codelineno-4-18">18</a></span>
<span class="normal"><a href="#__codelineno-4-19">19</a></span>
<span class="normal"><a href="#__codelineno-4-20">20</a></span>
<span class="normal"><a href="#__codelineno-4-21">21</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1"></a><span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">training</span> <span class="ow">and</span> <span class="n">style_mixing_prob</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-4-2" name="__codelineno-4-2"></a>    <span class="n">new_z</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn_like</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<a id="__codelineno-4-3" name="__codelineno-4-3"></a>    <span class="n">new_w</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mapping</span><span class="p">(</span><span class="n">new_z</span><span class="p">,</span> <span class="n">label</span><span class="p">)[</span><span class="s1">&#39;w&#39;</span><span class="p">]</span>
<a id="__codelineno-4-4" name="__codelineno-4-4"></a>    <span class="n">lod</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">synthesis</span><span class="o">.</span><span class="n">lod</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="k">if</span> <span class="n">lod</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">lod</span>
<a id="__codelineno-4-5" name="__codelineno-4-5"></a>    <span class="n">current_layers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_layers</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">lod</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span>
<a id="__codelineno-4-6" name="__codelineno-4-6"></a>    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">style_mixing_prob</span><span class="p">:</span>
<a id="__codelineno-4-7" name="__codelineno-4-7"></a>        <span class="n">mixing_cutoff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">current_layers</span><span class="p">)</span>
<a id="__codelineno-4-8" name="__codelineno-4-8"></a>        <span class="c1"># 前面的current_layers 表示当前的分辨率级别</span>
<a id="__codelineno-4-9" name="__codelineno-4-9"></a>        <span class="c1"># 后面的 mixing_cutoff 表示截断点</span>
<a id="__codelineno-4-10" name="__codelineno-4-10"></a>        <span class="c1"># 这里的 np.random.randint(1, current_layers) 表示随机选择一个截断点</span>
<a id="__codelineno-4-11" name="__codelineno-4-11"></a>
<a id="__codelineno-4-12" name="__codelineno-4-12"></a>        <span class="n">w</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">truncation</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<a id="__codelineno-4-13" name="__codelineno-4-13"></a>        <span class="n">new_w</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">truncation</span><span class="p">(</span><span class="n">new_w</span><span class="p">)</span>
<a id="__codelineno-4-14" name="__codelineno-4-14"></a>        <span class="n">w</span><span class="p">[:,</span> <span class="n">mixing_cutoff</span><span class="p">:]</span> <span class="o">=</span> <span class="n">new_w</span><span class="p">[:,</span> <span class="n">mixing_cutoff</span><span class="p">:]</span>
<a id="__codelineno-4-15" name="__codelineno-4-15"></a>        <span class="c1"># 前半部分的 W 空间不变，后半部分的 W 空间进行了替换</span>
<a id="__codelineno-4-16" name="__codelineno-4-16"></a>
<a id="__codelineno-4-17" name="__codelineno-4-17"></a>        <span class="c1"># 问题：同一个batch里的mixing_point是一样的。如果对同一个batch里的不同样本做不一样的样式混合，会不会有问题？</span>
<a id="__codelineno-4-18" name="__codelineno-4-18"></a>
<a id="__codelineno-4-19" name="__codelineno-4-19"></a><span class="c1">#### 4. 截断操作 (Truncation Trick)</span>
<a id="__codelineno-4-20" name="__codelineno-4-20"></a><span class="err">```</span><span class="n">python</span>
<a id="__codelineno-4-21" name="__codelineno-4-21"></a><span class="n">wp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">truncation</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">trunc_psi</span><span class="p">,</span> <span class="n">trunc_layers</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p>在self.truncation里面 会先对<span class="arithmatex">\(w\)</span>进行复制，复制后的shape 为 <span class="arithmatex">\([B, \text{num\_layers}, w\_dim]\)</span>，
每一层的样式向量都是相同的。
然后再进行截断操作.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-5-1">1</a></span>
<span class="normal"><a href="#__codelineno-5-2">2</a></span>
<span class="normal"><a href="#__codelineno-5-3">3</a></span>
<span class="normal"><a href="#__codelineno-5-4">4</a></span>
<span class="normal"><a href="#__codelineno-5-5">5</a></span>
<span class="normal"><a href="#__codelineno-5-6">6</a></span>
<span class="normal"><a href="#__codelineno-5-7">7</a></span>
<span class="normal"><a href="#__codelineno-5-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1"></a>#self traucation
<a id="__codelineno-5-2" name="__codelineno-5-2"></a>if w.ndim == 2:
<a id="__codelineno-5-3" name="__codelineno-5-3"></a>    if self.repeat_w and w.shape[1] == self.w_space_dim:
<a id="__codelineno-5-4" name="__codelineno-5-4"></a>        w = w.view(-1, 1, self.w_space_dim)
<a id="__codelineno-5-5" name="__codelineno-5-5"></a>        wp = w.repeat(1, self.num_layers, 1)
<a id="__codelineno-5-6" name="__codelineno-5-6"></a>    else:
<a id="__codelineno-5-7" name="__codelineno-5-7"></a>        assert w.shape[1] == self.w_space_dim * self.num_layers
<a id="__codelineno-5-8" name="__codelineno-5-8"></a>        wp = w.view(-1, self.num_layers, self.w_space_dim)
</code></pre></div></td></tr></table></div>
<ul>
<li><strong>目的</strong> :</li>
<li>
<p>控制生成内容的多样性与稳定性。</p>
</li>
<li>
<p><strong>过程</strong> :</p>
</li>
<li>
<p>使用样式空间的中心点 <span class="arithmatex">\(w\_avg\)</span> 和截断因子 <span class="arithmatex">\(\psi\)</span> 对样式向量 <span class="arithmatex">\(w\)</span> 进行缩放：</p>
<div class="arithmatex">\[
w'_i = w_{avg} + \psi \cdot (w_i - w_{avg}), \quad \text{for layers } i &lt; \text{trunclayers}
\]</div>
</li>
<li>
<p>截断操作可以减小样式空间中样式向量的偏离程度，从而生成更稳定的图像。</p>
</li>
<li><strong>输出</strong> :</li>
<li><span class="arithmatex">\(wp\)</span>: 每一层的样式向量，形状为 <span class="arithmatex">\([B, \text{num\_layers}, w\_dim]\)</span>。</li>
<li>
<p><strong>问题</strong> : 严格来说，这个操作确实更接近于 <strong>缩放 (scaling)</strong>  而不是传统意义上的 <strong>截断 (truncation)</strong> ，尽管在 StyleGAN 的术语中被称为 "truncation trick"。</p>
<p><strong>为什么是缩放？</strong>
截断操作的公式为：</p>
<div class="arithmatex">\[
wp = w_{avg} + (wp - w_{avg}) \cdot \text{trunc-psi}
\]</div>
<p>观察公式可以看出：
1. 样式向量 <span class="arithmatex">\(wp\)</span> 被重新调整到一个以 <span class="arithmatex">\(w_{avg}\)</span> 为中心的范围内。</p>
<ol>
<li><span class="arithmatex">\(\text{trunc-psi}\)</span> 是一个缩放因子，决定了 <span class="arithmatex">\(wp\)</span> 偏离 <span class="arithmatex">\(w_{avg}\)</span> 的程度。</li>
</ol>
<p><strong>物理意义</strong> ：
  - 如果 <span class="arithmatex">\(\text{trunc-psi} &lt; 1\)</span>，样式向量的偏离被缩小，生成的图像更接近于全局样式的“平均值”。</p>
</li>
<li>
<p>如果 <span class="arithmatex">\(\text{trunc-psi} &gt; 1\)</span>，样式向量的偏离被放大，生成的图像会更极端，更偏离平均风格。</p>
<p><strong>传统截断 (Clipping)</strong> 在传统的“截断”概念中，我们会将某些超出指定范围的值 <strong>直接限制</strong>  在这个范围内，例如：$
x = \max(\min(x, \text{upper_bound}), \text{lower_bound})
$</p>
<p>leGAN 的这个实现中：</p>
</li>
<li>
<p>过缩放操作调整样式向量的幅度。</p>
</li>
<li>
<p>这种方式不会完全去除多样性，而是控制多样性的幅度。
    因此，StyleGAN 的“截断技巧”实际上是一种动态的 <strong>样式向量缩放操作</strong> 。</p>
<p><strong>为什么称为截断？</strong>
尽管操作本质是缩放，但被称为截断可能有以下原因：</p>
<ol>
<li><strong>结果上的类似性</strong> ：</li>
<li>缩放操作和传统截断在减少生成样式的多样性上有相似效果。</li>
</ol>
</li>
<li>
<p>当 <span class="arithmatex">\(\text{trunc\_psi}\)</span> 接近 0 时，样式向量趋近 <span class="arithmatex">\(w\_avg\)</span>，此时的行为类似于将所有样式向量“截断”到一个狭窄的范围。</p>
<ol>
<li><strong>术语沿袭</strong> ：</li>
<li>在 GAN 社区，"truncation trick" 是一个广泛使用的术语，尽管具体实现可能会有所不同。</li>
</ol>
</li>
</ul>
<p><strong>总结</strong></p>
<ol>
<li>
<p><strong>StyleGAN 的操作是缩放</strong> ：</p>
</li>
<li>
<p>它根据 <span class="arithmatex">\(w\_avg\)</span> 动态调整样式向量 <span class="arithmatex">\(wp\)</span> 的幅度，而不是简单地对其值进行裁剪(缩放)。</p>
</li>
<li>
<p><strong>称为截断的原因</strong> ：</p>
</li>
<li>
<p>结果上类似传统截断，能有效减少生成样式的多样性。</p>
</li>
<li>
<p>术语延续了 GAN 社区的习惯用法。</p>
</li>
<li>
<p><strong>本质</strong> ：</p>
</li>
<li>
<p>它是 <strong>样式向量的幅度缩放</strong> ，调控生成图像的多样性与稳定性之间的权衡。</p>
</li>
</ol>
<h4 id="5">5. 图像生成<a class="headerlink" href="#5" title="Permanent link">&para;</a></h4>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-6-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1"></a><span class="n">synthesis_results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">synthesis</span><span class="p">(</span><span class="n">wp</span><span class="p">,</span> <span class="n">lod</span><span class="p">,</span> <span class="n">randomize_noise</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<ul>
<li><strong>输入</strong> :</li>
<li><span class="arithmatex">\(wp\)</span>: 分层样式向量。</li>
<li><span class="arithmatex">\(\text{lod}\)</span>: 分辨率级别（Level of Detail），用于控制生成图像的细节层次。</li>
<li><span class="arithmatex">\(\text{randomize\_noise}\)</span>: 是否在生成过程中随机化噪声。</li>
<li><strong>过程</strong> :</li>
<li>
<p>使用样式向量 <span class="arithmatex">\(wp\)</span> 和噪声控制图像的生成过程。</p>
</li>
<li>
<p><span class="arithmatex">\(\text{lod}\)</span> 可以调整生成图像的分辨率，支持逐步增加细节（渐进式生成）。</p>
</li>
<li><em>输出</em> :</li>
<li>生成的图像及其相关特征。</li>
</ul>
<h3 id="2-synthesis-network">2. synthesis network<a class="headerlink" href="#2-synthesis-network" title="Permanent link">&para;</a></h3>
<p>synthesis network 定义在class SynthesisModule 里面，是一个生成器的主要部分，负责生成图像的过程。
它的参数意义</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-7-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-7-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-7-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-7-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-7-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-7-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-7-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-7-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-7-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-7-10">10</a></span>
<span class="normal"><a href="#__codelineno-7-11">11</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1"></a>resolution (默认1024): 生成图像的最终输出分辨率。例如设置为1024时，最终生成1024x1024像素的图像。
<a id="__codelineno-7-2" name="__codelineno-7-2"></a>init_resolution (默认4): 生成器的初始特征图分辨率。StyleGAN从这个低分辨率(通常是4或8)开始，然后通过一系列上采样层逐步增加分辨率直到达到目标分辨率。
<a id="__codelineno-7-3" name="__codelineno-7-3"></a>w_space_dim (默认512): W潜在空间的维度。这是StyleGAN的一个关键特征，它是将输入的Z空间通过映射网络转换后的中间潜在空间，用于更好地控制不同尺度的图像特征。
<a id="__codelineno-7-4" name="__codelineno-7-4"></a>image_channels (默认3): 输出图像的颜色通道数，对于RGB彩色图像是3。
<a id="__codelineno-7-5" name="__codelineno-7-5"></a>final_tanh (默认False): 是否在网络最后一层使用tanh激活函数。使用tanh可以将输出严格限制在[-1, 1]范围内。
<a id="__codelineno-7-6" name="__codelineno-7-6"></a>const_input (默认True): 是否使用常量输入。StyleGAN的一个创新是使用学习的常量作为生成器的起点，而不是随机噪声。
<a id="__codelineno-7-7" name="__codelineno-7-7"></a>fused_scale (默认&#39;auto&#39;): 控制是否使用融合的上采样卷积操作。融合操作可以提高计算效率。
<a id="__codelineno-7-8" name="__codelineno-7-8"></a>use_wscale (默认True): 是否使用权重缩放。这是一种训练技巧，通过对权重进行适当的缩放来帮助训练稳定性。
<a id="__codelineno-7-9" name="__codelineno-7-9"></a>noise_type (默认&#39;spatial&#39;): 控制添加到每一层的随机噪声的类型。空间噪声可以帮助生成更多的细节变化。
<a id="__codelineno-7-10" name="__codelineno-7-10"></a>fmaps_base (默认16&lt;&lt;10): 基础特征图数量，用于控制网络各层的通道数。默认值是16384。
<a id="__codelineno-7-11" name="__codelineno-7-11"></a>fmaps_max (默认512): 限制网络中任何层的最大特征图数量，防止网络变得过大。
</code></pre></div></td></tr></table></div>
<p>forward 步骤</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-8-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-8-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-8-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-8-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-8-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-8-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-8-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-8-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-8-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-8-10">10</a></span>
<span class="normal"><a href="#__codelineno-8-11">11</a></span>
<span class="normal"><a href="#__codelineno-8-12">12</a></span>
<span class="normal"><a href="#__codelineno-8-13">13</a></span>
<span class="normal"><a href="#__codelineno-8-14">14</a></span>
<span class="normal"><a href="#__codelineno-8-15">15</a></span>
<span class="normal"><a href="#__codelineno-8-16">16</a></span>
<span class="normal"><a href="#__codelineno-8-17">17</a></span>
<span class="normal"><a href="#__codelineno-8-18">18</a></span>
<span class="normal"><a href="#__codelineno-8-19">19</a></span>
<span class="normal"><a href="#__codelineno-8-20">20</a></span>
<span class="normal"><a href="#__codelineno-8-21">21</a></span>
<span class="normal"><a href="#__codelineno-8-22">22</a></span>
<span class="normal"><a href="#__codelineno-8-23">23</a></span>
<span class="normal"><a href="#__codelineno-8-24">24</a></span>
<span class="normal"><a href="#__codelineno-8-25">25</a></span>
<span class="normal"><a href="#__codelineno-8-26">26</a></span>
<span class="normal"><a href="#__codelineno-8-27">27</a></span>
<span class="normal"><a href="#__codelineno-8-28">28</a></span>
<span class="normal"><a href="#__codelineno-8-29">29</a></span>
<span class="normal"><a href="#__codelineno-8-30">30</a></span>
<span class="normal"><a href="#__codelineno-8-31">31</a></span>
<span class="normal"><a href="#__codelineno-8-32">32</a></span>
<span class="normal"><a href="#__codelineno-8-33">33</a></span>
<span class="normal"><a href="#__codelineno-8-34">34</a></span>
<span class="normal"><a href="#__codelineno-8-35">35</a></span>
<span class="normal"><a href="#__codelineno-8-36">36</a></span>
<span class="normal"><a href="#__codelineno-8-37">37</a></span>
<span class="normal"><a href="#__codelineno-8-38">38</a></span>
<span class="normal"><a href="#__codelineno-8-39">39</a></span>
<span class="normal"><a href="#__codelineno-8-40">40</a></span>
<span class="normal"><a href="#__codelineno-8-41">41</a></span>
<span class="normal"><a href="#__codelineno-8-42">42</a></span>
<span class="normal"><a href="#__codelineno-8-43">43</a></span>
<span class="normal"><a href="#__codelineno-8-44">44</a></span>
<span class="normal"><a href="#__codelineno-8-45">45</a></span>
<span class="normal"><a href="#__codelineno-8-46">46</a></span>
<span class="normal"><a href="#__codelineno-8-47">47</a></span>
<span class="normal"><a href="#__codelineno-8-48">48</a></span>
<span class="normal"><a href="#__codelineno-8-49">49</a></span>
<span class="normal"><a href="#__codelineno-8-50">50</a></span>
<span class="normal"><a href="#__codelineno-8-51">51</a></span>
<span class="normal"><a href="#__codelineno-8-52">52</a></span>
<span class="normal"><a href="#__codelineno-8-53">53</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1"></a>    def forward(self, wp, lod=None, randomize_noise=False):
<a id="__codelineno-8-2" name="__codelineno-8-2"></a>        # wp 代表经过映射网络处理后的风格向量（style vector）。
<a id="__codelineno-8-3" name="__codelineno-8-3"></a>        # Z 空间（初始潜在空间）
<a id="__codelineno-8-4" name="__codelineno-8-4"></a>        # 这是输入的随机噪声向量
<a id="__codelineno-8-5" name="__codelineno-8-5"></a>        # 通常是从标准正态分布采样得到
<a id="__codelineno-8-6" name="__codelineno-8-6"></a>        # W 空间（中间潜在空间）
<a id="__codelineno-8-7" name="__codelineno-8-7"></a>        # 通过映射网络(Mapping Network)将 Z 空间向量转换得到
<a id="__codelineno-8-8" name="__codelineno-8-8"></a>        # 相比 Z 空间，W 空间具有更好的解耦特性
<a id="__codelineno-8-9" name="__codelineno-8-9"></a>        # W+ 空间（扩展的 W 空间）
<a id="__codelineno-8-10" name="__codelineno-8-10"></a>        # 这就是代码中的 wp（w plus）
<a id="__codelineno-8-11" name="__codelineno-8-11"></a>        # 它是将 W 空间的向量扩展到每一层都有一个独立的风格向量
<a id="__codelineno-8-12" name="__codelineno-8-12"></a>        # 如果网络有 n 层，那么 wp 的形状就是 [batch_size, n, w_dim]
<a id="__codelineno-8-13" name="__codelineno-8-13"></a>        lod = self.lod.cpu().tolist() if lod is None else lod
<a id="__codelineno-8-14" name="__codelineno-8-14"></a>        # lod 的计算过程：
<a id="__codelineno-8-15" name="__codelineno-8-15"></a>        # 基于已训练的图像数量（total_img）计算
<a id="__codelineno-8-16" name="__codelineno-8-16"></a>        # 每个分辨率级别的持续时间 = 训练图像数 + 过渡图像数
<a id="__codelineno-8-17" name="__codelineno-8-17"></a>        # 当前的 lod 值决定了生成图像的分辨率
<a id="__codelineno-8-18" name="__codelineno-8-18"></a>        # 例如，对于512x512的最终分辨率：
<a id="__codelineno-8-19" name="__codelineno-8-19"></a>        # 分辨率序列：8 → 16 → 32 → 64 → 128 → 256 → 512
<a id="__codelineno-8-20" name="__codelineno-8-20"></a>        # LOD序列：6 → 5 → 4 → 3 → 2 → 1 → 0
<a id="__codelineno-8-21" name="__codelineno-8-21"></a>        if lod + self.init_res_log2 &gt; self.final_res_log2: # lod 异常
<a id="__codelineno-8-22" name="__codelineno-8-22"></a>            raise ValueError(f&#39;Maximum level-of-detail (lod) is &#39;
<a id="__codelineno-8-23" name="__codelineno-8-23"></a>                             f&#39;{self.final_res_log2 - self.init_res_log2}, &#39;
<a id="__codelineno-8-24" name="__codelineno-8-24"></a>                             f&#39;but `{lod}` is received!&#39;)
<a id="__codelineno-8-25" name="__codelineno-8-25"></a>
<a id="__codelineno-8-26" name="__codelineno-8-26"></a>        results = {&#39;wp&#39;: wp}
<a id="__codelineno-8-27" name="__codelineno-8-27"></a>        for res_log2 in range(self.init_res_log2, self.final_res_log2 + 1):
<a id="__codelineno-8-28" name="__codelineno-8-28"></a>            current_lod = self.final_res_log2 - res_log2
<a id="__codelineno-8-29" name="__codelineno-8-29"></a>            if lod &lt; current_lod + 1:
<a id="__codelineno-8-30" name="__codelineno-8-30"></a>                block_idx = res_log2 - self.init_res_log2
<a id="__codelineno-8-31" name="__codelineno-8-31"></a>                if block_idx == 0: # 最低分辨率
<a id="__codelineno-8-32" name="__codelineno-8-32"></a>                    if self.const_input:
<a id="__codelineno-8-33" name="__codelineno-8-33"></a>                        x, style = self.layer0(None, wp[:, 0], randomize_noise)
<a id="__codelineno-8-34" name="__codelineno-8-34"></a>                    else:
<a id="__codelineno-8-35" name="__codelineno-8-35"></a>                        x = wp[:, 0].view(-1, self.w_space_dim, 1, 1)
<a id="__codelineno-8-36" name="__codelineno-8-36"></a>                        x, style = self.layer0(x, wp[:, 0], randomize_noise)
<a id="__codelineno-8-37" name="__codelineno-8-37"></a>                else:
<a id="__codelineno-8-38" name="__codelineno-8-38"></a>                    x, style = self.__getattr__(f&#39;layer{2 * block_idx}&#39;)(
<a id="__codelineno-8-39" name="__codelineno-8-39"></a>                        x, wp[:, 2 * block_idx], randomize_noise)
<a id="__codelineno-8-40" name="__codelineno-8-40"></a>                    results[f&#39;style{2 * block_idx:02d}&#39;] = style
<a id="__codelineno-8-41" name="__codelineno-8-41"></a>                    x, style = self.__getattr__(f&#39;layer{2 * block_idx + 1}&#39;)(
<a id="__codelineno-8-42" name="__codelineno-8-42"></a>                        x, wp[:, 2 * block_idx + 1], randomize_noise)
<a id="__codelineno-8-43" name="__codelineno-8-43"></a>                    results[f&#39;style{2 * block_idx + 1:02d}&#39;] = style
<a id="__codelineno-8-44" name="__codelineno-8-44"></a>            if current_lod - 1 &lt; lod &lt;= current_lod:
<a id="__codelineno-8-45" name="__codelineno-8-45"></a>                image = self.__getattr__(f&#39;output{block_idx}&#39;)(x, None)
<a id="__codelineno-8-46" name="__codelineno-8-46"></a>            elif current_lod &lt; lod &lt; current_lod + 1:
<a id="__codelineno-8-47" name="__codelineno-8-47"></a>                alpha = np.ceil(lod) - lod
<a id="__codelineno-8-48" name="__codelineno-8-48"></a>                image = (self.__getattr__(f&#39;output{block_idx}&#39;)(x, None) * alpha
<a id="__codelineno-8-49" name="__codelineno-8-49"></a>                         + self.upsample(image) * (1 - alpha))
<a id="__codelineno-8-50" name="__codelineno-8-50"></a>            elif lod &gt;= current_lod + 1:
<a id="__codelineno-8-51" name="__codelineno-8-51"></a>                image = self.upsample(image)
<a id="__codelineno-8-52" name="__codelineno-8-52"></a>        results[&#39;image&#39;] = self.final_activate(image)
<a id="__codelineno-8-53" name="__codelineno-8-53"></a>        return results
</code></pre></div></td></tr></table></div>
<p>lod 表示 level of details.表示分辨率。</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-9-1">1</a></span>
<span class="normal"><a href="#__codelineno-9-2">2</a></span>
<span class="normal"><a href="#__codelineno-9-3">3</a></span>
<span class="normal"><a href="#__codelineno-9-4">4</a></span>
<span class="normal"><a href="#__codelineno-9-5">5</a></span>
<span class="normal"><a href="#__codelineno-9-6">6</a></span>
<span class="normal"><a href="#__codelineno-9-7">7</a></span>
<span class="normal"><a href="#__codelineno-9-8">8</a></span>
<span class="normal"><a href="#__codelineno-9-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1"></a>        # Compute level-of-details.
<a id="__codelineno-9-2" name="__codelineno-9-2"></a>        phase, subphase = divmod(runner.seen_img, self.lod_duration)
<a id="__codelineno-9-3" name="__codelineno-9-3"></a>        lod = self.init_lod - phase
<a id="__codelineno-9-4" name="__codelineno-9-4"></a>        if self.lod_transition_img:
<a id="__codelineno-9-5" name="__codelineno-9-5"></a>            transition_img = max(subphase - self.lod_training_img, 0)
<a id="__codelineno-9-6" name="__codelineno-9-6"></a>            lod = lod - transition_img / self.lod_transition_img
<a id="__codelineno-9-7" name="__codelineno-9-7"></a>        lod = max(lod, 0.0)
<a id="__codelineno-9-8" name="__codelineno-9-8"></a>        resolution = self.init_res * (2 ** int(np.ceil(self.init_lod - lod)))
<a id="__codelineno-9-9" name="__codelineno-9-9"></a>        return lod, resolution
</code></pre></div></td></tr></table></div>
<p>lod 详细计算过程。假设
其中，init_res 是初始分辨率（通常是4或8）。
举例说明：</p>
<blockquote>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code>假设 init_lod = 8（从8x8到2048x2048）
lod_duration = 600,000（每个分辨率级别60万张图像）,
lod_training_img = 300,000（稳定阶段30万张图像）这个阶段lod一直保持为8,分辨率为8x8,
lod_transition_img = 300,000（过渡阶段30万张图像）,
到了这个阶段之后, lod 从 8.0 逐渐降低到 7.0，分辨率一直是16x16。,
直观上看 每个分辨率训练分成两个阶段，第一阶段训练当前分辨率的稳定阶段，第二阶段训练下一个分辨率的过渡阶段，lod线性递减到下一个分辨率对应的lod。
</code></pre></div></td></tr></table></div>
</blockquote>
<p>synthesis 网络的每一个分辨率层都有两个卷积层。初始分辨率的第一个卷积层有所区别。</p>
<h4 id="_1">第一个分辨率层<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h4>
<h5 id="layer0">layer0<a class="headerlink" href="#layer0" title="Permanent link">&para;</a></h5>
<p>layer0 的网络定义为</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-10-1">1</a></span>
<span class="normal"><a href="#__codelineno-10-2">2</a></span>
<span class="normal"><a href="#__codelineno-10-3">3</a></span>
<span class="normal"><a href="#__codelineno-10-4">4</a></span>
<span class="normal"><a href="#__codelineno-10-5">5</a></span>
<span class="normal"><a href="#__codelineno-10-6">6</a></span>
<span class="normal"><a href="#__codelineno-10-7">7</a></span>
<span class="normal"><a href="#__codelineno-10-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1"></a>self.layer0 =ConvBlock(
<a id="__codelineno-10-2" name="__codelineno-10-2"></a>    in_channels=self.get_nf(res),
<a id="__codelineno-10-3" name="__codelineno-10-3"></a>    out_channels=self.get_nf(res),
<a id="__codelineno-10-4" name="__codelineno-10-4"></a>    resolution=self.init_res,
<a id="__codelineno-10-5" name="__codelineno-10-5"></a>    w_space_dim=self.w_space_dim,
<a id="__codelineno-10-6" name="__codelineno-10-6"></a>    position=&#39;const_init&#39;, # 标记为const_init
<a id="__codelineno-10-7" name="__codelineno-10-7"></a>    use_wscale=self.use_wscale,
<a id="__codelineno-10-8" name="__codelineno-10-8"></a>    noise_type=self.noise_type)
</code></pre></div></td></tr></table></div>
<p>输入为</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-11-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1"></a>x, style = self.layer0(None, wp[:, 0], randomize_noise)
</code></pre></div></td></tr></table></div>
<p>第一个分辨率只有一个convblock，将原始的输入4x4x512 转化为 4x4x512</p>
<h4 id="k">第k个分辨率层<a class="headerlink" href="#k" title="Permanent link">&para;</a></h4>
<p>次后的每个分辨率层包含两个convblock
第一个convblock 增加了上采样的操作。其余的一样。
最后一个分辨率只有一个convblock，将512x512x32 转化为 1024x1024x16
分辨率增加一倍，output channel 减半，保持卷积整体的参数量每一层一致。</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-12-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-12-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-12-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-12-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-12-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-12-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-12-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-12-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-12-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-12-10">10</a></span>
<span class="normal"><a href="#__codelineno-12-11">11</a></span>
<span class="normal"><a href="#__codelineno-12-12">12</a></span>
<span class="normal"><a href="#__codelineno-12-13">13</a></span>
<span class="normal"><a href="#__codelineno-12-14">14</a></span>
<span class="normal"><a href="#__codelineno-12-15">15</a></span>
<span class="normal"><a href="#__codelineno-12-16">16</a></span>
<span class="normal"><a href="#__codelineno-12-17">17</a></span>
<span class="normal"><a href="#__codelineno-12-18">18</a></span>
<span class="normal"><a href="#__codelineno-12-19">19</a></span>
<span class="normal"><a href="#__codelineno-12-20">20</a></span>
<span class="normal"><a href="#__codelineno-12-21">21</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1"></a>self.layer{2k-1} =  ConvBlock(
<a id="__codelineno-12-2" name="__codelineno-12-2"></a>    in_channels=self.get_nf(res // 2),
<a id="__codelineno-12-3" name="__codelineno-12-3"></a>    out_channels=self.get_nf(res),
<a id="__codelineno-12-4" name="__codelineno-12-4"></a>    resolution=res,
<a id="__codelineno-12-5" name="__codelineno-12-5"></a>    w_space_dim=self.w_space_dim,
<a id="__codelineno-12-6" name="__codelineno-12-6"></a>    upsample=True,
<a id="__codelineno-12-7" name="__codelineno-12-7"></a>    fused_scale=fused_scale,
<a id="__codelineno-12-8" name="__codelineno-12-8"></a>    use_wscale=self.use_wscale,
<a id="__codelineno-12-9" name="__codelineno-12-9"></a>    noise_type=self.noise_type
<a id="__codelineno-12-10" name="__codelineno-12-10"></a>)
<a id="__codelineno-12-11" name="__codelineno-12-11"></a>
<a id="__codelineno-12-12" name="__codelineno-12-12"></a>self.layer{2k} =ConvBlock(
<a id="__codelineno-12-13" name="__codelineno-12-13"></a>    in_channels=self.w_space_dim,
<a id="__codelineno-12-14" name="__codelineno-12-14"></a>    out_channels=self.get_nf(res),
<a id="__codelineno-12-15" name="__codelineno-12-15"></a>    resolution=self.init_res,
<a id="__codelineno-12-16" name="__codelineno-12-16"></a>    w_space_dim=self.w_space_dim,
<a id="__codelineno-12-17" name="__codelineno-12-17"></a>    kernel_size=self.init_res,
<a id="__codelineno-12-18" name="__codelineno-12-18"></a>    padding=self.init_res - 1,
<a id="__codelineno-12-19" name="__codelineno-12-19"></a>    use_wscale=self.use_wscale,
<a id="__codelineno-12-20" name="__codelineno-12-20"></a>    noise_type=self.noise_type
<a id="__codelineno-12-21" name="__codelineno-12-21"></a>)
</code></pre></div></td></tr></table></div>
<p>输入</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-13-1">1</a></span>
<span class="normal"><a href="#__codelineno-13-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1"></a>x, style = f&quot;self.layer{2k-11}&quot;(x, wp[:, 2 * block_idx - 1], randomize_noise)
<a id="__codelineno-13-2" name="__codelineno-13-2"></a>x, style = f&quot;self.layer{2k}&quot;(x, wp[:, 2 * block_idx],randomize_noise)
</code></pre></div></td></tr></table></div>
<p>每个convblock 的输入都包含上一层的输入,本层的风格向量，以及是否需要添加噪声。</p>
<p>每一个分辨率的第一个卷积层和第二个卷积层区别在于第二个会加入上采样。</p>
<h3 id="3-convblock">3. ConvBlock<a class="headerlink" href="#3-convblock" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-14-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-14-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-14-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-14-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-14-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-14-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-14-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-14-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-14-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-14-10">10</a></span>
<span class="normal"><a href="#__codelineno-14-11">11</a></span>
<span class="normal"><a href="#__codelineno-14-12">12</a></span>
<span class="normal"><a href="#__codelineno-14-13">13</a></span>
<span class="normal"><a href="#__codelineno-14-14">14</a></span>
<span class="normal"><a href="#__codelineno-14-15">15</a></span>
<span class="normal"><a href="#__codelineno-14-16">16</a></span>
<span class="normal"><a href="#__codelineno-14-17">17</a></span>
<span class="normal"><a href="#__codelineno-14-18">18</a></span>
<span class="normal"><a href="#__codelineno-14-19">19</a></span>
<span class="normal"><a href="#__codelineno-14-20">20</a></span>
<span class="normal"><a href="#__codelineno-14-21">21</a></span>
<span class="normal"><a href="#__codelineno-14-22">22</a></span>
<span class="normal"><a href="#__codelineno-14-23">23</a></span>
<span class="normal"><a href="#__codelineno-14-24">24</a></span>
<span class="normal"><a href="#__codelineno-14-25">25</a></span>
<span class="normal"><a href="#__codelineno-14-26">26</a></span>
<span class="normal"><a href="#__codelineno-14-27">27</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1"></a>    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">randomize_noise</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<a id="__codelineno-14-2" name="__codelineno-14-2"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="o">!=</span> <span class="s1">&#39;const_init&#39;</span><span class="p">:</span>
<a id="__codelineno-14-3" name="__codelineno-14-3"></a>            <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">upsample</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-14-4" name="__codelineno-14-4"></a>            <span class="n">weight</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">weight</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">wscale</span>
<a id="__codelineno-14-5" name="__codelineno-14-5"></a>            <span class="n">x</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">conv2d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span>
<a id="__codelineno-14-6" name="__codelineno-14-6"></a>                             <span class="n">weight</span><span class="o">=</span><span class="n">weight</span><span class="p">,</span>
<a id="__codelineno-14-7" name="__codelineno-14-7"></a>                             <span class="n">bias</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-14-8" name="__codelineno-14-8"></a>                             <span class="n">stride</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stride</span><span class="p">,</span>
<a id="__codelineno-14-9" name="__codelineno-14-9"></a>                             <span class="n">padding</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">padding</span><span class="p">)</span>
<a id="__codelineno-14-10" name="__codelineno-14-10"></a>            <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">blur</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-14-11" name="__codelineno-14-11"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-14-12" name="__codelineno-14-12"></a>            <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">const</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># 初始输入</span>
<a id="__codelineno-14-13" name="__codelineno-14-13"></a>
<a id="__codelineno-14-14" name="__codelineno-14-14"></a>        <span class="n">bias</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bias</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">bscale</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bias</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
<a id="__codelineno-14-15" name="__codelineno-14-15"></a>
<a id="__codelineno-14-16" name="__codelineno-14-16"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="o">==</span> <span class="s1">&#39;last&#39;</span><span class="p">:</span>
<a id="__codelineno-14-17" name="__codelineno-14-17"></a>            <span class="k">if</span> <span class="n">bias</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-14-18" name="__codelineno-14-18"></a>                <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">bias</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-14-19" name="__codelineno-14-19"></a>            <span class="k">return</span> <span class="n">x</span>
<a id="__codelineno-14-20" name="__codelineno-14-20"></a>
<a id="__codelineno-14-21" name="__codelineno-14-21"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_noise</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">randomize_noise</span><span class="p">)</span>
<a id="__codelineno-14-22" name="__codelineno-14-22"></a>        <span class="k">if</span> <span class="n">bias</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-14-23" name="__codelineno-14-23"></a>            <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">bias</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-14-24" name="__codelineno-14-24"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">activate</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-14-25" name="__codelineno-14-25"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-14-26" name="__codelineno-14-26"></a>        <span class="n">x</span><span class="p">,</span> <span class="n">style</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span>
<a id="__codelineno-14-27" name="__codelineno-14-27"></a>        <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">style</span>
</code></pre></div></td></tr></table></div>
<p>具体步骤</p>
<ol>
<li>
<p>上采样和卷积。只在每一个分辨率的第一层进行上采样。使用的上采样是</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-15-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1"></a><span class="k">return</span> <span class="n">F</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">scale_factor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">scale_factor</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p>卷积的过程中会利用可学习的一个<span class="arithmatex">\(w_{scale}\)</span>对卷积的权重进行缩放。这个想法来自于
<a href="../../3.1from_gan_to_stylegan/paper/">progressive growing of gan</a>中。</p>
<p>其中，如果是init 输入 只会将可以学习的init在batch 维度进行复制
2. 增加bias
可学习的一个bias。这个应该不重要。
1. 增加噪声</p>
</li>
</ol>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-16-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-16-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-16-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-16-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-16-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-16-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-16-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-16-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-16-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-16-10">10</a></span>
<span class="normal"><a href="#__codelineno-16-11">11</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1"></a><span class="k">if</span> <span class="n">randomize_noise</span><span class="p">:</span>
<a id="__codelineno-16-2" name="__codelineno-16-2"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise_type</span> <span class="o">==</span> <span class="s1">&#39;spatial&#39;</span><span class="p">:</span>
<a id="__codelineno-16-3" name="__codelineno-16-3"></a>        <span class="n">noise</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">res</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">res</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-16-4" name="__codelineno-16-4"></a>    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise_type</span> <span class="o">==</span> <span class="s1">&#39;channel&#39;</span><span class="p">:</span>
<a id="__codelineno-16-5" name="__codelineno-16-5"></a>        <span class="n">noise</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">channels</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-16-6" name="__codelineno-16-6"></a><span class="k">else</span><span class="p">:</span>
<a id="__codelineno-16-7" name="__codelineno-16-7"></a>    <span class="n">noise</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise</span>
<a id="__codelineno-16-8" name="__codelineno-16-8"></a><span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise_type</span> <span class="o">==</span> <span class="s1">&#39;spatial&#39;</span><span class="p">:</span>
<a id="__codelineno-16-9" name="__codelineno-16-9"></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">noise</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">channels</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-16-10" name="__codelineno-16-10"></a><span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise_type</span> <span class="o">==</span> <span class="s1">&#39;channel&#39;</span><span class="p">:</span>
<a id="__codelineno-16-11" name="__codelineno-16-11"></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">noise</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">res</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">res</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p>噪音的增加有两种法案。一个是增加在空间上，一个是增加在channel 上。</p>
<ol>
<li>非线性激活函数</li>
</ol>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-17-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1"></a><span class="bp">self</span><span class="o">.</span><span class="n">activate</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">LeakyReLU</span><span class="p">(</span><span class="n">negative_slope</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p><a class="glightbox" href="../../../../images/image-15.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="../../../../images/image-15.png" /></a>
LeakyReLU 的好处主要体现在以下几个方面：</p>
<ul>
<li>防止神经元死亡：负值区域的斜率使得神经元不会完全失活。</li>
<li>改善梯度流动：减少梯度消失问题，支持更深层网络的训练。</li>
<li>适应数据分布：捕捉负值区域的信息，更好地处理具有负值特征的数据。</li>
<li>训练稳定性：提升训练过程的稳定性和收敛性。</li>
<li>
<p>通用性：在图像生成任务和深度学习网络中表现优异，成为许多模型的默认选择。</p>
</li>
<li>
<p>instance normalization
<a class="glightbox" href="../../../../images/image-16.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="../../../../images/image-16.png" /></a>
标准instance normalization。 使得每个样本的每个通道的featuremap的均值为0， 方差为1.</p>
</li>
<li>风格化</li>
</ul>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-18-1">1</a></span>
<span class="normal"><a href="#__codelineno-18-2">2</a></span>
<span class="normal"><a href="#__codelineno-18-3">3</a></span>
<span class="normal"><a href="#__codelineno-18-4">4</a></span>
<span class="normal"><a href="#__codelineno-18-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1"></a>def forward(self, x, w):
<a id="__codelineno-18-2" name="__codelineno-18-2"></a>    style = self.forward_style(w)
<a id="__codelineno-18-3" name="__codelineno-18-3"></a>    style_split = style.view(-1, 2, self.out_channels, 1, 1)
<a id="__codelineno-18-4" name="__codelineno-18-4"></a>    x = x * (style_split[:, 0] + 1) + style_split[:, 1]
<a id="__codelineno-18-5" name="__codelineno-18-5"></a>    return x, style
</code></pre></div></td></tr></table></div>
<p>对featuremap的每一层利用学习到的风格向量进行风格调制。具体来说style_split 每个channel 包含一个学习到的标准差和均值</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-19-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1"></a>x = x * (style_split[:, 0] + 1) + style_split[:, 1]
</code></pre></div></td></tr></table></div>
<p>意味最每一个channel 的feature map显式得调节方差和标准差。一般得，featuremap的方差和均值表示图片的风格。</p>
<p>```</p>









  



<!-- 段落注释系统
<div class="comments-container annotation-container">
  <div class="comments-header">
    <h2 id="__annotations" class="comments-title">
      <span class="comments-icon">🔍</span>
      段落注释
      <span class="comments-subtitle">您可以高亮并评论任何文本!</span>
    </h2>
    <div class="comments-divider"></div>
  </div>

  <div class="comments-wrapper">
    <div class="hypothesis-instructions">
      <p><strong>如何使用段落注释功能：</strong></p>
      <ol>
        <li>点击右上角的 <img src="https://hypothes.is/assets/images/logo.png" alt="Hypothesis" style="height: 16px; vertical-align: middle;"> 图标打开侧边栏</li>
        <li>选择任意文本段落即可高亮并添加注释</li>
        <li>您还可以对其他人的注释进行回复</li>
      </ol>
    </div>
  </div>
</div> -->

<!-- 加载  -->
<script type="application/json" class="js-hypothesis-config">
{
  "openSidebar": false,
  "showHighlights": true,
  "theme": "clean"
}
</script>
<script async src="https://hypothes.is/embed.js"></script>

<!-- Hypothesis 样式美化 -->
<style>
  /* 修改高亮效果为下划线和聊天泡泡 */
  .hypothesis-highlight {
    background-color: transparent !important; /* 移除高亮背景 */
    text-decoration: underline !important;
    text-decoration-color: #4285f4 !important;
    text-decoration-thickness: 2px !important;
    text-decoration-style: wavy !important;
    position: relative !important;
    cursor: pointer !important;
    border-bottom: none !important; /* 移除之前的边框 */
    box-shadow: none !important; /* 移除之前的阴影 */
  }

  .hypothesis-highlight::after {
    content: "💬" !important;
    position: absolute !important;
    display: inline-block !important;
    font-size: 14px !important;
    top: -10px !important;
    right: -5px !important;
    opacity: 0.7 !important;
    transition: opacity 0.3s ease !important;
  }

  .hypothesis-highlight:hover {
    background-color: rgba(66, 133, 244, 0.08) !important; /* 鼠标悬停时的轻微背景 */
  }

  .hypothesis-highlight:hover::after {
    opacity: 1 !important;
    transform: scale(1.2) !important;
  }

  /* 美化 Hypothesis 侧边栏 */
  hypothesis-sidebar {
    font-family: var(--md-text-font-family, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif) !important;
    box-shadow: -2px 0 10px rgba(0, 0, 0, 0.1) !important;
  }

  /* 美化卡片样式 */
  .hypothesis-annotation-card {
    border-radius: 8px !important;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05) !important;
    transition: transform 0.2s ease, box-shadow 0.2s ease !important;
    overflow: hidden !important;
  }

  .hypothesis-annotation-card:hover {
    transform: translateY(-2px) !important;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1) !important;
  }

  /* 美化 Hypothesis 按钮 */
  .hypothesis-button {
    border-radius: 4px !important;
    transition: background-color 0.2s ease !important;
  }

  /* 美化标签样式 */
  .hypothesis-tag {
    border-radius: 12px !important;
    padding: 2px 8px !important;
    font-size: 12px !important;
    background-color: rgba(0, 0, 0, 0.05) !important;
    color: #606060 !important;
  }

  /* 美化工具栏 */
  .hypothesis-toolbar {
    background: linear-gradient(to right, #f5f5f5, #ffffff) !important;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1) !important;
  }

  /* 美化注释面板header */
  .hypothesis-annotation-header {
    padding: 10px !important;
    background-color: #f9f9f9 !important;
  }

  /* 美化注释内容 */
  .hypothesis-annotation-body {
    font-size: 14px !important;
    line-height: 1.6 !important;
    color: #333 !important;
  }

  /* 美化用户名 */
  .hypothesis-user {
    font-weight: 600 !important;
    color: #3f51b5 !important;
  }

  /* 美化时间戳 */
  .hypothesis-timestamp {
    font-size: 12px !important;
    color: #757575 !important;
  }

  /* 美化输入框 */
  .hypothesis-input {
    border-radius: 4px !important;
    border: 1px solid #e0e0e0 !important;
    transition: border-color 0.2s ease, box-shadow 0.2s ease !important;
  }

  .hypothesis-input:focus {
    border-color: #4dabf7 !important;
    box-shadow: 0 0 0 2px rgba(77, 171, 247, 0.2) !important;
    outline: none !important;
  }
</style>

<!-- 页面评论系统 -->
<div class="comments-container utterances-container">
  <div class="comments-header">
    <h2 id="__comments" class="comments-title">
      <span class="comments-icon">💬</span>
      Comments
      <span class="comments-subtitle">Share your thoughts!</span>
    </h2>
    <div class="comments-divider"></div>
  </div>

  <div class="comments-wrapper">
    <script src="https://utteranc.es/client.js"
            repo="MAD-SG/generative-ai-start-to-surrender"
            issue-term="pathname"
            label="comment"
            theme="preferred-color-scheme"
            crossorigin="anonymous"
            async>
    </script>
  </div>
</div>

<style>
  .comments-container {
    margin: 2.5rem auto;
    padding: 1.5rem;
    background: var(--md-code-bg-color, rgba(0, 0, 0, 0.05));
    border-radius: 8px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    width: 100%;
    max-width: 100%;
    box-sizing: border-box;
  }

  .annotation-container {
    margin-bottom: 1rem;
    background: rgba(255, 255, 240, 0.5);
    border-left: 4px solid #ffeb3b;
  }

  .utterances-container {
    background: rgba(240, 248, 255, 0.5);
    border-left: 4px solid #2196f3;
  }

  .comments-container:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 12px rgba(0, 0, 0, 0.1);
  }

  .comments-header {
    margin-bottom: 1.5rem;
  }

  .comments-title {
    font-weight: 600;
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin-top: 0;
    margin-bottom: 0.75rem;
    color: var(--md-primary-fg-color, #2196f3);
    flex-wrap: wrap;
  }

  .annotation-container .comments-title {
    color: #f57c00;
  }

  .comments-icon {
    font-size: 1.4em;
  }

  .comments-subtitle {
    font-size: 0.7em;
    font-weight: 400;
    opacity: 0.8;
    margin-left: 1rem;
  }

  .comments-divider {
    height: 3px;
    background: linear-gradient(90deg,
      var(--md-primary-fg-color, #2196f3) 0%,
      rgba(255, 255, 255, 0) 100%);
    border-radius: 3px;
    margin-bottom: 1rem;
    width: 100%;
  }

  .annotation-container .comments-divider {
    background: linear-gradient(90deg,
      #f57c00 0%,
      rgba(255, 255, 255, 0) 100%);
  }

  .comments-wrapper {
    position: relative;
    min-height: 150px;
    width: 100%;
  }

  .hypothesis-instructions {
    padding: 1rem;
    background-color: rgba(255, 255, 255, 0.5);
    border-radius: 6px;
    margin-bottom: 1rem;
  }

  .hypothesis-instructions p {
    margin-top: 0;
    font-weight: 500;
  }

  .hypothesis-instructions ol {
    margin-bottom: 0;
    padding-left: 1.5rem;
  }

  .hypothesis-instructions li {
    margin-bottom: 0.5rem;
  }

  .hypothesis-instructions li:last-child {
    margin-bottom: 0;
  }

  /* 确保utterances的iframe填充可用宽度 */
  .utterances-container .comments-wrapper iframe {
    border-radius: 6px;
    width: 100% !important;
    max-width: 100% !important;
  }

  /* 动画效果 */
  @keyframes fadeInUp {
    from {
      opacity: 0;
      transform: translate3d(0, 20px, 0);
    }
    to {
      opacity: 1;
      transform: translate3d(0, 0, 0);
    }
  }

  .comments-wrapper {
    animation: fadeInUp 0.6s ease forwards;
  }

  /* 响应式设计 - 小屏幕调整 */
  @media (max-width: 768px) {
    .comments-container {
      padding: 1rem;
      margin: 1.5rem auto;
    }

    .comments-title {
      font-size: 1.3rem;
    }

    .comments-subtitle {
      display: block;
      width: 100%;
      margin-left: 0;
      margin-top: 0.3rem;
    }
  }
</style>
                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../../3.1from_gan_to_stylegan/paper/" class="md-footer__link md-footer__link--prev" aria-label="Previous: From GAN to StyleGAN">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                From GAN to StyleGAN
              </div>
            </div>
          </a>
        
        
          
          <a href="../../3.4stylegan2/paper/" class="md-footer__link md-footer__link--next" aria-label="Next: StyleGAN2">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                StyleGAN2
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://mad-sg.github.io/generative-ai-start-to-surrender/" target="_blank" rel="noopener" title="mad-sg.github.io" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://hub.docker.com/r/squidfunk/mkdocs-material/" target="_blank" rel="noopener" title="hub.docker.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M349.9 236.3h-66.1v-59.4h66.1zm0-204.3h-66.1v60.7h66.1zm78.2 144.8H362v59.4h66.1zm-156.3-72.1h-66.1v60.1h66.1zm78.1 0h-66.1v60.1h66.1zm276.8 100c-14.4-9.7-47.6-13.2-73.1-8.4-3.3-24-16.7-44.9-41.1-63.7l-14-9.3-9.3 14c-18.4 27.8-23.4 73.6-3.7 103.8-8.7 4.7-25.8 11.1-48.4 10.7H2.4c-8.7 50.8 5.8 116.8 44 162.1 37.1 43.9 92.7 66.2 165.4 66.2 157.4 0 273.9-72.5 328.4-204.2 21.4.4 67.6.1 91.3-45.2 1.5-2.5 6.6-13.2 8.5-17.1zm-511.1-27.9h-66v59.4h66.1v-59.4zm78.1 0h-66.1v59.4h66.1zm78.1 0h-66.1v59.4h66.1zm-78.1-72.1h-66.1v60.1h66.1z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://pypi.org/project/mkdocs-material/" target="_blank" rel="noopener" title="pypi.org" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6M286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3M167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4m-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://bsky.app/profile/squidfunk.bsky.social" target="_blank" rel="noopener" title="bsky.app" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M111.8 62.2C170.2 105.9 233 194.7 256 242.4c23-47.6 85.8-136.4 144.2-180.2 42.1-31.6 110.3-56 110.3 21.8 0 15.5-8.9 130.5-14.1 149.2-18.2 64.8-84.4 81.4-143.3 71.3C456 322 482.2 380 425.6 438c-107.4 110.2-154.3-27.6-166.3-62.9-1.7-4.9-2.6-7.8-3.3-7.8s-1.6 3-3.3 7.8c-12 35.3-59 173.1-166.3 62.9-56.5-58-30.4-116 72.5-133.5C100 314.6 33.8 298 15.7 233.1 10.4 214.4 1.5 99.4 1.5 83.9c0-77.8 68.2-53.4 110.3-21.8z"/></svg>
    </a>
  
    
    
      
    
    
    
      
      
    
    <a href="https://fosstodon.org/@squidfunk" target="_blank" rel="noopener me" title="fosstodon.org" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M433 179.11c0-97.2-63.71-125.7-63.71-125.7-62.52-28.7-228.56-28.4-290.48 0 0 0-63.72 28.5-63.72 125.7 0 115.7-6.6 259.4 105.63 289.1 40.51 10.7 75.32 13 103.33 11.4 50.81-2.8 79.32-18.1 79.32-18.1l-1.7-36.9s-36.31 11.4-77.12 10.1c-40.41-1.4-83-4.4-89.63-54a102.5 102.5 0 0 1-.9-13.9c85.63 20.9 158.65 9.1 178.75 6.7 56.12-6.7 105-41.3 111.23-72.9 9.8-49.8 9-121.5 9-121.5m-75.12 125.2h-46.63v-114.2c0-49.7-64-51.6-64 6.9v62.5h-46.33V197c0-58.5-64-56.6-64-6.9v114.2H90.19c0-122.1-5.2-147.9 18.41-175 25.9-28.9 79.82-30.8 103.83 6.1l11.6 19.5 11.6-19.5c24.11-37.1 78.12-34.8 103.83-6.1 23.71 27.3 18.4 53 18.4 175z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://x.com/squidfunk" target="_blank" rel="noopener" title="x.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8l164.9-188.5L26.8 48h145.6l100.5 132.9zm-24.8 373.8h39.1L151.1 88h-42z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../../..", "features": ["navigation.tabs", "toc.integrate", "content.code.copy", "content.code.select", "content.code.annotate", "content.tabs.link", "content.footnote.tooltips", "content.tooltips", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow", "announce.dismiss", "content.action.edit", "content.action.view", "content.code.annotate", "navigation.footer", "navigation.indexes", "navigation.sections", "navigation.tabs", "navigation.top", "navigation.expand", "search.share", "search.suggest"], "search": "../../../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.88dd0f4e.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/core-js/3.26.1/minified.min.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="../../../../javascripts/mathjax.js"></script>
      
    
  <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body>
</html>